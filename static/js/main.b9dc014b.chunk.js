(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{18:function(e,t,n){e.exports=n(34)},32:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);n(19);var a,i=n(1),s=n.n(i),r=n(7),o=n.n(r),c=n(2),l=n(3),u=n(4),h=n(9),d=n(8),v=n(10),p=n(5),m=n(6),f=n(0),y=function(){function e(){Object(l.a)(this,e),this.onGamepadConnected=function(e){console.log("Gamepad connected:",e.gamepad)},this.onGamepadDisconnected=function(e){console.log("Gamepad disconnected:",e.gamepad)}}return Object(u.a)(e,[{key:"listen",value:function(){window.addEventListener("gamepadconnected",this.onGamepadConnected),window.addEventListener("gamepaddisconnected",this.onGamepadDisconnected)}},{key:"stop",value:function(){window.removeEventListener("gamepadconnected",this.onGamepadConnected),window.removeEventListener("gamepaddisconnected",this.onGamepadDisconnected)}},{key:"getAxis",value:function(e){var t=navigator.getGamepads(),n=0,a=!0,i=!1,s=void 0;try{for(var r,o=t[Symbol.iterator]();!(a=(r=o.next()).done);a=!0){var c=r.value;if(c&&"standard"===c.mapping)if(e<4){var l=c.axes[e];Math.abs(l)>=.1&&Math.abs(l)>Math.abs(n)&&(n=l)}else if(4===e){var u=c.buttons[6].value,h=c.buttons[7].value-u;Math.abs(h)>Math.abs(n)&&(n=h)}}}catch(d){i=!0,s=d}finally{try{a||null==o.return||o.return()}finally{if(i)throw s}}return n}}]),e}(),w=function(){function e(t){var n=this;Object(l.a)(this,e),this.target=void 0,this.keysPressed=new Set,this.lastKeyUp=new Map,this.reset=function(){n.keysPressed.clear()},this.onKeyDown=function(e){e.preventDefault(),Math.abs(e.timeStamp-(n.lastKeyUp.get(e.key)||0))>=100&&n.keysPressed.add(e.key)},this.onKeyUp=function(e){e.preventDefault(),n.keysPressed.delete(e.key),n.lastKeyUp.set(e.key,e.timeStamp)},this.onClick=function(e){2===e.button&&e.shiftKey&&n.reset()},this.target=t}return Object(u.a)(e,[{key:"listen",value:function(){this.target.addEventListener("blur",this.reset),this.target.addEventListener("contextmenu",this.reset),this.target.addEventListener("keydown",this.onKeyDown),this.target.addEventListener("keyup",this.onKeyUp),document.addEventListener("click",this.onClick)}},{key:"stop",value:function(){this.target.removeEventListener("blur",this.reset),this.target.removeEventListener("contextmenu",this.reset),this.target.removeEventListener("keydown",this.onKeyDown),this.target.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("click",this.onClick),this.reset()}},{key:"isPressed",value:function(e){return this.keysPressed.has(e)}}]),e}();!function(e){e[e.AxisX=0]="AxisX",e[e.AxisY=1]="AxisY",e[e.AxisZ=2]="AxisZ",e[e.PlaneYZ=3]="PlaneYZ",e[e.PlaneXZ=4]="PlaneXZ",e[e.PlaneXY=5]="PlaneXY"}(a||(a={}));var b,g=function(e){function t(e){var n;Object(l.a)(this,t),(n=Object(h.a)(this,Object(d.a)(t).call(this))).options=e,n.activeMesh=null,n.objectDragDirection=null,n.dragOffset=new f.u,n.plane=new f.n,n.axisX=void 0,n.axisY=void 0,n.axisZ=void 0,n.planeYZ=void 0,n.planeXZ=void 0,n.planeXY=void 0;var i={transparent:!0,opacity:.75,side:f.g},s=new f.e(.05,.05,.5);n.axisX=new f.j(s,new f.k(Object(c.a)({},i,{color:16711680}))),n.axisX.position.set(.275,0,0),n.axisX.rotation.y=Math.PI/2,n.axisX.userData.direction=a.AxisX,n.axisY=new f.j(s,new f.k(Object(c.a)({},i,{color:65280}))),n.axisY.position.set(0,.275,0),n.axisY.rotation.x=Math.PI/2,n.axisY.userData.direction=a.AxisY,n.axisZ=new f.j(s,new f.k(Object(c.a)({},i,{color:255}))),n.axisZ.position.set(0,0,.275),n.axisZ.userData.direction=a.AxisZ,n.add(n.axisX),n.add(n.axisY),n.add(n.axisZ);var r=new f.o(.25,.25);return n.planeYZ=new f.j(r,new f.k(Object(c.a)({},i,{color:65535}))),n.planeYZ.position.set(0,.25,.25),n.planeYZ.rotation.y=Math.PI/2,n.planeYZ.userData.direction=a.PlaneYZ,n.planeXZ=new f.j(r,new f.k(Object(c.a)({},i,{color:16711935}))),n.planeXZ.position.set(.25,0,.25),n.planeXZ.rotation.x=Math.PI/2,n.planeXZ.userData.direction=a.PlaneXZ,n.planeXY=new f.j(r,new f.k(Object(c.a)({},i,{color:16776960}))),n.planeXY.position.set(.25,.25,0),n.planeXY.userData.direction=a.PlaneXY,n.add(n.planeYZ),n.add(n.planeXZ),n.add(n.planeXY),n}return Object(v.a)(t,e),Object(u.a)(t,[{key:"getControlFromRaycaster",value:function(e){if(!this.activeMesh)return null;this.position.copy(this.activeMesh.position);var t=e.intersectObjects(this.children),n=!0,a=!1,i=void 0;try{for(var s,r=t[Symbol.iterator]();!(n=(s=r.next()).done);n=!0){var o=s.value,c=o.object;if(c.userData.hasOwnProperty("direction"))return this.dragOffset.copy(o.point).sub(this.activeMesh.position),c}}catch(l){a=!0,i=l}finally{try{n||null==r.return||r.return()}finally{if(a)throw i}}return null}},{key:"onClick",value:function(e){var t=this.getControlFromRaycaster(e);return!(!t||!t.userData.hasOwnProperty("direction"))&&(this.objectDragDirection=t.userData.direction,this.onMove(e),!0)}},{key:"onMove",value:function(e){var t=e.ray;if(null!==this.objectDragDirection&&this.activeMesh){var n=this.activeMesh.position,i=this.plane,s=null;switch(this.objectDragDirection){case a.AxisX:i.set(new f.u(0,1,0),-n.y),s=new f.n(new f.u(0,0,1),-n.z);break;case a.AxisY:i.set(new f.u(1,0,0),-n.x),s=new f.n(new f.u(0,0,1),-n.z);break;case a.AxisZ:i.set(new f.u(1,0,0),-n.x),s=new f.n(new f.u(0,1,0),-n.y);break;case a.PlaneXY:i.set(new f.u(0,0,1),-n.z);break;case a.PlaneYZ:i.set(new f.u(1,0,0),-n.x);break;case a.PlaneXZ:i.set(new f.u(0,1,0),-n.y)}s&&Math.abs(s.distanceToPoint(t.origin))>Math.abs(i.distanceToPoint(t.origin))&&i.copy(s);var r=t.intersectPlane(i,new f.u);if(r){switch(r.sub(this.dragOffset),this.objectDragDirection){case a.AxisX:this.activeMesh.position.x=r.x;break;case a.AxisY:this.activeMesh.position.y=r.y;break;case a.AxisZ:this.activeMesh.position.z=r.z;break;default:this.activeMesh.position.copy(r)}this.options.onTranslate(this.activeMesh.position)}}}}]),t}(f.s);!function(e){e[e.Primary=0]="Primary",e[e.Middle=1]="Middle",e[e.Secondary=2]="Secondary"}(b||(b={}));var x={up:new f.u(0,1,0),down:new f.u(0,-1,0),left:new f.u(-1,0,0),right:new f.u(1,0,0),forwards:new f.u(0,0,-1),backwards:new f.u(0,0,1)},k=function(){function e(t){var n=this;Object(l.a)(this,e),this.options=t,this.target=null,this.rafHandle=0,this.previousTimestamp=0,this.scene=new f.s,this.controls=new g({onTranslate:this.options.onTranslate}),this.camera=new f.m(75,1,.1,1e3),this.renderer=new f.v,this.canvas=void 0,this.grid=new f.i(10,10,16777215,16777215),this.smallCube=new f.j,this.outlineMesh=new f.j,this.raycaster=new f.r,this.keys=new w(this.renderer.domElement),this.gamepads=new y,this.isDraggingCamera=!1,this.resize=function(){if(n.target){var e=n.target,t=e.offsetWidth,a=e.offsetHeight;n.camera.aspect=t/a,n.camera.updateProjectionMatrix(),n.renderer.setPixelRatio(window.devicePixelRatio),n.renderer.setSize(t,a)}},this.animate=function(e){n.rafHandle=window.requestAnimationFrame(n.animate);var t=(e-n.previousTimestamp)/1e3;n.previousTimestamp=e,n.update(t),n.renderer.clear(),n.renderer.render(n.scene,n.camera),n.controls.activeMesh&&(n.controls.position.copy(n.controls.activeMesh.position),n.renderer.clearDepth(),n.renderer.render(n.controls,n.camera))},this.onClick=function(e){},this.onMouseDown=function(e){e.button===b.Secondary&&(n.isDraggingCamera=!0,n.canvas.requestPointerLock()),e.button===b.Primary&&(n.updateRaycaster(e),n.controls.onClick(n.raycaster)?n.canvas.style.cursor="grabbing":n.checkSceneClick(n.raycaster))},this.onMouseUp=function(e){e.button===b.Secondary&&n.isDraggingCamera&&(n.isDraggingCamera=!1,document.exitPointerLock()),e.button===b.Primary&&null!==n.controls.objectDragDirection&&(n.controls.objectDragDirection=null,n.controls.getControlFromRaycaster(n.raycaster)?n.canvas.style.cursor="grab":n.canvas.style.cursor=null)},this.onMouseMove=function(e){n.isDraggingCamera?(e.movementX&&n.camera.rotateOnWorldAxis(new f.u(0,-1,0),e.movementX/100),e.movementY&&n.camera.rotateOnAxis(new f.u(-1,0,0),e.movementY/100)):(n.updateRaycaster(e),null!==n.controls.objectDragDirection?n.controls.onMove(n.raycaster):n.controls.getControlFromRaycaster(n.raycaster)?n.canvas.style.cursor="grab":n.canvas.style.cursor=null)},this.onWheel=function(e){e.preventDefault();var t=e.deltaY;0===e.deltaMode&&(t/=15),n.camera.translateZ(t/10)},this.renderer.autoClear=!1,this.renderer.setClearColor(new f.f(1649238)),this.canvas=this.renderer.domElement,this.canvas.tabIndex=-1,this.canvas.addEventListener("click",this.onClick),this.canvas.addEventListener("mousedown",this.onMouseDown),this.canvas.addEventListener("mouseup",this.onMouseUp),this.canvas.addEventListener("mousemove",this.onMouseMove),this.canvas.addEventListener("wheel",this.onWheel),this.canvas.addEventListener("contextmenu",function(e){return e.preventDefault(),e.stopPropagation(),!1},!0);var a=new f.a(16777215,.5);this.scene.add(a);var i=new f.p(16777215,.5);i.position.set(5,5,0),i.lookAt(0,0,0),this.scene.add(i);var s=new f.e(1,1,1),r=new f.l,o=new f.j(s,r);o.position.y+=.5,o.name="New cube",this.smallCube.geometry=new f.e(.25,.25,.25),this.smallCube.material=r,this.smallCube.translateX(2),this.smallCube.name="Small cube",this.scene.add(o),this.scene.add(this.smallCube),this.scene.add(this.grid),this.camera.position.z=3,this.camera.position.y=3,this.camera.lookAt(o.position);var c=new f.k({color:16777215,side:f.d});this.outlineMesh.material=c,this.outlineMesh.scale.multiplyScalar(1.05),console.log(this.scene.toJSON());var u=new f.b,h=new f.q(u);(new f.c).load("audio/breakbeat.wav",function(e){h.setBuffer(e),h.setLoop(!0)},function(){},function(e){return console.error(e)}),o.add(h),this.camera.add(u)}return Object(u.a)(e,[{key:"attach",value:function(e){this.keys.listen(),this.gamepads.listen(),this.target=e,e.appendChild(this.canvas),this.resize(),window.requestAnimationFrame(this.animate),window.addEventListener("resize",this.resize),this.canvas.focus()}},{key:"detach",value:function(){window.cancelAnimationFrame(this.rafHandle),window.removeEventListener("resize",this.resize),this.target&&(this.target.removeChild(this.canvas),this.target=null),this.keys.stop(),this.gamepads.stop()}},{key:"update",value:function(e){this.keys.isPressed("w")&&this.camera.translateOnAxis(x.forwards,2*e),this.keys.isPressed("s")&&this.camera.translateOnAxis(x.backwards,2*e),this.keys.isPressed("a")&&this.camera.translateOnAxis(x.left,2*e),this.keys.isPressed("d")&&this.camera.translateOnAxis(x.right,2*e),this.keys.isPressed(" ")&&(this.camera.position.y+=2*e),this.keys.isPressed("Shift")&&(this.camera.position.y-=2*e),this.keys.isPressed("ArrowLeft")&&this.camera.rotateOnWorldAxis(new f.u(0,1,0),e),this.keys.isPressed("ArrowRight")&&this.camera.rotateOnWorldAxis(new f.u(0,-1,0),e),this.keys.isPressed("ArrowUp")&&this.camera.rotateOnAxis(new f.u(1,0,0),e),this.keys.isPressed("ArrowDown")&&this.camera.rotateOnAxis(new f.u(-1,0,0),e);var t=this.gamepads.getAxis(0),n=this.gamepads.getAxis(1),a=this.gamepads.getAxis(2),i=this.gamepads.getAxis(3),s=this.gamepads.getAxis(4);t&&this.camera.translateOnAxis(new f.u(1,0,0),2*e*t),n&&this.camera.translateOnAxis(new f.u(0,0,1),2*e*n),s&&this.camera.translateOnAxis(new f.u(0,1,0),2*e*s),a&&this.camera.rotateOnWorldAxis(new f.u(0,-1,0),e*a),i&&this.camera.rotateOnAxis(new f.u(-1,0,0),e*i)}},{key:"checkSceneClick",value:function(e){this.controls.activeMesh&&(this.controls.activeMesh.remove(this.outlineMesh),this.controls.activeMesh=null);var t=e.intersectObjects(this.scene.children),n=!0,a=!1,i=void 0;try{for(var s,r=t[Symbol.iterator]();!(n=(s=r.next()).done);n=!0){var o=s.value.object;if(o.isMesh)return this.controls.activeMesh=o,this.outlineMesh.geometry=this.controls.activeMesh.geometry,this.controls.activeMesh.add(this.outlineMesh),this.options.onSelect(o),!0}}catch(c){a=!0,i=c}finally{try{n||null==r.return||r.return()}finally{if(a)throw i}}return this.options.onSelect(null),!1}},{key:"updateRaycaster",value:function(e){var t=this.renderer.getSize(new f.t),n=(e.pageX-this.canvas.offsetLeft)/t.x*2-1,a=-(e.pageY-this.canvas.offsetTop)/t.y*2+1;this.raycaster.setFromCamera({x:n,y:a},this.camera)}}]),e}();function j(){var e=Object(p.a)(["\n  display: block;\n  appearance: none;\n  background: rgba(0, 0, 0, 0.2);\n  border-radius: 3px;\n  border: 1px solid rgba(0, 0, 0, 0.5);\n  color: #fff;\n  width: 100%;\n  padding: 5px 10px;\n  margin: 5px 0;\n\n  transition: 0.2s ease border-color;\n  :focus {\n    border-color: #fff;\n  }\n"]);return j=function(){return e},e}function O(){var e=Object(p.a)(["\n  margin: 20px 0;\n"]);return O=function(){return e},e}function M(){var e=Object(p.a)(["\n  flex: 1;\n  height: 100%;\n"]);return M=function(){return e},e}function A(){var e=Object(p.a)(["\n  width: 250px;\n  height: 100%;\n  background: #34495e;\n  color: #fff;\n  padding: 10px 15px;\n"]);return A=function(){return e},e}function P(){var e=Object(p.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  background: #000;\n  display: flex;\n"]);return P=function(){return e},e}var C=m.a.div(P()),D=m.a.aside(A()),E=m.a.main(M()),X=m.a.div(O()),Y=m.a.input(j()),Z=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(h.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(i)))).state={selectedObject:null},n.mainRef=s.a.createRef(),n.sceneCanvas=new k({onSelect:function(e){e?n.setState({selectedObject:{id:e.id,name:e.name,position:e.position,rotation:e.rotation}}):n.setState({selectedObject:null})},onTranslate:function(e){n.setState(function(t){var n=t.selectedObject;return{selectedObject:n&&Object(c.a)({},n,{position:e})}})}}),n}return Object(v.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.mainRef.current&&this.sceneCanvas.attach(this.mainRef.current)}},{key:"componentWillUnmount",value:function(){this.sceneCanvas.detach()}},{key:"updateName",value:function(e){this.sceneCanvas.controls.activeMesh&&(this.sceneCanvas.controls.activeMesh.name=e),this.setState(function(t){var n=t.selectedObject;return{selectedObject:n&&Object(c.a)({},n,{name:e})}})}},{key:"updatePosition",value:function(e,t,n){this.sceneCanvas.controls.activeMesh&&this.sceneCanvas.controls.activeMesh.position.set(e,t,n),this.setState(function(a){var i=a.selectedObject;return{selectedObject:i&&Object(c.a)({},i,{position:new f.u(e,t,n)})}})}},{key:"updateRotation",value:function(e,t,n){this.sceneCanvas.controls.activeMesh&&this.sceneCanvas.controls.activeMesh.rotation.set(e,t,n),this.setState(function(a){var i=a.selectedObject;return{selectedObject:i&&Object(c.a)({},i,{rotation:new f.h(e,t,n)})}})}},{key:"render",value:function(){var e=this,t=this.state.selectedObject;return s.a.createElement(C,null,s.a.createElement(D,null,s.a.createElement("p",null,"Sidebar"),t&&s.a.createElement("div",null,"Selected object with id ",t.id,s.a.createElement(X,null,s.a.createElement(Y,{type:"text",value:t.name,onChange:function(t){return e.updateName(t.currentTarget.value)}})),s.a.createElement(X,null,s.a.createElement(Y,{type:"number",step:.001,value:t.position.x.toFixed(3),onChange:function(n){return e.updatePosition(n.currentTarget.valueAsNumber,t.position.y,t.position.z)}}),s.a.createElement(Y,{type:"number",step:.001,value:t.position.y.toFixed(3),onChange:function(n){return e.updatePosition(t.position.x,n.currentTarget.valueAsNumber,t.position.z)}}),s.a.createElement(Y,{type:"number",step:.001,value:t.position.z.toFixed(3),onChange:function(n){return e.updatePosition(t.position.x,t.position.y,n.currentTarget.valueAsNumber)}})),s.a.createElement(X,null,s.a.createElement(Y,{type:"number",step:.01,value:t.rotation.x.toFixed(2),onChange:function(n){return e.updateRotation(n.currentTarget.valueAsNumber,t.rotation.y,t.rotation.z)}}),s.a.createElement(Y,{type:"number",step:.01,value:t.rotation.y.toFixed(2),onChange:function(n){return e.updateRotation(t.rotation.x,n.currentTarget.valueAsNumber,t.rotation.z)}}),s.a.createElement(Y,{type:"number",step:.01,value:t.rotation.z.toFixed(2),onChange:function(n){return e.updateRotation(t.rotation.x,t.rotation.y,n.currentTarget.valueAsNumber)}})))),s.a.createElement(E,{ref:this.mainRef}))}}]),t}(s.a.Component);n(32),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(s.a.createElement(Z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[18,2,1]]]);
//# sourceMappingURL=main.b9dc014b.chunk.js.map