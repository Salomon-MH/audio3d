{"version":3,"sources":["audio/AudioImplementation.ts","data/export.ts","data/db.ts","audio/defaultAudioContext.ts","utils/iter.ts","project/GameObject.ts","project/AudioLibrary.ts","project/CodeBlock.ts","utils/math.ts","audio/binaural/BinauralSource.ts","audio/binaural/BinauralScene.ts","audio/Audio3D.ts","audio/Listener3D.ts","audio/binaural/hrtf.ts","audio/AudioScene.ts","project/SpawnMarker.ts","project/Room.ts","project/Project.ts","utils/files.ts","data/import.ts","input/GamepadListener.ts","input/KeyboardListener.ts","runtime/Runtime.ts","runtime/styled.ts","runtime/RuntimeContainer.tsx","editor/Modal.tsx","editor/AudioFileModal.tsx","editor/AudioLibraryModal.tsx","editor/MenuBar.tsx","utils/react.ts","editor/styled.ts","editor/VisualControls.ts","editor/ObjectEditor.tsx","editor/EditorCanvas.ts","editor/RoomEditor.tsx","editor/ProjectInfoModal.tsx","editor/ProjectManagerModal.tsx","editor/SettingsModal.tsx","editor/Editor.tsx","editor/SpawnEditor.tsx","editor/ProjectSaveModal.tsx","editor/ProjectLoadedModal.tsx","serviceWorker.ts","index.tsx"],"names":["AudioImplementation","createZip","_ref","Object","asyncToGenerator","regenerator_default","a","mark","_callee","project","metadata","zip","audioLibrary","audioFolder","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_iterator","_step","_value","_value2","_value3","key","value","wrap","_context","prev","next","toData","Zip","file","JSON","stringify","folder","asyncIterator","entries","sent","done","slicedToArray","push","id","name","type","toString","data","t0","return","finish","abrupt","generateAsync","stop","this","_x","apply","arguments","saveAsZip","_ref2","_callee2","_context2","saveAs","concat","_x2","dbPromise","openDB","upgrade","db","oldVersion","deleteObjectStore","createObjectStore","keyPath","autoIncrement","createIndex","saveProject","put","_x3","deleteProject","_ref3","_callee3","tx","projects","audios","cursor","_context3","transaction","objectStore","delete","index","openKeyCursor","primaryKey","continue","_x4","getAllProjects","_ref4","_callee4","_context4","getAllFromIndex","loadAudio","_ref5","_callee5","projectId","audioId","_context5","get","_x5","_x6","saveAudio","_ref6","_callee6","audio","_context6","_x7","saveAudioMap","_ref7","_callee7","audioMap","_ref10","_ref9","entry","_context7","undefined","Symbol","iterator","store","objectSpread","_x8","_x9","deleteAudio","_ref11","_callee8","_context8","_x10","_x11","_callee9","_context9","awaitAsyncGenerator","openCursor","defaultAudioContext","AudioContext","element","InteractionType","AudioLibrary","Map","nextId","set","clear","_iterateProjectAudios","iterateProjectAudios","_wrapIteratorAsync","wrapIteratorAsync","CodeBlock","source","length","classCallCheck","func","object","roomState","Function","call","playerState","ex","console","error","cubeGeometry","BoxGeometry","cubeMaterial","MeshLambertMaterial","GameObject","audioScene","_this","possibleConstructorReturn","getPrototypeOf","audioFile","interactionType","None","interactionAudioId","codeBlock","teleportTarget","createAudio3D","add","volume","execute","activeRoom","Teleport","_this$teleportTarget","roomId","spawnId","teleportPlayer","playAudio","PlaySound","loop","decodeAudioData","slice","buffer","setBuffer","setLoop","play","log","uuid","position","toArray","scale","rotation","codeBlockSource","Mesh","radToDeg","rad","Math","PI","degToRad","deg","roundToPrecision","precision","round","BinauralSource","scene","Vector3","orientation","binauralFIR","BinauralFIR","audioContext","HRTFDataset","hrtfDataset","connect","destination","input","distance","listenerPosition","azimuth","atan2","x","z","listenerAzimuth","listenerOrientation","elevation","y","sqrt","setPosition","dummyHRTFDataset","createBuffer","sampleRate","BinauralScene","sources","err","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","update","Audio3D","webAudioContext","binauralAudioContext","resonanceAudioContext","webAudioPannerNode","binauralSource","resonanceSource","webAudioGainNode","binauralGainNode","resonanceGainNode","webAudioBufferSource","binauralBufferSource","resonanceBufferSource","hasStarted","isPlaying","onAudioEnded","stopAll","createGain","createBufferSource","onended","gain","force","esm_get","prototype","quaternion","Quaternion","matrixWorld","decompose","applyQuaternion","setOrientation","copy","setFromMatrix","start","disconnect","distanceModel","Object3D","Listener3D","webAudioListener","binauralScene","resonanceScene","up","setListenerFromMatrix","firCoefficientsToAudioBuffer","firCoeffsLeft","firCoeffsRight","copyToChannel","Float32Array","loadHRTFDataset","resp","dataset","fetch","json","map","hrtf","fir_coeffs_left","fir_coeffs_right","AudioScene","options","audioImplementation","WebAudio","ResonanceAudio","binauralHRTFDataset","isLoadingBinauralHRTFDataset","listener3D","listener","setRoomProperties","dimensions","Utils","DEFAULT_ROOM_DIMENSIONS","materials","DEFAULT_ROOM_MATERIALS","output","suspend","createPanner","createSource","close","resume","Binaural","loadBinauralHRTFDataset","setHRTFDataset","roomDimensions","roomMaterials","spawnGeometry","spawnMaterial","color","directionGeometry","SpawnMarker","directionMarker","wallGeometry","wallMaterial","Room","width","depth","height","grid","wallNorth","wallEast","wallSouth","wallWest","camera","PerspectiveCamera","collisionAudio","footstepAudio","interactAvailAudio","spawns","ambientLight","AmbientLight","light","PointLight","lookAt","gridSize","max","GridHelper","updateWalls","remove","marker","panningModel","setRolloff","rollofModel","_this$roomDimensions","s","objects","children","filter","c","go","_this2","fromData","toConsumableArray","addSpawn","gameObjects","o","Scene","noop","defaultEvents","onSelectSpawn","onSelectObject","onScale","onTranslate","Project","events","rooms","ambisonicOrder","DEFAULT_AMBISONIC_ORDER","DEFAULT_ATTENUATION_ROLLOFF","playerHeight","collisionAudioId","footstepAudioId","interactAvailAudioId","collisionAudioFile","footstepAudioFile","interactAvailAudioFile","collisionAudioBuffer","footstepAudioBuffer","interactAvailAudioBuffer","activeAudioImplementation","activeSpawn","activeObject","outlineMesh","firstRoom","addObject","material","MeshBasicMaterial","side","BackSide","multiplyScalar","room","setAmbisonicOrder","selectRoom","model","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","obj","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","order","_iteratorNormalCompletion6","_didIteratorError6","_iteratorError6","_step6","_iterator6","_iteratorNormalCompletion7","_didIteratorError7","_iteratorError7","_step7","_iterator7","_iteratorNormalCompletion8","_didIteratorError8","_iteratorError8","_step8","_iterator8","selectAudioImplementation","aspect","updateProjectionMatrix","unselect","geometry","find","r","spawn","_iterator9","_iteratorNormalCompletion9","_step9","_iterator10","_iteratorNormalCompletion10","_step10","_iterator11","_iteratorNormalCompletion11","_step11","saveToProject","savedAt","Date","nextAudioId","i","selectPanningModel","selectDistanceModel","selectAmbisonicOrder","selectRollofModel","setCollisionAudio","setFootstepAudio","setInteractAvailAudio","openFileDialog","Promise","resolve","document","createElement","accept","onchange","files","click","readFileAsArrayBuffer","reader","FileReader","onload","result","onerror","readAsArrayBuffer","loadZip","blob","loadAsync","async","t1","parse","t2","t3","t4","openZip","GamepadListener","onGamepadConnected","e","gamepad","onGamepadDisconnected","window","addEventListener","removeEventListener","gamepads","navigator","getGamepads","mapping","axis","axes","abs","v1","buttons","pressed","normalizeKey","toLocaleLowerCase","KeyboardListener","target","keysPressed","Set","lastKeyUp","reset","onKeyDown","preventDefault","timeStamp","onKeyUp","onClick","button","shiftKey","has","Runtime","rafHandle","previousTimestamp","lastCollisionSound","lastKnownButtonStatus","shouldRender","renderer","WebGLRenderer","canvas","raycaster","Raycaster","dummyCamera","keys","domElement","resize","_this$target","offsetWidth","offsetHeight","setPixelRatio","devicePixelRatio","setSize","animate","t","requestAnimationFrame","dt","render","updateMatrixWorld","tabIndex","listen","appendChild","cancelAnimationFrame","removeChild","focus","check","from","to","min","toInteractWith","triggerInteraction","moveX","moveZ","rotateY","isPressed","newZ","newX","newY","gamepadAxes","getAxis","rotateOnWorldAxis","translateOnAxis","collided","bbox","Box3","setFromObject","bboxposition","getCenter","bboxscale","getSize","boundX1","boundX2","boundY1","boundY2","boundZ1","boundZ2","isBetween","now","nearestDist","Infinity","nearestObj","setFromCamera","intersections","intersectObjects","intersection","selectObject","getButtonStatus","invokeInteraction","FocusedLabel","styled","div","_templateObject","RunningLabel","_templateObject2","RunningHeadline","p","_templateObject3","RunningButtonContainer","_templateObject4","RunningButton","_templateObject5","props","selected","css","_templateObject6","_templateObject7","ControlsTable","table","_templateObject8","Main","main","_templateObject9","RuntimeContainer","targetRef","React","createRef","runtime","activeButtonRef","state","onExit","detach","onVisualToggle","toggleRendering","onChangeAudio","event","setState","current","attach","react_default","ref","Component","Backdrop","Modal_templateObject","Container","Modal_templateObject2","TitleBar","Modal_templateObject3","Content","Modal_templateObject4","ActionGroup","Modal_templateObject5","Action","Modal_templateObject6","Modal","onBackdropClick","currentTarget","onDismiss","title","AudioFileModal","audioEntry","Modal_Modal","ceil","byteLength","onDelete","onExport","onCancel","AudioList","AudioLibraryModal_templateObject","AudioItem","AudioLibraryModal_templateObject2","AudioLibraryModal","previewAudio","Audio","selectedEntry","openAudioFileDialog","stopPreview","pause","URL","revokeObjectURL","src","dismiss","unselectEntry","exportAudio","Blob","createObjectURL","onSelect","sort","b","updateEntries","prevProps","_this$state","AudioFileModal_AudioFileModal","selectEntry","onMouseEnter","previewEntry","onMouseLeave","MenuType","MenuBar_templateObject","MenubarItem","MenuBar_templateObject2","isActive","MenuBar_templateObject3","alignRight","MenuBar_templateObject4","MenubarItemLabel","label","MenuBar_templateObject5","Menu","MenuBar_templateObject6","MenuItem","MenuBar_templateObject7","MenuDivider","MenuBar_templateObject8","MenuBar","activeMenu","menuType","_this$props","onAudioChange","MenuBar_Container","onBlur","closeMenu","FileMenu","toggleMenu","hidden","onNewProject","onLoadProject","onImportProject","onSaveProject","onExportProject","onShowSettings","EditMenu","onAddObject","onDeleteObject","onAddSpawn","onDeleteSpawn","onAddRoom","onDeleteRoom","ViewMenu","onShowAudioLibrary","onShowProjectManager","HelpMenu","open","onRunProject","AudioMenu","selectOnFocus","select","ControlMode","ObjectDragDirection","styled_templateObject","InnerContainer","styled_templateObject2","styled_templateObject3","styled_templateObject4","Sidebar","aside","styled_templateObject5","Group","styled_templateObject6","BoldLabel","styled_templateObject7","Hint","styled_templateObject8","Input","styled_templateObject9","Select","withComponent","_templateObject10","CustomInput","_templateObject11","CodeEditor","_templateObject12","InputGroup","_templateObject13","RoomList","ol","_templateObject14","RoomListItem","li","_templateObject15","active","_templateObject16","ObjectEditor","codeCheckTimeout","checkCode","codeError","updateCodeBlockSource","onUpdateCodeBlockSource","clearTimeout","setTimeout","updateTeleportTargetRoomId","onUpdateTeleportTarget","updateTeleportTargetSpawnId","_this$props2","onUpdateName","onUpdatePosition","onUpdateRotation","onUpdateVolume","onUpdateScale","onUpdateInteractionType","onShowAudioSelection","onShowInteractionAudioSelection","teleportTargetRoom","readOnly","onFocus","placeholder","onChange","step","toFixed","valueAsNumber","Fragment","values","interactionAudio","MouseButton","VisualControls","objectDragDirection","isScaling","dragOffset","lastPoint","plane","Plane","axisX","axisY","axisZ","scaleX","scaleY","scaleZ","planeYZ","planeXZ","planeXY","materialConfig","transparent","opacity","DoubleSide","axisGeometry","userData","direction","AxisX","AxisY","AxisZ","scaleGeometry","SphereGeometry","isScale","planeGeometry","PlaneGeometry","PlaneYZ","PlaneXZ","PlaneXY","controlMode","RestrictedXZ","visible","hasOwnProperty","point","sub","getControlFromRaycaster","onMove","ray","altPlane","distanceToPoint","origin","intersectPlane","EditorCanvas","controls","isDraggingCamera","setMode","Normal","clearDepth","onMouseDown","Secondary","requestPointerLock","Primary","updateRaycaster","style","checkSceneClick","onMouseUp","exitPointerLock","onMouseMove","movementX","movementY","rotateOnAxis","onWheel","delta","deltaY","deltaMode","translateZ","autoClear","setClearColor","Color","stopPropagation","selectSpawn","size","Vector2","pageX","offsetLeft","pageY","offsetTop","ROOM_MATERIAL_COEFFICIENTS","RoomEditor","propertyName","onUpdateMaterials","defineProperty","onUpdateDimensions","materialOptions","ce","left","selectMaterialHandler","right","front","back","down","ProjectInfoModal","toLocaleString","TableContainer","ProjectManagerModal_templateObject","Table","ProjectManagerModal_templateObject2","TableHead","thead","ProjectManagerModal_templateObject3","TableRow","tr","ProjectManagerModal_templateObject4","ColumnHead","th","ProjectManagerModal_templateObject5","ColumnData","td","ProjectManagerModal_templateObject6","ProjectManagerModal","selectedProject","unselectProject","exportProject","onSelectProject","reverse","ProjectInfoModal_ProjectInfoModal","selectProject","AudioSelectionTarget","SettingsModal_templateObject","ModalType","SettingsModal","onProjectNameChanged","projectName","hideAudioSelection","audioSelectionTarget","selectAudio","Footstep","Collision","InteractAvail","selectedOrder","parseInt","onProjectChanged","AudioLibraryModal_AudioLibraryModal","SettingsModal_InnerContainer","SpawnEditor","ProjectSaveModal","onNameChange","submit","onSave","onSubmit","autoFocus","required","disabled","ProjectLoadedModal","onConfirm","Editor","projectCanvas","selectedRoomId","selectedSpawn","selectedObject","modal","runningProject","ObjectAudio","mainRef","newProject","onTranslateObject","onScaleObject","changeProject","showProjectSelection","ProjectSelection","ProjectSaver","save","importProject","_project","alert","ProjectLoaded","deleteObject","deleteSpawn","splice","indexOf","addRoom","deleteRoom","showAudioLibrary","showProjectManager","ProjectManager","runProject","showSettings","Settings","updateRoomName","updateRoomDimensions","updateRoomMaterials","updateSpawnName","updateSpawnPosition","_ref8","updateSpawnRotation","updateObjectName","updateObjectVolume","updateObjectScale","_ref12","updateObjectPosition","_ref13","updateObjectRotation","_ref14","Euler","updateObjectInteractionType","defaultTarget","_ref15","updateObjectCodeBlockSource","_ref16","updateObjectTeleportTarget","_ref17","showAudioSelection","AudioSelection","showInteractionAudioSelection","InteractionAudio","dismissModal","_ref18","_ref19","loadProject","saveNewProject","_ref20","resumeProject","_ref21","_ref22","_ref23","exitRuntime","attachCanvas","_this$state2","RuntimeContainer_RuntimeContainer","styled_Container","ProjectManagerModal_ProjectManagerModal","ProjectSaveModal_ProjectSaveModal","ProjectLoadedModal_ProjectLoadedModal","SettingsModal_SettingsModal","MenuBar_MenuBar","RoomEditor_RoomEditor","SpawnEditor_SpawnEditor","ObjectEditor_ObjectEditor","styled_Main","styled_FocusedLabel","Boolean","location","hostname","match","webkitAudioContext","nw","w","Window","maximize","on","frame","url","policy","ignore","Shell","openExternal","confirm","ReactDOM","Editor_Editor","getElementById","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.fcc4d8df.chunk.js","sourcesContent":["enum AudioImplementation {\n  WebAudio = \"Web Audio API\",\n  Binaural = \"BinauralFIR\",\n  ResonanceAudio = \"Resonance Audio\"\n}\n\nexport default AudioImplementation;\n","/**\n * @author Niklas Korz\n * This module defines functions for exporting and saving projects to the local filesystem.\n */\nimport { saveAs } from \"file-saver\";\nimport Zip from \"jszip\";\nimport Project from \"../project/Project\";\n\n/**\n * Serializes the given project as JSON and compresses it along its audio\n * data in a ZIP file. The audio data is saved as one file per audio in a\n * dedicated subdirectory \"audio\".\n */\nexport const createZip = async (project: Project): Promise<Blob> => {\n  const metadata = project.toData();\n  const zip = new Zip();\n  zip.file(\"metadata.json\", JSON.stringify(metadata));\n\n  const audioLibrary: Array<{ id: number; name: string; type: string }> = [];\n  const audioFolder = zip.folder(\"audio\");\n  for await (const [key, value] of project.audioLibrary.entries()) {\n    audioLibrary.push({ id: key, name: value.name, type: value.type });\n    audioFolder.file(key.toString(), value.data);\n  }\n  zip.file(\"audioLibrary.json\", JSON.stringify(audioLibrary));\n\n  return zip.generateAsync({ type: \"blob\" });\n};\n\n/**\n * Saves the given project, including its audio data, as a zip file on the\n * user's local filesystem\n */\nexport const saveAsZip = async (project: Project): Promise<void> => {\n  const data = await createZip(project);\n  saveAs(data, `${project.name}.audio3d.zip`);\n};\n","/**\n * @author Niklas Korz\n * Module for loading and saving projects and audio files from/to IndexedDB.\n */\nimport { openDB } from \"idb\";\nimport Project from \"../project/Project\";\nimport { Schema, AudioWithIds, AudioFile, ProjectData } from \"./schema\";\n\nconst dbPromise = openDB<Schema>(\"audio3d\", 2, {\n  upgrade(db, oldVersion) {\n    if (oldVersion === 1) {\n      // Version 1 didn't store the unique ids of rooms and objects.\n      // As we can't retrieve them, we'll delete any old versions of the\n      // database here.\n      db.deleteObjectStore(\"projects\");\n      db.deleteObjectStore(\"audios\");\n    }\n\n    const projectStore = db.createObjectStore(\"projects\", {\n      keyPath: \"id\",\n      autoIncrement: true\n    });\n    projectStore.createIndex(\"savedAt\", \"savedAt\");\n    const audioStore = db.createObjectStore(\"audios\", {\n      keyPath: [\"projectId\", \"audioId\"]\n    });\n    audioStore.createIndex(\"project\", \"projectId\");\n  }\n});\n\nexport const loadProject = async (id: number): Promise<Project | undefined> => {\n  const db = await dbPromise;\n  const data = await db.get(\"projects\", id);\n  return data && new Project().fromData(data);\n};\n\nexport const saveProject = async (project: Project): Promise<number> => {\n  const db = await dbPromise;\n  const data = project.toData();\n  if (project.id) {\n    data.id = project.id;\n  }\n  return await db.put(\"projects\", data);\n};\n\nexport const deleteProject = async (id: number): Promise<void> => {\n  const db = await dbPromise;\n  // Database transaction\n  const tx = db.transaction([\"audios\", \"projects\"], \"readwrite\");\n  // Object stores\n  const projects = tx.objectStore(\"projects\");\n  const audios = tx.objectStore(\"audios\");\n\n  // Delete project\n  await projects.delete(id);\n\n  // Delete all related audio files\n  let cursor = await audios.index(\"project\").openKeyCursor(id);\n  while (cursor) {\n    await audios.delete(cursor.primaryKey);\n    cursor = await cursor.continue();\n  }\n\n  await tx.done;\n};\n\nexport const getAllProjects = async (): Promise<ProjectData[]> => {\n  const db = await dbPromise;\n  return await db.getAllFromIndex(\"projects\", \"savedAt\");\n};\n\nexport const loadAudio = async (\n  projectId: number,\n  audioId: number\n): Promise<AudioWithIds | undefined> => {\n  const db = await dbPromise;\n  const data = await db.get(\"audios\", [projectId, audioId]);\n  return data;\n};\n\nexport const saveAudio = async (audio: AudioWithIds): Promise<void> => {\n  const db = await dbPromise;\n  await db.put(\"audios\", audio);\n};\n\nexport const saveAudioMap = async (\n  projectId: number,\n  audioMap: Map<number, AudioFile>\n): Promise<void> => {\n  const db = await dbPromise;\n  const tx = db.transaction(\"audios\", \"readwrite\");\n  for (const [audioId, entry] of audioMap.entries()) {\n    tx.store.put({ ...entry, projectId, audioId });\n  }\n  await tx.done;\n};\n\nexport const deleteAudio = async (\n  projectId: number,\n  audioId: number\n): Promise<void> => {\n  const db = await dbPromise;\n  await db.delete(\"audios\", [projectId, audioId]);\n};\n\nexport async function* iterateProjectAudios(\n  projectId: number\n): AsyncIterableIterator<[number, AudioFile]> {\n  const db = await dbPromise;\n  const tx = db.transaction(\"audios\");\n  let cursor = await tx.store.index(\"project\").openCursor(projectId);\n  while (cursor) {\n    yield [cursor.value.audioId, cursor.value];\n    cursor = await cursor.continue();\n  }\n  await tx.done;\n}\n","const defaultAudioContext = new AudioContext();\n\nexport default defaultAudioContext;\n","/**\n * @author Niklas Korz\n * This modules defines utility functions for working with iterators\n */\n\n/**\n * Wraps an IterableIterator in an AsyncIterableIterator\n * @param iterator The iterator to be wrapped\n */\nexport async function* wrapIteratorAsync<T>(\n  iterator: IterableIterator<T>\n): AsyncIterableIterator<T> {\n  for (const element of iterator) {\n    yield element;\n  }\n}\n","/**\n * @author Niklas Korz\n */\nimport { BoxGeometry, Mesh, MeshLambertMaterial } from \"three\";\nimport Serializable, { SerializedData } from \"../data/Serializable\";\nimport { ObjectData, AudioFile } from \"../data/schema\";\nimport AudioScene from \"../audio/AudioScene\";\nimport Audio3D from \"../audio/Audio3D\";\nimport defaultAudioContext from \"../audio/defaultAudioContext\";\nimport AudioLibrary from \"./AudioLibrary\";\nimport CodeBlock from \"./CodeBlock\";\nimport Project from \"./Project\";\n\nconst cubeGeometry = new BoxGeometry(1, 1, 1);\nconst cubeMaterial = new MeshLambertMaterial();\n\nexport enum InteractionType {\n  None = \"No interaction\",\n  PlaySound = \"Play sound\",\n  Teleport = \"Teleport\",\n  CodeBlock = \"Code block\"\n}\n\nexport interface TeleportTarget {\n  roomId: string;\n  spawnId: string;\n}\n\nexport default class GameObject extends Mesh implements Serializable {\n  audioLibrary: AudioLibrary;\n  audioId?: number;\n  audioFile?: AudioFile;\n  audio: Audio3D;\n\n  // Interaction specific\n  interactionType = InteractionType.None;\n  interactionAudioId?: number;\n  codeBlock?: CodeBlock;\n  teleportTarget?: TeleportTarget;\n\n  get volume(): number {\n    return this.audio.volume;\n  }\n\n  set volume(volume: number) {\n    this.audio.volume = volume;\n  }\n\n  constructor(audioLibrary: AudioLibrary, audioScene: AudioScene) {\n    super(cubeGeometry, cubeMaterial);\n    this.audioLibrary = audioLibrary;\n    this.audio = audioScene.createAudio3D();\n    this.add(this.audio);\n  }\n\n  triggerInteraction(project: Project): void {\n    switch (this.interactionType) {\n      case InteractionType.CodeBlock:\n        if (this.codeBlock) {\n          this.codeBlock.execute(this, project, project.activeRoom.roomState);\n        }\n        break;\n      case InteractionType.Teleport:\n        if (this.teleportTarget) {\n          const { roomId, spawnId } = this.teleportTarget;\n          project.teleportPlayer(roomId, spawnId);\n        }\n        if (this.interactionAudioId != null) {\n          this.playAudio(this.interactionAudioId);\n        }\n        break;\n      case InteractionType.PlaySound:\n        if (this.interactionAudioId != null) {\n          this.playAudio(this.interactionAudioId);\n        }\n        break;\n      default:\n        break;\n    }\n  }\n\n  async playAudio(id: number, loop: boolean = false): Promise<void> {\n    this.audioId = id;\n    this.audioFile = await this.audioLibrary.get(id);\n    if (this.audioFile) {\n      const buffer = await defaultAudioContext.decodeAudioData(\n        this.audioFile.data.slice(0)\n      );\n      this.audio.setBuffer(buffer);\n      this.audio.setLoop(loop);\n\n      this.audio.play();\n    } else {\n      console.log(\n        \"Audio with id\",\n        id,\n        \"could not be found and can't be played\"\n      );\n    }\n  }\n\n  toData(): ObjectData {\n    return {\n      uuid: this.uuid,\n      name: this.name,\n      volume: this.volume,\n      position: this.position.toArray(),\n      scale: this.scale.toArray(),\n      rotation: this.rotation.toArray().slice(0, 3),\n      audioId: this.audioId,\n      interactionType: this.interactionType,\n      interactionAudioId: this.interactionAudioId,\n      codeBlockSource: this.codeBlock && this.codeBlock.source,\n      teleportTarget: this.teleportTarget\n    };\n  }\n\n  fromData(data: SerializedData): this {\n    this.uuid = data.uuid != null ? data.uuid : this.uuid;\n    this.name = data.name;\n    this.position.set(data.position[0], data.position[1], data.position[2]);\n    this.scale.set(data.scale[0], data.scale[1], data.scale[2]);\n    this.rotation.set(data.rotation[0], data.rotation[1], data.rotation[2]);\n\n    if (data.audioId != null) {\n      this.playAudio(data.audioId, true);\n    }\n\n    if (data.volume != null) {\n      this.volume = data.volume;\n    }\n\n    this.interactionType = data.interactionType || InteractionType.None;\n    this.interactionAudioId = data.interactionAudioId;\n    if (data.codeBlockSource) {\n      this.codeBlock = new CodeBlock(data.codeBlockSource);\n    }\n    this.teleportTarget = data.teleportTarget;\n\n    return this;\n  }\n}\n","/**\n * @author Niklas Korz\n */\nimport { AudioFile } from \"../data/schema\";\nimport {\n  saveAudio,\n  loadAudio,\n  deleteAudio,\n  saveAudioMap,\n  iterateProjectAudios\n} from \"../data/db\";\nimport { wrapIteratorAsync } from \"../utils/iter\";\n\nexport default class AudioLibrary {\n  projectId?: number;\n  audioMap = new Map<number, AudioFile>();\n  nextId = 0;\n\n  async add(entry: AudioFile): Promise<number> {\n    if (this.projectId != null) {\n      await saveAudio({\n        ...entry,\n        projectId: this.projectId,\n        audioId: this.nextId\n      });\n    } else {\n      this.audioMap.set(this.nextId, entry);\n    }\n    return this.nextId++;\n  }\n\n  async get(id: number): Promise<AudioFile | undefined> {\n    if (this.projectId != null) {\n      return await loadAudio(this.projectId, id);\n    }\n    return this.audioMap.get(id);\n  }\n\n  async set(id: number, entry: AudioFile): Promise<void> {\n    if (this.projectId != null) {\n      await loadAudio(this.projectId, id);\n    } else {\n      this.audioMap.set(id, entry);\n    }\n  }\n\n  async delete(id: number): Promise<void> {\n    if (this.projectId != null) {\n      await deleteAudio(this.projectId, id);\n    } else {\n      this.audioMap.delete(id);\n    }\n  }\n\n  async saveToProject(projectId: number): Promise<void> {\n    this.projectId = projectId;\n    await saveAudioMap(projectId, this.audioMap);\n    this.audioMap.clear();\n  }\n\n  entries(): AsyncIterableIterator<[number, AudioFile]> {\n    if (this.projectId != null) {\n      return iterateProjectAudios(this.projectId);\n    }\n    return wrapIteratorAsync(this.audioMap.entries());\n  }\n}\n","import GameObject from \"./GameObject\";\nimport Project from \"./Project\";\n\n/**\n * @author Niklas Korz\n */\nexport default class CodeBlock {\n  source: string;\n  func?: Function;\n\n  constructor(source: string = \"\") {\n    this.source = source;\n  }\n\n  update(source: string): void {\n    this.source = source;\n    this.func = undefined;\n  }\n\n  execute(\n    object: GameObject,\n    project: Project,\n    roomState: Map<string, any>\n  ): void {\n    try {\n      if (!this.func) {\n        this.func = new Function(\n          \"game\",\n          \"playerState\",\n          \"roomState\",\n          this.source\n        );\n      }\n      // The first parameter is the \"this\" object\n      this.func.call(object, project, project.playerState, roomState);\n    } catch (ex) {\n      console.error(\n        \"Execution of code block failed with error:\",\n        ex,\n        \"object:\",\n        object,\n        \"project:\",\n        project,\n        \"roomState:\",\n        roomState\n      );\n    }\n  }\n}\n","/**\n * Useful utility functions related to mathematics\n * @author Niklas Korz\n */\n\n// Converts radiant angles to degrees\nexport const radToDeg = (rad: number): number => (rad * 180) / Math.PI;\n\n// Converts degree angles to radiants\nexport const degToRad = (deg: number): number => (deg / 180) * Math.PI;\n\nexport const roundToPrecision = (value: number, precision: number): number =>\n  Math.round(value / precision) * precision;\n","/**\n * @author Niklas Korz\n * @author Leon Erath\n */\nimport { Vector3 } from \"three\";\nimport BinauralFIR from \"binauralfir\";\nimport { radToDeg } from \"../../utils/math\";\nimport BinauralScene from \"./BinauralScene\";\n\nexport default class BinauralSource {\n  position = new Vector3();\n  orientation = new Vector3();\n  scene: BinauralScene;\n  binauralFIR: BinauralFIR;\n\n  get input(): AudioNode {\n    return this.binauralFIR.input;\n  }\n\n  constructor(scene: BinauralScene) {\n    this.scene = scene;\n    this.binauralFIR = new BinauralFIR({ audioContext: scene.audioContext });\n    this.binauralFIR.HRTFDataset = scene.hrtfDataset;\n    this.binauralFIR.connect(scene.audioContext.destination);\n  }\n\n  update(): void {\n    // The distance calculation is straightforward as BinauralFIR already provides\n    // a utility function.\n    const distance = this.binauralFIR.distance(\n      this.position,\n      this.scene.listenerPosition\n    );\n\n    // The azimuth is the horizontal angle between the listener and the audio source.\n    // It ranges from -180 to +180, where +-180 is directly behind, 0 directly in front,\n    // -90 on the left and +90 on the right.\n    const azimuth = Math.atan2(\n      this.position.x - this.scene.listenerPosition.x,\n      // The three.js z-axis is negative on the front and positive on the back of the listener,\n      // so we have to invert it to match the mathematical unit circle.\n      -(this.position.z - this.scene.listenerPosition.z)\n    );\n\n    // We also have to take the listener's rotation into consideration.\n    // I.e., we take the listener orientation to calculate the total rotation instead\n    // of the Euler angles.\n    // The result is the inverted angle as the z-axis is inverted.\n    const listenerAzimuth = Math.atan2(\n      this.scene.listenerOrientation.x,\n      this.scene.listenerOrientation.z\n    );\n\n    // The elevation is the vertical angle between the listener and the audio source.\n    // It ranges from -90 to +90, where -90 is directly below and +90 directly above.\n    // An angle of zero means both the listener and the audio source are on the same\n    // horizontal plane.\n    // For a better mental model, we imagine the vector between the two points to be\n    // two dimensional. I.e., we use the y axis for the second component and create\n    // an artificial axis for the first component out of the x- and z- coordinates.\n    // This first component equals the length of the two-dimensional vector on the\n    // axes x and z and can therefore be simply calculated with the Pythagoras theorem.\n    // Then, we can use atan2 as in the previous two cases for calculating the vertical angle.\n    const elevation = Math.atan2(\n      this.position.y - this.scene.listenerPosition.y,\n      Math.sqrt(\n        this.position.x -\n          this.scene.listenerPosition.x +\n          -(this.position.z - this.scene.listenerPosition.z)\n      )\n    );\n\n    this.binauralFIR.setPosition(\n      // BinauralFIR expects degrees instead of radians\n      radToDeg(azimuth + listenerAzimuth),\n      radToDeg(elevation),\n      distance\n    );\n  }\n}\n","/**\n * @author Niklas Korz\n * @author Leon Erath\n */\n\nimport { Vector3 } from \"three\";\nimport { HRTF } from \"binauralfir\";\nimport defaultAudioContext from \"../defaultAudioContext\";\nimport BinauralSource from \"./BinauralSource\";\n\nconst dummyHRTFDataset: HRTF[] = [\n  {\n    azimuth: 1,\n    elevation: 1,\n    distance: 1,\n    buffer: defaultAudioContext.createBuffer(\n      2,\n      512,\n      defaultAudioContext.sampleRate\n    )\n  }\n];\n\nexport default class BinauralScene {\n  listenerPosition = new Vector3(0, 0, 0);\n  listenerOrientation = new Vector3(0, 0, 0);\n  sources: BinauralSource[] = [];\n  audioContext: AudioContext;\n  hrtfDataset: HRTF[];\n\n  constructor(\n    audioContext: AudioContext,\n    hrtfDataset: HRTF[] = dummyHRTFDataset\n  ) {\n    this.audioContext = audioContext;\n    this.hrtfDataset = hrtfDataset;\n  }\n\n  createSource(): BinauralSource {\n    const source = new BinauralSource(this);\n    this.sources.push(source);\n    return source;\n  }\n\n  setHRTFDataset(hrtfDataset: HRTF[]): void {\n    this.hrtfDataset = hrtfDataset;\n    for (const source of this.sources) {\n      source.binauralFIR.HRTFDataset = hrtfDataset;\n    }\n  }\n\n  update(): void {\n    for (const source of this.sources) {\n      source.update();\n    }\n  }\n}\n","/**\n * @author Niklas Korz\n * @author Leon Erath\n */\nimport { Object3D, Vector3, Quaternion } from \"three\";\nimport { ResonanceAudio } from \"resonance-audio\";\nimport BinauralSource from \"./binaural/BinauralSource\";\n\n/**\n * Class extends Object3D in order to work with the three.js scene graph.\n * The idea is to override the updateWorldMatrix method and change the audio nodes\n * accordingly.\n */\nexport default class Audio3D extends Object3D {\n  webAudioContext: AudioContext;\n  binauralAudioContext: AudioContext;\n  resonanceAudioContext: AudioContext;\n\n  webAudioPannerNode: PannerNode;\n  binauralSource: BinauralSource;\n  resonanceSource: ResonanceAudio.Source;\n\n  webAudioGainNode: GainNode;\n  binauralGainNode: GainNode;\n  resonanceGainNode: GainNode;\n\n  webAudioBufferSource: AudioBufferSourceNode;\n  binauralBufferSource: AudioBufferSourceNode;\n  resonanceBufferSource: AudioBufferSourceNode;\n\n  hasStarted = false;\n  isPlaying = false;\n\n  get volume(): number {\n    return this.webAudioGainNode.gain.value;\n  }\n\n  set volume(value: number) {\n    this.webAudioGainNode.gain.value = value;\n    this.binauralGainNode.gain.value = value;\n    this.resonanceGainNode.gain.value = value;\n  }\n\n  constructor(\n    webAudioContext: AudioContext,\n    binauralAudioContext: AudioContext,\n    resonanceAudioContext: AudioContext,\n    webAudioPannerNode: PannerNode,\n    binauralSource: BinauralSource,\n    resonanceSource: ResonanceAudio.Source\n  ) {\n    super();\n\n    this.webAudioContext = webAudioContext;\n    this.binauralAudioContext = binauralAudioContext;\n    this.resonanceAudioContext = resonanceAudioContext;\n\n    this.webAudioPannerNode = webAudioPannerNode;\n    this.binauralSource = binauralSource;\n    this.resonanceSource = resonanceSource;\n\n    this.webAudioGainNode = webAudioContext.createGain();\n    this.binauralGainNode = binauralAudioContext.createGain();\n    this.resonanceGainNode = resonanceAudioContext.createGain();\n\n    this.webAudioBufferSource = webAudioContext.createBufferSource();\n    this.binauralBufferSource = binauralAudioContext.createBufferSource();\n    this.resonanceBufferSource = resonanceAudioContext.createBufferSource();\n\n    // Audio graph:\n    // input: buffer source node\n    // => gain node\n    // => 3D audio node\n    // => output\n\n    this.webAudioBufferSource.connect(this.webAudioGainNode);\n    this.binauralBufferSource.connect(this.binauralGainNode);\n    this.resonanceBufferSource.connect(this.resonanceGainNode);\n\n    this.webAudioGainNode.connect(webAudioPannerNode);\n    this.binauralGainNode.connect(binauralSource.input);\n    this.resonanceGainNode.connect(resonanceSource.input);\n\n    this.webAudioPannerNode.connect(webAudioContext.destination);\n\n    this.webAudioBufferSource.onended = this.onAudioEnded;\n    this.binauralBufferSource.onended = this.onAudioEnded;\n    this.resonanceBufferSource.onended = this.onAudioEnded;\n  }\n\n  updateMatrixWorld(force: boolean): void {\n    super.updateMatrixWorld(force);\n\n    const position = new Vector3();\n    const quaternion = new Quaternion();\n    const scale = new Vector3();\n    this.matrixWorld.decompose(position, quaternion, scale);\n    const orientation = new Vector3(0, 0, 1).applyQuaternion(quaternion);\n\n    this.webAudioPannerNode.setPosition(position.x, position.y, position.z);\n    this.webAudioPannerNode.setOrientation(\n      orientation.x,\n      orientation.y,\n      orientation.z\n    );\n\n    this.binauralSource.position.copy(position);\n    this.binauralSource.orientation.copy(orientation);\n    this.binauralSource.update();\n\n    // Resonance Audio already works with matrices similar to three.js internally.\n    this.resonanceSource.setFromMatrix(this.matrixWorld);\n  }\n\n  onAudioEnded = () => {\n    this.stopAll();\n    this.isPlaying = false;\n  };\n\n  setBuffer(buffer: AudioBuffer): void {\n    if (this.webAudioBufferSource.buffer) {\n      // Chrome does not allow \"resetting\" the buffer and throws an error\n      // with this message: Cannot set buffer to non-null after it has been already been set to a non-null buffer\n      // To circumvent this, we have to create a new buffer source\n\n      this.stop();\n\n      this.webAudioBufferSource = this.webAudioContext.createBufferSource();\n      this.binauralBufferSource = this.binauralAudioContext.createBufferSource();\n      this.resonanceBufferSource = this.resonanceAudioContext.createBufferSource();\n\n      this.webAudioBufferSource.connect(this.webAudioGainNode);\n      this.binauralBufferSource.connect(this.binauralGainNode);\n      this.resonanceBufferSource.connect(this.resonanceGainNode);\n\n      this.webAudioBufferSource.onended = this.onAudioEnded;\n      this.binauralBufferSource.onended = this.onAudioEnded;\n      this.resonanceBufferSource.onended = this.onAudioEnded;\n    }\n\n    this.webAudioBufferSource.buffer = buffer;\n    this.binauralBufferSource.buffer = buffer;\n    this.resonanceBufferSource.buffer = buffer;\n\n    this.hasStarted = false;\n    this.isPlaying = false;\n  }\n\n  play(): void {\n    if (this.webAudioBufferSource.buffer) {\n      if (this.hasStarted) {\n        // A buffer source node can only be played once, unfortunately.\n        // We have to \"reset\" the node by creating a new one and reusing the buffer.\n        this.setBuffer(this.webAudioBufferSource.buffer);\n      }\n\n      this.webAudioBufferSource.start();\n      this.binauralBufferSource.start();\n      this.resonanceBufferSource.start();\n\n      this.hasStarted = true;\n      this.isPlaying = true;\n    }\n  }\n\n  stop(): void {\n    this.isPlaying = false;\n    if (this.hasStarted) {\n      this.stopAll();\n    }\n  }\n\n  stopAll(): void {\n    try {\n      this.webAudioBufferSource.stop();\n      this.binauralBufferSource.stop();\n      this.resonanceBufferSource.stop();\n\n      this.webAudioBufferSource.disconnect();\n      this.binauralBufferSource.disconnect();\n      this.resonanceBufferSource.disconnect();\n    } catch (ex) {\n      console.log(\"Audio could not be stopped:\", ex);\n    }\n  }\n\n  setLoop(loop: boolean): void {\n    this.webAudioBufferSource.loop = loop;\n    this.binauralBufferSource.loop = loop;\n    this.resonanceBufferSource.loop = loop;\n  }\n\n  setDistanceModel(distanceModel: DistanceModelType): void {\n    this.webAudioPannerNode.distanceModel = distanceModel;\n    this.binauralBufferSource.onended = this.onAudioEnded;\n    this.resonanceBufferSource.onended = this.onAudioEnded;\n  }\n}\n","/**\n * @author Niklas Korz\n * @author Leon Erath\n */\nimport { Object3D, Vector3, Quaternion } from \"three\";\nimport { ResonanceAudio } from \"resonance-audio\";\nimport BinauralScene from \"./binaural/BinauralScene\";\n\nexport default class Listener3D extends Object3D {\n  webAudioListener: AudioListener;\n  binauralScene: BinauralScene;\n  resonanceScene: ResonanceAudio;\n\n  constructor(\n    webAudioListener: AudioListener,\n    binauralScene: BinauralScene,\n    resonanceScene: ResonanceAudio\n  ) {\n    super();\n    this.webAudioListener = webAudioListener;\n    this.binauralScene = binauralScene;\n    this.resonanceScene = resonanceScene;\n  }\n\n  updateMatrixWorld(force: boolean): void {\n    super.updateMatrixWorld(force);\n\n    const position = new Vector3();\n    const quaternion = new Quaternion();\n    const scale = new Vector3();\n    this.matrixWorld.decompose(position, quaternion, scale);\n    const orientation = new Vector3(0, 0, 1).applyQuaternion(quaternion);\n\n    this.webAudioListener.setPosition(position.x, position.y, position.z);\n    this.webAudioListener.setOrientation(\n      -orientation.x,\n      orientation.y,\n      -orientation.z,\n      this.up.x,\n      this.up.y,\n      this.up.z\n    );\n\n    this.binauralScene.listenerPosition.copy(position);\n    this.binauralScene.listenerOrientation.copy(orientation);\n    this.binauralScene.update();\n\n    // Resonance Audio already works with matrices similar to three.js internally.\n    this.resonanceScene.setListenerFromMatrix(this.matrixWorld);\n  }\n}\n","/**\n * @author Niklas Korz\n */\nimport { HRTF } from \"binauralfir\";\nimport defaultAudioContext from \"../defaultAudioContext\";\n\n/**\n * Takes two arrays of floats and turns them into a stereo audio buffer.\n * @param firCoeffsLeft The data to be used for the left audio channel\n * @param firCoeffsRight The data to be used for the right audio channel\n */\nconst firCoefficientsToAudioBuffer = (\n  firCoeffsLeft: number[],\n  firCoeffsRight: number[]\n): AudioBuffer => {\n  const buffer = defaultAudioContext.createBuffer(\n    2, // Stereo\n    512, // Samples\n    defaultAudioContext.sampleRate // Sample rate - unfortunately, we _have_ to use the system's sample rate here as Chrome does not allow any other values\n  );\n  buffer.copyToChannel(new Float32Array(firCoeffsLeft), 0);\n  buffer.copyToChannel(new Float32Array(firCoeffsRight), 1);\n  return buffer;\n};\n\n/**\n * Asynchronously loads and returns a BinauralFIR compatible HRTF dataset\n */\nexport const loadHRTFDataset = async (): Promise<HRTF[]> => {\n  const resp = await fetch(\"data/ircam-hrtf.json\");\n  const dataset = await resp.json();\n\n  return dataset.map((hrtf: any) => ({\n    azimuth: hrtf.azimuth,\n    elevation: hrtf.elevation,\n    distance: hrtf.distance,\n    buffer: firCoefficientsToAudioBuffer(\n      hrtf.fir_coeffs_left,\n      hrtf.fir_coeffs_right\n    )\n  }));\n};\n","/**\n * @author Niklas Korz\n * @author Leon Erath\n */\nimport { ResonanceAudio, RoomMaterials, RoomDimensions } from \"resonance-audio\";\nimport { HRTF } from \"binauralfir\";\nimport BinauralScene from \"./binaural/BinauralScene\";\nimport Audio3D from \"./Audio3D\";\nimport AudioImplementation from \"./AudioImplementation\";\nimport Listener3D from \"./Listener3D\";\nimport { loadHRTFDataset } from \"./binaural/hrtf\";\n\ninterface Options {\n  materials?: RoomMaterials;\n  dimensions?: RoomDimensions;\n}\n\nexport default class AudioScene {\n  audioImplementation: AudioImplementation = AudioImplementation.WebAudio;\n\n  webAudioContext = new AudioContext();\n  binauralAudioContext = new AudioContext();\n  resonanceAudioContext = new AudioContext();\n\n  binauralScene = new BinauralScene(this.binauralAudioContext);\n  resonanceScene = new ResonanceAudio(this.resonanceAudioContext);\n\n  binauralHRTFDataset: HRTF[] | null = null;\n  isLoadingBinauralHRTFDataset = false;\n\n  listener3D = new Listener3D(\n    this.webAudioContext.listener,\n    this.binauralScene,\n    this.resonanceScene\n  );\n\n  constructor(options: Options) {\n    this.resonanceScene.setRoomProperties(\n      options.dimensions || ResonanceAudio.Utils.DEFAULT_ROOM_DIMENSIONS,\n      options.materials || ResonanceAudio.Utils.DEFAULT_ROOM_MATERIALS\n    );\n    this.resonanceScene.output.connect(this.resonanceAudioContext.destination);\n    this.suspend();\n  }\n\n  createAudio3D(): Audio3D {\n    const audio = new Audio3D(\n      this.webAudioContext,\n      this.binauralAudioContext,\n      this.resonanceAudioContext,\n      this.webAudioContext.createPanner(),\n      this.binauralScene.createSource(),\n      this.resonanceScene.createSource()\n    );\n\n    return audio;\n  }\n\n  close(): void {\n    this.webAudioContext.close();\n    this.binauralAudioContext.close();\n    this.resonanceAudioContext.close();\n  }\n\n  suspend(): void {\n    this.webAudioContext.suspend();\n    this.binauralAudioContext.suspend();\n    this.resonanceAudioContext.suspend();\n  }\n\n  resume(): void {\n    switch (this.audioImplementation) {\n      case AudioImplementation.WebAudio:\n        this.webAudioContext.resume();\n        break;\n      case AudioImplementation.Binaural:\n        this.binauralAudioContext.resume();\n        break;\n      case AudioImplementation.ResonanceAudio:\n        this.resonanceAudioContext.resume();\n        break;\n    }\n  }\n\n  selectAudioImplementation(audioImplementation: AudioImplementation): void {\n    if (\n      audioImplementation === AudioImplementation.Binaural &&\n      !this.binauralHRTFDataset &&\n      !this.isLoadingBinauralHRTFDataset\n    ) {\n      this.loadBinauralHRTFDataset();\n    }\n\n    this.suspend();\n    this.audioImplementation = audioImplementation;\n    this.resume();\n  }\n\n  async loadBinauralHRTFDataset(): Promise<void> {\n    this.isLoadingBinauralHRTFDataset = true;\n    try {\n      this.binauralHRTFDataset = await loadHRTFDataset();\n      this.binauralScene.setHRTFDataset(this.binauralHRTFDataset);\n    } catch (ex) {\n      console.error(\"Failed loading BinauralFIR HRTF dataset:\", ex);\n    }\n    this.isLoadingBinauralHRTFDataset = false;\n  }\n\n  setRoomProperties(\n    roomDimensions: RoomDimensions,\n    roomMaterials: RoomMaterials\n  ): void {\n    this.resonanceScene.setRoomProperties(roomDimensions, roomMaterials);\n  }\n}\n","/**\n * @author Niklas Korz\n */\nimport { BoxGeometry, Mesh, MeshLambertMaterial } from \"three\";\nimport Serializable, { SerializedData } from \"../data/Serializable\";\nimport { SpawnData } from \"../data/schema\";\n\nconst spawnGeometry = new BoxGeometry(1, 0.1, 1);\nconst spawnMaterial = new MeshLambertMaterial({\n  color: 0x00ff00\n});\n\nconst directionGeometry = new BoxGeometry(0.1, 0.1, 0.5);\n\nexport default class SpawnMarker extends Mesh implements Serializable {\n  constructor() {\n    super(spawnGeometry, spawnMaterial);\n    this.position.set(0, 0.05, 2);\n\n    const directionMarker = new Mesh(directionGeometry, spawnMaterial);\n    directionMarker.position.z = -0.5;\n    this.add(directionMarker);\n  }\n\n  toData(): SpawnData {\n    return {\n      uuid: this.uuid,\n      name: this.name,\n      position: [this.position.x, this.position.z],\n      rotation: this.rotation.y\n    };\n  }\n\n  fromData(data: SerializedData): this {\n    this.uuid = data.uuid;\n    this.name = data.name;\n    this.position.set(data.position[0], 0.05, data.position[1]);\n    this.rotation.set(0, data.rotation, 0);\n\n    return this;\n  }\n}\n","/**\n * @author Niklas Korz\n * @author Daniel Salomon\n */\nimport { RoomDimensions, ResonanceAudio, RoomMaterials } from \"resonance-audio\";\nimport {\n  AmbientLight,\n  BoxGeometry,\n  GridHelper,\n  Mesh,\n  MeshLambertMaterial,\n  Object3D,\n  PerspectiveCamera,\n  PointLight,\n  Scene,\n  Vector3\n} from \"three\";\nimport Serializable, { SerializedData } from \"../data/Serializable\";\nimport { RoomData } from \"../data/schema\";\nimport AudioScene from \"../audio/AudioScene\";\nimport Audio3D from \"../audio/Audio3D\";\nimport AudioLibrary from \"./AudioLibrary\";\nimport GameObject from \"./GameObject\";\nimport SpawnMarker from \"./SpawnMarker\";\nimport Project from \"./Project\";\n\nconst wallGeometry = new BoxGeometry(1, 1, 1);\nconst wallMaterial = new MeshLambertMaterial();\n\n// A \"room\" is analog to levels of a game.\n// The user will only hear sounds that are part of the current room.\n// Also, this abstraction is necessary to support Resonance Audio as one of many\n// spatial audio implementations.\nexport default class Room extends Scene implements Serializable {\n  audioLibrary: AudioLibrary;\n  roomDimensions: RoomDimensions;\n  roomMaterials: RoomMaterials;\n  project: Project;\n  grid: GridHelper;\n  wallNorth = new Mesh(wallGeometry, wallMaterial);\n  wallEast = new Mesh(wallGeometry, wallMaterial);\n  wallSouth = new Mesh(wallGeometry, wallMaterial);\n  wallWest = new Mesh(wallGeometry, wallMaterial);\n  camera = new PerspectiveCamera(60, 1, 0.1, 1000);\n\n  collisionAudio: Audio3D; // Audio3D Objects for playing collision/footstep/interaction sounds, needed per room.\n  footstepAudio: Audio3D;\n  interactAvailAudio: Audio3D;\n\n  roomState = new Map<string, any>(); // Needed by runtime\n\n  audioScene: AudioScene;\n  spawns: SpawnMarker[] = [];\n\n  get dimensions(): RoomDimensions {\n    return this.roomDimensions;\n  }\n\n  set dimensions(dimensions: RoomDimensions) {\n    this.roomDimensions = dimensions;\n\n    this.audioScene.setRoomProperties(dimensions, this.roomMaterials);\n\n    this.remove(this.grid);\n\n    const gridSize = Math.max(dimensions.width, dimensions.depth);\n    this.grid = new GridHelper(gridSize, gridSize, 0xffffff, 0xffffff);\n\n    this.add(this.grid);\n\n    this.updateWalls();\n  }\n\n  get materials(): RoomMaterials {\n    return this.roomMaterials;\n  }\n\n  set materials(materials: RoomMaterials) {\n    this.roomMaterials = materials;\n    this.audioScene.setRoomProperties(this.roomDimensions, materials);\n  }\n\n  constructor(\n    project: Project,\n    audioLibrary: AudioLibrary,\n    name: string = \"\",\n    dimensions: RoomDimensions = { width: 15, depth: 15, height: 3 },\n    materials: RoomMaterials = ResonanceAudio.Utils.DEFAULT_ROOM_MATERIALS\n  ) {\n    super();\n\n    this.audioLibrary = audioLibrary;\n    this.name = name;\n    this.roomDimensions = dimensions;\n    this.roomMaterials = materials;\n    this.project = project;\n    const ambientLight = new AmbientLight(0xffffff, 0.5);\n    this.add(ambientLight);\n    const light = new PointLight(0xffffff, 0.5);\n    light.position.set(5, 5, 0);\n    light.lookAt(0, 0, 0);\n    this.add(light);\n\n    const gridSize = Math.max(dimensions.width, dimensions.depth);\n    this.grid = new GridHelper(gridSize, gridSize, 0xffffff, 0xffffff);\n    this.add(this.grid);\n\n    this.updateWalls();\n    this.add(this.wallNorth);\n    this.add(this.wallEast);\n    this.add(this.wallSouth);\n    this.add(this.wallWest);\n\n    this.camera.position.z = 4;\n    this.camera.position.y = 3;\n    this.camera.lookAt(new Vector3(0, 1, 0));\n\n    // Audio setup\n    this.audioScene = new AudioScene({\n      dimensions: dimensions,\n      materials: materials\n    });\n\n    this.camera.add(this.audioScene.listener3D);\n\n    //Init audio objects for collision/footstep/... sounds\n    this.collisionAudio = this.audioScene.createAudio3D();\n    this.footstepAudio = this.audioScene.createAudio3D();\n    this.interactAvailAudio = this.audioScene.createAudio3D();\n\n    //Add audio objects for collision/footstep/... sounds to their parents\n    this.camera.add(this.footstepAudio);\n    //this.footstepAudio.position.setY(-1.3); //Causes strange problems at some implementations (Footsteps only right or left)\n    this.add(this.collisionAudio);\n    this.add(this.interactAvailAudio);\n  }\n\n  addSpawn(): SpawnMarker {\n    const marker = new SpawnMarker();\n    marker.name = \"New spawn\";\n    this.spawns.push(marker);\n    this.add(marker);\n    return marker;\n  }\n\n  addObject(): GameObject {\n    const object = new GameObject(this.audioLibrary, this.audioScene);\n    object.position.y += 0.5;\n    object.name = \"New object\";\n\n    // Options\n    object.audio.webAudioPannerNode.panningModel = this.project.panningModel;\n    object.audio.webAudioPannerNode.distanceModel = this.project.distanceModel;\n    object.audio.resonanceSource.setRolloff(this.project.rollofModel);\n\n    this.add(object);\n    return object;\n  }\n\n  updateWalls(): void {\n    const { width, depth, height } = this.roomDimensions;\n\n    this.wallNorth.scale.set(width, height, 0.25);\n    this.wallEast.scale.set(0.25, height, depth);\n    this.wallSouth.scale.set(width, height, 0.25);\n    this.wallWest.scale.set(0.25, height, depth);\n\n    this.wallNorth.position.set(0, height / 2, depth / 2);\n    this.wallEast.position.set(width / 2, height / 2, 0);\n    this.wallSouth.position.set(0, height / 2, -depth / 2);\n    this.wallWest.position.set(-width / 2, height / 2, 0);\n  }\n\n  toData(): RoomData {\n    return {\n      uuid: this.uuid,\n      name: this.name,\n      dimensions: this.dimensions,\n      materials: this.materials,\n      spawns: this.spawns.map(s => s.toData()),\n      objects: this.children\n        .filter((c: Object3D): c is GameObject => c instanceof GameObject)\n        .map(go => go.toData())\n    };\n  }\n\n  fromData(data: SerializedData): this {\n    this.uuid = data.uuid != null ? data.uuid : this.uuid;\n    this.name = data.name;\n    this.dimensions = data.dimensions;\n    if (data.materials) {\n      this.materials = data.materials;\n    }\n\n    if (data.spawns) {\n      this.spawns = data.spawns.map((s: SerializedData) =>\n        new SpawnMarker().fromData(s)\n      );\n      this.add(...this.spawns);\n    } else {\n      this.addSpawn();\n    }\n\n    const gameObjects = data.objects.map((o: SerializedData) =>\n      new GameObject(this.audioLibrary, this.audioScene).fromData(o)\n    );\n    this.add(...gameObjects);\n\n    return this;\n  }\n}\n","/**\n * @author Niklas Korz\n * @author Leon Erath\n * @author Daniel Salomon\n */\nimport {\n  BackSide,\n  Mesh,\n  MeshBasicMaterial,\n  PerspectiveCamera,\n  Vector3\n} from \"three\";\nimport { ResonanceAudio } from \"resonance-audio\";\nimport Serializable, { SerializedData } from \"../data/Serializable\";\nimport { ProjectData, AudioFile } from \"../data/schema\";\nimport { saveProject } from \"../data/db\";\nimport AudioImplementation from \"../audio/AudioImplementation\";\nimport defaultAudioContext from \"../audio/defaultAudioContext\";\nimport AudioLibrary from \"./AudioLibrary\";\nimport GameObject from \"./GameObject\";\nimport Room from \"./Room\";\nimport SpawnMarker from \"./SpawnMarker\";\n\nexport interface ProjectEvents {\n  onSelectSpawn(spawnMarker: SpawnMarker | null): void;\n  onSelectObject(object: GameObject | null): void;\n  onTranslate(position: Vector3): void;\n  onScale(scale: Vector3): void;\n}\n\nconst noop = (): void => {\n  /* no operation */\n};\n\nconst defaultEvents: ProjectEvents = {\n  onSelectSpawn: noop,\n  onSelectObject: noop,\n  onScale: noop,\n  onTranslate: noop\n};\n\nexport default class Project implements Serializable {\n  events: ProjectEvents;\n  audioLibrary = new AudioLibrary();\n\n  id?: number;\n  name = \"New project\";\n  rooms: Room[] = [];\n\n  panningModel: PanningModelType = \"equalpower\";\n  distanceModel: DistanceModelType = \"inverse\";\n  ambisonicOrder = ResonanceAudio.Utils.DEFAULT_AMBISONIC_ORDER;\n  rollofModel = ResonanceAudio.Utils.DEFAULT_ATTENUATION_ROLLOFF;\n\n  playerHeight = 1.8; // 1.80m player height, eyes are ~10cm lower\n  playerState = new Map<string, any>(); // Needed by runtime\n\n  collisionAudioId?: number; // Audio IDs, Files and buffer for collision/footstep/interaction sounds\n  footstepAudioId?: number;\n  interactAvailAudioId?: number;\n  collisionAudioFile?: AudioFile;\n  footstepAudioFile?: AudioFile;\n  interactAvailAudioFile?: AudioFile;\n  collisionAudioBuffer?: AudioBuffer;\n  footstepAudioBuffer?: AudioBuffer;\n  interactAvailAudioBuffer?: AudioBuffer;\n\n  activeAudioImplementation = AudioImplementation.WebAudio;\n  activeRoom: Room;\n  activeSpawn: SpawnMarker | null = null;\n  activeObject: GameObject | null = null;\n\n  outlineMesh = new Mesh();\n\n  get camera(): PerspectiveCamera {\n    return this.activeRoom.camera;\n  }\n\n  constructor(events: ProjectEvents = defaultEvents) {\n    this.events = events;\n\n    const firstRoom = new Room(this, this.audioLibrary, \"First room\");\n    firstRoom.addSpawn();\n    firstRoom.addObject();\n    this.rooms.push(firstRoom);\n    this.activeRoom = firstRoom;\n\n    this.outlineMesh.material = new MeshBasicMaterial({\n      color: 0xffffff,\n      side: BackSide\n    });\n    this.outlineMesh.scale.multiplyScalar(1.05);\n  }\n\n  close(): void {\n    for (const room of this.rooms) {\n      room.audioScene.close();\n    }\n  }\n\n  suspend(): void {\n    this.activeRoom.audioScene.suspend();\n  }\n\n  resume(): void {\n    this.activeRoom.audioScene.resume();\n  }\n\n  addRoom(): Room {\n    const room = new Room(this, this.audioLibrary, \"New room\");\n    room.addSpawn();\n    room.addObject();\n\n    // Options\n    room.audioScene.resonanceScene.setAmbisonicOrder(this.ambisonicOrder);\n\n    if (this.collisionAudioBuffer)\n      room.collisionAudio.setBuffer(this.collisionAudioBuffer);\n    if (this.footstepAudioBuffer)\n      room.footstepAudio.setBuffer(this.footstepAudioBuffer);\n    if (this.interactAvailAudioBuffer)\n      room.interactAvailAudio.setBuffer(this.interactAvailAudioBuffer);\n\n    this.rooms.push(room);\n    this.selectRoom(room);\n    return room;\n  }\n\n  selectPanningModel(model: PanningModelType): void {\n    for (const room of this.rooms) {\n      for (const obj of room.children) {\n        if (obj instanceof GameObject) {\n          obj.audio.webAudioPannerNode.panningModel = model;\n        }\n      }\n    }\n    this.panningModel = model;\n  }\n\n  selectDistanceModel(distanceModel: DistanceModelType): void {\n    for (const room of this.rooms) {\n      for (const obj of room.children) {\n        if (obj instanceof GameObject) {\n          obj.audio.webAudioPannerNode.distanceModel = distanceModel;\n        }\n      }\n    }\n    this.distanceModel = distanceModel;\n  }\n\n  selectAmbisonicOrder(order: number): void {\n    for (const room of this.rooms) {\n      room.audioScene.resonanceScene.setAmbisonicOrder(order);\n    }\n    this.ambisonicOrder = order;\n  }\n\n  selectRollofModel(model: string): void {\n    for (const room of this.rooms) {\n      for (const obj of room.children) {\n        if (obj instanceof GameObject) {\n          obj.audio.resonanceSource.setRolloff(model);\n        }\n      }\n    }\n    this.rollofModel = model;\n  }\n\n  selectAudioImplementation(audioImplementation: AudioImplementation): void {\n    this.activeAudioImplementation = audioImplementation;\n    this.activeRoom.audioScene.selectAudioImplementation(audioImplementation);\n  }\n\n  selectRoom(room: Room): void {\n    this.activeRoom.audioScene.suspend();\n    room.audioScene.selectAudioImplementation(this.activeAudioImplementation);\n    room.camera.aspect = this.activeRoom.camera.aspect;\n    room.camera.updateProjectionMatrix();\n    this.activeRoom = room;\n    this.unselect();\n  }\n\n  unselect(): void {\n    if (this.activeSpawn) {\n      this.activeSpawn.remove(this.outlineMesh);\n      this.activeSpawn = null;\n      this.events.onSelectSpawn(null);\n    }\n    if (this.activeObject) {\n      this.activeObject.remove(this.outlineMesh);\n      this.activeObject = null;\n      this.events.onSelectObject(null);\n    }\n  }\n\n  selectSpawn(s: SpawnMarker): void {\n    this.unselect();\n\n    this.outlineMesh.geometry = s.geometry;\n    s.add(this.outlineMesh);\n\n    this.activeSpawn = s;\n    this.events.onSelectSpawn(s);\n  }\n\n  selectObject(o: GameObject): void {\n    this.unselect();\n\n    this.outlineMesh.geometry = o.geometry;\n    o.add(this.outlineMesh);\n\n    this.activeObject = o;\n    this.events.onSelectObject(o);\n  }\n\n  teleportPlayer(roomId: string, spawnId?: string): void {\n    const room = this.rooms.find(r => r.uuid === roomId);\n    if (room) {\n      this.selectRoom(room);\n      const spawn =\n        (spawnId && room.spawns.find(s => s.uuid === spawnId)) ||\n        room.spawns[0];\n      room.camera.position.set(\n        spawn.position.x,\n        this.playerHeight - 0.1,\n        spawn.position.z\n      );\n      room.camera.rotation.set(0, spawn.rotation.y, 0);\n    } else {\n      console.log(\"Target room not found, not teleporting\");\n    }\n  }\n\n  async setCollisionAudio(id: number): Promise<void> {\n    this.collisionAudioId = id;\n    this.collisionAudioFile = await this.audioLibrary.get(id);\n    if (this.collisionAudioFile) {\n      this.collisionAudioBuffer = await defaultAudioContext.decodeAudioData(\n        this.collisionAudioFile.data.slice(0)\n      );\n      for (const room of this.rooms) {\n        room.collisionAudio.setBuffer(this.collisionAudioBuffer);\n        room.collisionAudio.setLoop(false);\n      }\n    } else {\n      console.log(\n        \"Audio with id\",\n        id,\n        \"could not be found and can't be played\"\n      );\n    }\n  }\n\n  async setFootstepAudio(id: number): Promise<void> {\n    this.footstepAudioId = id;\n    this.footstepAudioFile = await this.audioLibrary.get(id);\n    if (this.footstepAudioFile) {\n      this.footstepAudioBuffer = await defaultAudioContext.decodeAudioData(\n        this.footstepAudioFile.data.slice(0)\n      );\n      for (const room of this.rooms) {\n        room.footstepAudio.setBuffer(this.footstepAudioBuffer);\n        room.footstepAudio.setLoop(false);\n      }\n    } else {\n      console.log(\n        \"Audio with id\",\n        id,\n        \"could not be found and can't be played\"\n      );\n    }\n  }\n\n  async setInteractAvailAudio(id: number): Promise<void> {\n    this.interactAvailAudioId = id;\n    this.interactAvailAudioFile = await this.audioLibrary.get(id);\n    if (this.interactAvailAudioFile) {\n      this.interactAvailAudioBuffer = await defaultAudioContext.decodeAudioData(\n        this.interactAvailAudioFile.data.slice(0)\n      );\n      for (const room of this.rooms) {\n        room.interactAvailAudio.setBuffer(this.interactAvailAudioBuffer);\n        room.interactAvailAudio.setLoop(false);\n      }\n    } else {\n      console.log(\n        \"Audio with id\",\n        id,\n        \"could not be found and can't be played\"\n      );\n    }\n  }\n\n  async save(): Promise<void> {\n    const id = await saveProject(this);\n    if (this.id == null) {\n      this.id = id;\n      await this.audioLibrary.saveToProject(id);\n    }\n  }\n\n  // Serialize instance to a plain JavaScript object\n  toData(): ProjectData {\n    return {\n      savedAt: new Date(),\n      name: this.name,\n      rooms: this.rooms.map(r => r.toData()),\n      nextAudioId: this.audioLibrary.nextId,\n\n      audioImplementation: this.activeAudioImplementation,\n\n      panningModel: this.panningModel,\n      distanceModel: this.distanceModel,\n      ambisonicOrder: this.ambisonicOrder,\n      rollofModel: this.rollofModel,\n\n      collisionAudioId: this.collisionAudioId,\n      footstepAudioId: this.footstepAudioId,\n      interactAvailAudioId: this.interactAvailAudioId\n    };\n  }\n\n  // Load data from a plain JavaScript object into this instance\n  fromData(\n    data: SerializedData,\n    projectId?: number,\n    audioLibrary?: AudioLibrary\n  ): this {\n    this.id = projectId;\n    if (audioLibrary) {\n      this.audioLibrary = audioLibrary;\n    } else {\n      this.audioLibrary.projectId = projectId;\n      this.audioLibrary.nextId = data.nextAudioId || 0;\n    }\n\n    this.name = data.name;\n    this.rooms = data.rooms.map((r: SerializedData) =>\n      new Room(this, this.audioLibrary).fromData(r)\n    );\n    this.activeRoom = this.rooms[0];\n\n    // Disable audio in all inactive rooms\n    for (let i = 1; i < this.rooms.length; i++) {\n      this.rooms[i].audioScene.suspend();\n    }\n\n    if (data.audioImplementation) {\n      this.selectAudioImplementation(data.audioImplementation);\n    }\n\n    // Project options\n    if (data.panningModel) {\n      this.selectPanningModel(data.panningModel);\n    }\n    if (data.distanceModel) {\n      this.selectDistanceModel(data.distanceModel);\n    }\n    if (data.ambisonicOrder) {\n      this.selectAmbisonicOrder(data.ambisonicOrder);\n    }\n    if (data.rollofModel) {\n      this.selectRollofModel(data.rollofModel);\n    }\n\n    // Set sounds for collision, footstep and interaction available\n    if (data.collisionAudioId != null) {\n      this.setCollisionAudio(data.collisionAudioId);\n    }\n    if (data.footstepAudioId != null) {\n      this.setFootstepAudio(data.footstepAudioId);\n    }\n    if (data.interactAvailAudioId != null) {\n      this.setInteractAvailAudio(data.interactAvailAudioId);\n    }\n\n    return this;\n  }\n}\n","/**\n * @author Niklas Korz\n */\n\n// Options for configuring the file modal\nexport interface OpenFileDialogOptions {\n  accept?: string;\n}\n\n/**\n * Opens a file dialog and lets the user select a file\n * @returns The selected file\n */\nexport const openFileDialog = (\n  options: OpenFileDialogOptions = {}\n): Promise<File> =>\n  new Promise(resolve => {\n    const input = document.createElement(\"input\");\n    input.type = \"file\";\n    if (options.accept) {\n      input.accept = options.accept;\n    }\n    input.onchange = () => {\n      if (input.files) {\n        resolve(input.files[0]);\n      }\n    };\n    input.click();\n  });\n\nexport const readFileAsArrayBuffer = (file: File): Promise<ArrayBuffer> =>\n  new Promise(resolve => {\n    const reader = new FileReader();\n    reader.onload = () => {\n      if (reader.result) {\n        resolve(reader.result as ArrayBuffer);\n      }\n    };\n    reader.onerror = () => {\n      console.error(\"Error:\", reader.error);\n    };\n    reader.readAsArrayBuffer(file);\n  });\n","/**\n * @author Niklas Korz\n * This module defines functions for loading and importing projects from the local filesystem.\n */\nimport Zip from \"jszip\";\nimport Project from \"../project/Project\";\nimport { openFileDialog } from \"../utils/files\";\n\n/**\n * Decompresses the given zip file, loads the included JSON metadata and reads all\n * included audio files as binary array buffers.\n * @param blob The blob to read from, usually a file returned by a FileReader instance.\n * @returns The project recreated from the data found in the zip\n */\nexport const loadZip = async (blob: Blob): Promise<Project> => {\n  const zip = await Zip.loadAsync(blob);\n  const metadata = JSON.parse(await zip.file(\"metadata.json\").async(\"text\"));\n\n  const audioLibrary = JSON.parse(\n    await zip.file(\"audioLibrary.json\").async(\"text\")\n  );\n  const audioFolder = zip.folder(\"audio\");\n  const project = new Project();\n  for (const { id, name, type } of audioLibrary) {\n    const data = await audioFolder.file(id.toString()).async(\"arraybuffer\");\n    project.audioLibrary.set(id, { name, type, data });\n\n    if (id >= project.audioLibrary.nextId) {\n      project.audioLibrary.nextId = id + 1;\n    }\n  }\n\n  project.fromData(metadata);\n  return project;\n};\n\n/**\n * Opens a file dialog and lets the user select a zip file that will be parsed\n * and loaded as a project.\n * @returns The project found in the zip\n */\nexport const openZip = async (): Promise<Project> => {\n  const file = await openFileDialog({ accept: \"application/zip\" });\n  return await loadZip(file);\n};\n","/**\n * @author Niklas Korz\n */\n\nconst AXIS_THRESHOLD = 0.15; //Inaccuracy of gamepads (tested XBOX One S gamepad up to 0.11 - Daniel)\n\nexport default class GamepadListener {\n  listen(): void {\n    window.addEventListener(\"gamepadconnected\", this.onGamepadConnected);\n    window.addEventListener(\"gamepaddisconnected\", this.onGamepadDisconnected);\n  }\n\n  stop(): void {\n    window.removeEventListener(\"gamepadconnected\", this.onGamepadConnected);\n    window.removeEventListener(\n      \"gamepaddisconnected\",\n      this.onGamepadDisconnected\n    );\n  }\n\n  onGamepadConnected = (e: GamepadEvent) => {\n    console.log(\"Gamepad connected:\", e.gamepad);\n  };\n\n  onGamepadDisconnected = (e: GamepadEvent) => {\n    console.log(\"Gamepad disconnected:\", e.gamepad);\n  };\n\n  getAxis(index: number): number {\n    const gamepads = navigator.getGamepads();\n\n    let value = 0;\n    for (const gamepad of gamepads) {\n      if (!gamepad || gamepad.mapping !== \"standard\") {\n        continue;\n      }\n\n      if (index < 4) {\n        const axis = gamepad.axes[index];\n        if (\n          Math.abs(axis) >= AXIS_THRESHOLD &&\n          Math.abs(axis) > Math.abs(value)\n        ) {\n          value = axis;\n        }\n      } else if (index === 4) {\n        const v1 = gamepad.buttons[6].value;\n        const v2 = gamepad.buttons[7].value;\n        const axis = v2 - v1;\n        if (Math.abs(axis) > Math.abs(value)) {\n          value = axis;\n        }\n      }\n    }\n    return value;\n  }\n\n  getButtonStatus(index: number): boolean {\n    const gamepads = navigator.getGamepads();\n\n    for (const gamepad of gamepads) {\n      if (!gamepad || gamepad.mapping !== \"standard\") {\n        continue;\n      }\n\n      if (gamepad.buttons[index].pressed) {\n        return true;\n      }\n    }\n    return false;\n  }\n}\n","/**\n * @author Niklas Korz\n */\n\n// Make sure character keys are lowercased, as KeyboardEvent.key might report an uppercase\n// character if the Shift-key is pressed.\nconst normalizeKey = (key: string): string =>\n  key.length > 1 ? key : key.toLocaleLowerCase();\n\nexport default class KeyboardListener {\n  target: HTMLElement;\n  keysPressed = new Set<string>();\n  lastKeyUp = new Map<string, number>();\n\n  constructor(target: HTMLElement) {\n    this.target = target;\n  }\n\n  listen(): void {\n    this.target.addEventListener(\"blur\", this.reset);\n    this.target.addEventListener(\"contextmenu\", this.reset);\n    this.target.addEventListener(\"keydown\", this.onKeyDown);\n    this.target.addEventListener(\"keyup\", this.onKeyUp);\n    document.addEventListener(\"click\", this.onClick);\n  }\n\n  stop(): void {\n    this.target.removeEventListener(\"blur\", this.reset);\n    this.target.removeEventListener(\"contextmenu\", this.reset);\n    this.target.removeEventListener(\"keydown\", this.onKeyDown);\n    this.target.removeEventListener(\"keyup\", this.onKeyUp);\n    document.removeEventListener(\"click\", this.onClick);\n    this.reset();\n  }\n\n  isPressed(key: string): boolean {\n    return this.keysPressed.has(key);\n  }\n\n  reset = (): void => {\n    this.keysPressed.clear();\n  };\n\n  onKeyDown = (e: KeyboardEvent): void => {\n    e.preventDefault();\n    const key = normalizeKey(e.key);\n    // Workaround for browsers firing a queued keydown shortly after a keyup\n    // Ignore keydown if the last keyup was triggered +-100ms from now\n    if (Math.abs(e.timeStamp - (this.lastKeyUp.get(key) || 0)) >= 100) {\n      this.keysPressed.add(key);\n    }\n  };\n\n  onKeyUp = (e: KeyboardEvent): void => {\n    e.preventDefault();\n    const key = normalizeKey(e.key);\n    this.keysPressed.delete(key);\n    this.lastKeyUp.set(key, e.timeStamp);\n  };\n\n  onClick = (e: MouseEvent): void => {\n    // Shift + right click forces context menu in firefox\n    if (e.button === 2 && e.shiftKey) {\n      this.reset();\n    }\n  };\n}\n","/**\n * @author Daniel Salomon\n */\nimport { Raycaster, Vector3, WebGLRenderer, Object3D, Mesh, Box3 } from \"three\";\nimport GamepadListener from \"../input/GamepadListener\";\nimport KeyboardListener from \"../input/KeyboardListener\";\nimport Project from \"../project/Project\";\nimport GameObject, { InteractionType } from \"../project/GameObject\";\nimport SpawnMarker from \"../project/SpawnMarker\";\n\nconst axes = {\n  x: new Vector3(1, 0, 0),\n  y: new Vector3(0, 1, 0),\n  z: new Vector3(0, 0, 1)\n};\n\nexport default class Runtime {\n  target: HTMLElement | null = null;\n  project: Project;\n\n  rafHandle = 0;\n  previousTimestamp = 0;\n  lastCollisionSound = 0; //Timestamp, when the last sound for collision was played\n  lastKnownButtonStatus = false; //Variable to check whether or not the button[0] was pressed in the last update() or not (to prevent multiple clicks)\n\n  shouldRender = true; //Should the visuals be rendered or should it be audio-only?\n\n  renderer = new WebGLRenderer();\n  canvas: HTMLCanvasElement;\n\n  raycaster = new Raycaster();\n\n  dummyCamera = new Object3D();\n\n  keys = new KeyboardListener(this.renderer.domElement);\n  gamepads = new GamepadListener();\n\n  constructor(project: Project) {\n    this.project = project;\n    this.canvas = this.renderer.domElement;\n    this.canvas.tabIndex = -1; // Make element focusable\n\n    const room = this.project.rooms[0];\n    this.project.selectRoom(room);\n    const spawn = room.spawns[0];\n    this.project.camera.position.set(\n      spawn.position.x,\n      this.project.playerHeight - 0.1,\n      spawn.position.z\n    );\n    this.project.camera.rotation.set(0, spawn.rotation.y, 0);\n  }\n\n  attach(target: HTMLElement): void {\n    this.keys.listen();\n    this.gamepads.listen();\n\n    this.target = target;\n    target.appendChild(this.canvas);\n\n    this.resize();\n    window.requestAnimationFrame(this.animate);\n    window.addEventListener(\"resize\", this.resize);\n  }\n\n  detach(): void {\n    window.cancelAnimationFrame(this.rafHandle);\n    window.removeEventListener(\"resize\", this.resize);\n\n    if (this.target) {\n      this.target.removeChild(this.canvas);\n      this.target = null;\n    }\n\n    this.keys.stop();\n    this.gamepads.stop();\n  }\n\n  focus(): void {\n    this.canvas.focus();\n  }\n\n  resize = (): void => {\n    if (!this.target) {\n      return;\n    }\n\n    const { offsetWidth, offsetHeight } = this.target;\n\n    this.project.camera.aspect = offsetWidth / offsetHeight;\n    this.project.camera.updateProjectionMatrix();\n\n    this.renderer.setPixelRatio(window.devicePixelRatio);\n    this.renderer.setSize(offsetWidth, offsetHeight);\n  };\n\n  animate: FrameRequestCallback = t => {\n    this.rafHandle = window.requestAnimationFrame(this.animate);\n\n    const dt = (t - this.previousTimestamp) / 1000;\n    this.previousTimestamp = t;\n    this.update(dt);\n\n    if (this.shouldRender) {\n      this.renderer.render(this.project.activeRoom, this.project.camera);\n    } else {\n      // When we are not actively rendering, position updates are not passed down\n      // to children in the scene graph automatically.\n      // To enforce this update, we have to update the scene graphs root manually\n      // (i.e., the scene itself), which will in turn update all nodes contained in the\n      // scene graph.\n      // As the camera is not a part of the scene graph, it has to be updated\n      // manually as well.\n      this.project.activeRoom.updateMatrixWorld();\n      this.project.activeRoom.camera.updateMatrixWorld(false);\n    }\n  };\n\n  toggleRendering(): void {\n    this.shouldRender = this.shouldRender ? false : true;\n    this.renderer.clear();\n  }\n\n  // Helper method to check if a number (check) is between or equal to two boundaries (from, to). E.g.: isBetween(2, 1, 5)==true, isBetween(6, 1, 5)==false\n  isBetween(check: number, from: number, to: number): boolean {\n    const min = Math.min.apply(Math, [from, to]),\n      max = Math.max.apply(Math, [from, to]);\n    return check >= min && check <= max;\n  }\n\n  invokeInteraction(): boolean {\n    const toInteractWith = this.project.activeObject;\n    if (toInteractWith != null) {\n      toInteractWith.triggerInteraction(this.project);\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  update(dt: number): void {\n    const { camera } = this.project;\n    this.dummyCamera.position.copy(camera.position); //Copy values of the real camera object to the dummy camera, to be used later on for collision detection\n    this.dummyCamera.rotation.copy(camera.rotation);\n\n    let moveX = 0;\n    let moveZ = 0;\n    let rotateY = 0;\n\n    //Sidenote on movement: We really wanted to implement the possibility to look up and down, but it turned out to be way too complex for us to implement in this project.\n    //All tries resulted in either a buggy camera or a buggy movement through the environment, which we were not fine with.\n\n    //Keyboard actions (W/A/S/D to move, Left&Right arrows to rotate)\n    if (this.keys.isPressed(\"w\")) {\n      const newZ = -2 * dt;\n      moveZ = Math.abs(moveZ) < Math.abs(newZ) ? newZ : moveZ;\n    }\n    if (this.keys.isPressed(\"s\")) {\n      const newZ = 2 * dt;\n      moveZ = Math.abs(moveZ) < Math.abs(newZ) ? newZ : moveZ;\n    }\n    if (this.keys.isPressed(\"a\")) {\n      const newX = -2 * dt;\n      moveX = Math.abs(moveX) < Math.abs(newX) ? newX : moveX;\n    }\n    if (this.keys.isPressed(\"d\")) {\n      const newX = 2 * dt;\n      moveX = Math.abs(moveX) < Math.abs(newX) ? newX : moveX;\n    }\n\n    if (this.keys.isPressed(\"ArrowLeft\")) {\n      const newY = dt;\n      rotateY = Math.abs(rotateY) < Math.abs(newY) ? newY : rotateY;\n    }\n    if (this.keys.isPressed(\"ArrowRight\")) {\n      const newY = -dt;\n      rotateY = Math.abs(rotateY) < Math.abs(newY) ? newY : rotateY;\n    }\n\n    //Collect necessary information from the gamepad API, supports analog sticks (slower and faster movement)\n    const gamepadAxes = {\n      x: this.gamepads.getAxis(0),\n      y: this.gamepads.getAxis(1),\n      rX: this.gamepads.getAxis(2)\n    };\n    if (gamepadAxes.x) {\n      const newX = 2 * dt * gamepadAxes.x;\n      moveX = Math.abs(moveX) < Math.abs(newX) ? newX : moveX;\n    }\n    if (gamepadAxes.y) {\n      const newZ = 2 * dt * gamepadAxes.y;\n      moveZ = Math.abs(moveZ) < Math.abs(newZ) ? newZ : moveZ;\n    }\n    if (gamepadAxes.rX) {\n      const newY = -dt * gamepadAxes.rX;\n      rotateY = Math.abs(rotateY) < Math.abs(newY) ? newY : rotateY;\n    }\n\n    // Executing the rotation/movement after all keys are evaluated prevents the issue of double movement speed when both, keyboard and gamepad, is used at the same time.\n    camera.rotateOnWorldAxis(axes.y, rotateY); // Rotate left & right\n    //Apply movement to dummy object first to check if a collision is happening. If not, apply to actual camera.\n    this.dummyCamera.translateOnAxis(axes.z, moveZ); // Move forwards & backwards\n    this.dummyCamera.translateOnAxis(axes.x, moveX); // Move left & right\n\n    //Values to check for collision\n    const newX = this.dummyCamera.position.x;\n    const newZ = this.dummyCamera.position.z;\n\n    //Check for collision\n    let collided = false;\n    for (const i of this.project.activeRoom.children) {\n      if (!(i instanceof Mesh) || i instanceof SpawnMarker) {\n        continue;\n      }\n      const thresholdMovement = 0.25; //Minimum allowed distance to an object\n      const thresholdHeight = 0.05; //Minimum allowed distance to an object below or above the player (player height is 1,80[m])\n\n      var bbox = new Box3().setFromObject(i); //Bounding box to take rotation of the object into account.\n      const bboxposition = bbox.getCenter(new Vector3());\n      const bboxscale = bbox.getSize(new Vector3());\n\n      //Estimate boundaries of all (visible) objects in the current room\n      const boundX1 = bboxposition.x + bboxscale.x / 2 + thresholdMovement;\n      const boundX2 = bboxposition.x - bboxscale.x / 2 - thresholdMovement;\n      const boundY1 = bboxposition.y + bboxscale.y / 2 + thresholdHeight;\n      const boundY2 = bboxposition.y - bboxscale.y / 2 - thresholdHeight;\n      const boundZ1 = bboxposition.z + bboxscale.z / 2 + thresholdMovement;\n      const boundZ2 = bboxposition.z - bboxscale.z / 2 - thresholdMovement;\n\n      //Check if the next position of the camera collides with the bondaries or the object (and effectively if a collision is about to happen)\n      if (\n        this.isBetween(newX, boundX2, boundX1) &&\n        this.isBetween(newZ, boundZ2, boundZ1) &&\n        (this.isBetween(boundY1, 0, this.project.playerHeight) ||\n          this.isBetween(boundY2, 0, this.project.playerHeight) ||\n          (this.isBetween(this.project.playerHeight, boundY2, boundY1) &&\n            this.isBetween(0, boundY2, boundY1)))\n      ) {\n        collided = true;\n      }\n    }\n\n    // Move to new position & play footstep sound if no collision occured, otherwise play a collision sound\n    if (!collided) {\n      if (moveX != 0 || moveZ != 0) {\n        camera.position.copy(this.dummyCamera.position);\n        if (!this.project.activeRoom.footstepAudio.isPlaying) {\n          this.project.activeRoom.footstepAudio.play();\n        }\n      }\n    } else if (this.lastCollisionSound + 1000 < Date.now()) {\n      if (!this.project.activeRoom.collisionAudio.isPlaying) {\n        this.lastCollisionSound = Date.now();\n        this.project.activeRoom.collisionAudio.position.copy(\n          this.dummyCamera.position\n        );\n        this.project.activeRoom.collisionAudio.position.y -=\n          (this.project.playerHeight - 0.1) / 2;\n        this.project.activeRoom.collisionAudio.play();\n        console.log(\"playing collision\");\n      }\n    }\n\n    //Check for an object to interact with. If found, mark it as active (mostly for debugging and visual help for possible spectators)\n    //The raycaster helps to check for objects in sight. To ensure that objects on the bottom and top of sight are interactable too, the raycasting is called multiple times\n    //That way, objects from the middle top of the sight to the middle bottom of the screen are scanned and checked for their distance.\n    let nearestDist = Infinity;\n    let nearestObj: GameObject | null = null;\n\n    for (let i = 1; i >= -1; i -= 0.1) {\n      //From top (1) to middle(0) to bottom (-1)\n      this.raycaster.setFromCamera({ x: 0, y: i }, camera);\n      const intersections = this.raycaster.intersectObjects(\n        //perform raycasting with the given settings, originating from the main camera\n        this.project.activeRoom.children\n      );\n\n      for (const intersection of intersections) {\n        //Check, if the intersecting objects are actual GameObjects and if they are closer than the current closest intersecting GameObject\n        const o = intersection.object;\n        if (o instanceof GameObject && intersection.distance < nearestDist) {\n          nearestDist = intersection.distance;\n          nearestObj = o;\n        }\n      }\n    }\n\n    if (\n      nearestDist <= 1.5 &&\n      nearestObj != null &&\n      nearestObj.interactionType !== InteractionType.None\n    ) {\n      //If the clostest GameObject is closer or equal than 1.5m and interactable (and not null for safety), select it (visual representation)\n      if (!this.project.activeRoom.interactAvailAudio.isPlaying) {\n        this.project.activeRoom.interactAvailAudio.position.copy(\n          nearestObj.position\n        );\n        this.project.activeRoom.interactAvailAudio.play();\n      }\n      this.project.selectObject(nearestObj);\n    } else {\n      //Otherwise, unselect all\n      this.project.unselect();\n    }\n\n    //Interact with nearest (selected) object\n    if (\n      // Is the button or key clicked\n      (this.gamepads.getButtonStatus(0) || this.keys.isPressed(\"e\")) &&\n      //Prevent multiple actions on button hold\n      !this.lastKnownButtonStatus\n    ) {\n      this.lastKnownButtonStatus = true;\n      this.invokeInteraction();\n    } else if (!this.gamepads.getButtonStatus(0) && !this.keys.isPressed(\"e\")) {\n      this.lastKnownButtonStatus = false; //Last known button status was unpressed, so clear the value\n    }\n\n    //TODO - sounds for footsteps\n  }\n}\n","/**\n * @author Daniel Salomon\n */\nimport styled, { css } from \"styled-components\";\n\nexport const FocusedLabel = styled.div`\n  display: none;\n  position: absolute;\n  top: 20px;\n  right: 20px;\n  padding: 10px 15px;\n  border-radius: 3px;\n  background: hsl(210, 25%, 20%);\n  border: 1px solid hsl(210, 15%, 40%);\n  opacity: 0.8;\n  color: #fff;\n  pointer-events: none;\n`;\n\nexport const RunningLabel = styled.div`\n  position: absolute;\n  top: 20px;\n  left: 20px;\n  padding: 10px 15px;\n  border-radius: 3px;\n  background: hsl(210, 25%, 20%);\n  border: 1px solid hsl(210, 15%, 40%);\n  opacity: 0.8;\n  color: #fff;\n  font-size: 25px;\n`;\n\nexport const RunningHeadline = styled.p`\n  color: #fff;\n  font-size: 15px;\n  margin: 12px 10px 5px 10px;\n  font-weight: bold;\n`;\n\nexport const RunningButtonContainer = styled.div`\n  display: flex;\n  justify-content: left;\n`;\n\ninterface RunningButtonProps {\n  selected?: boolean;\n}\n\nexport const RunningButton = styled.div<RunningButtonProps>`\n  padding: 10px 15px;\n  margin: 5px;\n  color: #fff;\n  font-size: 15px;\n  border-radius: 3px;\n  background: hsla(0, 0%, 100%, 0.2);\n  ${props =>\n    props.selected &&\n    css`\n      box-shadow: 0px 0px 10px #00ff00;\n      background: #19611c;\n    `}\n\n  border: 1px solid hsl(210, 15%, 40%);\n  text-align: center;\n  cursor: pointer;\n\n  :hover {\n    ${props =>\n      !props.selected &&\n      css`\n        background: hsla(0, 0%, 100%, 0.4);\n      `}\n  }\n`;\n\nexport const ControlsTable = styled.table`\n  border: 0px solid transparent;\n  border-collapse: collapse;\n  font-size: 15px;\n  width: 100%;\n`;\n\nexport const Main = styled.main`\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  background-color: black;\n\n  :focus-within > ${FocusedLabel} {\n    display: block;\n  }\n`;\n","/**\n * @author Daniel Salomon\n */\nimport React from \"react\";\nimport Project from \"../project/Project\";\nimport AudioImplementation from \"../audio/AudioImplementation\";\nimport Runtime from \"./Runtime\";\nimport {\n  Main,\n  FocusedLabel,\n  RunningLabel,\n  RunningHeadline,\n  RunningButton,\n  RunningButtonContainer,\n  ControlsTable\n} from \"./styled\";\n\ninterface Props {\n  project: Project;\n  onExit(): void;\n}\ninterface State {\n  audioImplementation: AudioImplementation;\n}\n\nexport default class RuntimeContainer extends React.Component<Props> {\n  targetRef = React.createRef<HTMLDivElement>();\n  runtime = new Runtime(this.props.project);\n  activeButtonRef: HTMLElement | null = null;\n\n  state: State = { audioImplementation: AudioImplementation.WebAudio };\n\n  constructor(props: Props) {\n    super(props);\n    this.state.audioImplementation = this.props.project.activeAudioImplementation;\n  }\n\n  componentDidMount(): void {\n    if (this.targetRef.current) {\n      this.runtime.attach(this.targetRef.current);\n      this.runtime.focus();\n    }\n  }\n\n  componentWillUnmount(): void {\n    this.runtime.detach();\n  }\n\n  onExit = () => {\n    this.runtime.detach();\n    this.props.onExit();\n  };\n\n  onVisualToggle = () => {\n    this.runtime.toggleRendering();\n  };\n\n  onChangeAudio = (\n    event: React.MouseEvent<HTMLDivElement, MouseEvent>,\n    audio: AudioImplementation\n  ) => {\n    this.props.project.selectAudioImplementation(audio);\n    this.setState({ audioImplementation: audio });\n  };\n\n  render(): React.ReactNode {\n    const { audioImplementation } = this.state;\n\n    return (\n      <Main ref={this.targetRef}>\n        <RunningLabel>\n          Audio3D\n          <RunningHeadline>Menu</RunningHeadline>\n          <RunningButtonContainer>\n            <RunningButton onClick={this.onExit}>Exit</RunningButton>\n            <RunningButton onClick={this.onVisualToggle}>\n              Toggle visuals\n            </RunningButton>\n          </RunningButtonContainer>\n          <RunningHeadline>Audio implementation</RunningHeadline>\n          <RunningButtonContainer>\n            <RunningButton\n              onClick={e => this.onChangeAudio(e, AudioImplementation.WebAudio)}\n              selected={audioImplementation === AudioImplementation.WebAudio}\n            >\n              Web Audio API\n            </RunningButton>\n            <RunningButton\n              selected={audioImplementation === AudioImplementation.Binaural}\n              onClick={e => this.onChangeAudio(e, AudioImplementation.Binaural)}\n            >\n              BinauralFIR\n            </RunningButton>\n            <RunningButton\n              selected={\n                audioImplementation === AudioImplementation.ResonanceAudio\n              }\n              onClick={e =>\n                this.onChangeAudio(e, AudioImplementation.ResonanceAudio)\n              }\n            >\n              Resonance Audio\n            </RunningButton>\n          </RunningButtonContainer>\n          <RunningHeadline>Controls</RunningHeadline>\n          <ControlsTable>\n            <tbody>\n              <tr>\n                <td>Move</td>\n                <td>W/A/S/D or left stick</td>\n              </tr>\n              <tr>\n                <td>View</td>\n                <td>Arrow keys or right stick</td>\n              </tr>\n              <tr>\n                <td>Interact</td>\n                <td>E or A (XBOX)</td>\n              </tr>\n            </tbody>\n          </ControlsTable>\n        </RunningLabel>\n        <FocusedLabel>Focused</FocusedLabel>\n      </Main>\n    );\n  }\n}\n","/**\n * @author Niklas Korz\n */\nimport React from \"react\";\nimport styled from \"styled-components\";\n\nconst Backdrop = styled.div`\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background: rgba(0, 0, 0, 0.5);\n  z-index: 2;\n\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;\n\nconst Container = styled.div`\n  border-radius: 5px;\n  overflow: hidden;\n  max-width: 600px;\n  color: #fff;\n  background: hsl(210, 29%, 29%);\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);\n`;\n\nconst TitleBar = styled.div`\n  padding: 10px 15px;\n  background: hsl(210, 29%, 15%);\n`;\n\nconst Content = styled.div`\n  padding: 10px 15px;\n`;\n\nexport const ActionGroup = styled.div`\n  margin-top: 20px;\n  display: flex;\n  justify-content: flex-end;\n`;\n\nexport const Action = styled.button`\n  display: block;\n  appearance: none;\n  border: none;\n  background: hsl(210, 29%, 20%);\n  color: #fff;\n  cursor: pointer;\n  border-radius: 3px;\n  padding: 8px 12px;\n  margin-left: 10px;\n  font-size: 0.9em;\n\n  transition: 0.2s background-color, 0.2s box-shadow;\n\n  :hover,\n  :active {\n    background: hsl(210, 29%, 35%);\n    box-shadow: 3px 3px 5px rgba(0, 0, 0, 0.2);\n  }\n\n  :focus {\n    outline: none;\n    border-color: #3498db;\n  }\n\n  :disabled {\n    background: hsl(210, 19%, 20%);\n    color: hsl(210, 20%, 80%);\n    cursor: not-allowed;\n    box-shadow: none;\n  }\n`;\n\ninterface Props {\n  title: string;\n  onDismiss?(): void;\n}\n\nexport default class Modal extends React.Component<Props> {\n  onBackdropClick: React.MouseEventHandler = e => {\n    if (e.currentTarget === e.target && this.props.onDismiss) {\n      this.props.onDismiss();\n    }\n  };\n\n  render(): React.ReactNode {\n    return (\n      <Backdrop onClick={this.onBackdropClick}>\n        <Container>\n          <TitleBar>{this.props.title}</TitleBar>\n          <Content>{this.props.children}</Content>\n        </Container>\n      </Backdrop>\n    );\n  }\n}\n","/**\n * @author Niklas Korz\n */\nimport React from \"react\";\nimport Modal, { ActionGroup, Action } from \"./Modal\";\nimport { AudioEntry } from \"./types\";\n\ninterface Props {\n  audioEntry: AudioEntry;\n  onDelete(audioEntry: AudioEntry): void;\n  onExport(audioEntry: AudioEntry): void;\n  onDismiss(): void;\n  onCancel(): void;\n}\n\nexport default class AudioFileModal extends React.Component<Props> {\n  render(): React.ReactNode {\n    const { audioEntry } = this.props;\n    return (\n      <Modal title=\"Audio File\" onDismiss={this.props.onDismiss}>\n        <p>\n          <b>ID:</b> {audioEntry.id}\n        </p>\n        <p>\n          <b>Name:</b> {audioEntry.name}\n        </p>\n        <p>\n          <b>Type:</b> {audioEntry.type}\n        </p>\n        <p>\n          <b>Size:</b> {Math.ceil(audioEntry.data.byteLength / 1024)} KiB\n        </p>\n        <ActionGroup>\n          <Action onClick={() => this.props.onDelete(audioEntry)}>\n            Delete\n          </Action>\n          <Action onClick={() => this.props.onExport(audioEntry)}>\n            Export\n          </Action>\n          <Action onClick={this.props.onCancel}>Back</Action>\n        </ActionGroup>\n      </Modal>\n    );\n  }\n}\n","/**\n * @author Niklas Korz\n */\nimport React from \"react\";\nimport { saveAs } from \"file-saver\";\nimport styled from \"styled-components\";\nimport AudioLibrary from \"../project/AudioLibrary\";\nimport { openFileDialog, readFileAsArrayBuffer } from \"../utils/files\";\nimport AudioFileModal from \"./AudioFileModal\";\nimport Modal, { Action, ActionGroup } from \"./Modal\";\nimport { AudioEntry } from \"./types\";\n\nconst AudioList = styled.div`\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  margin: 0 -5px;\n`;\n\nconst AudioItem = styled.div`\n  flex: 1 1 150px;\n  margin: 5px;\n  padding: 10px 15px;\n  border-radius: 3px;\n  cursor: pointer;\n  background: hsl(210, 29%, 20%);\n  transition: 0.2s background-color, 0.2s box-shadow;\n\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  overflow: hidden;\n\n  :hover,\n  :active {\n    background: hsl(210, 29%, 35%);\n    box-shadow: 3px 3px 5px rgba(0, 0, 0, 0.2);\n  }\n`;\n\ninterface Props {\n  audioLibrary: AudioLibrary;\n  onDismiss(): void;\n  onSelect?(entry: AudioEntry): void;\n}\n\ninterface State {\n  entries: AudioEntry[];\n  selectedEntry: AudioEntry | null;\n}\n\nexport default class AudioLibraryModal extends React.Component<Props, State> {\n  previewAudio = new Audio();\n  state: State = { entries: [], selectedEntry: null };\n\n  openAudioFileDialog = async () => {\n    const file = await openFileDialog({ accept: \"audio/*\" });\n    const data = await readFileAsArrayBuffer(file);\n    const audioFile = { name: file.name, type: file.type, data };\n    const id = await this.props.audioLibrary.add(audioFile);\n    this.setState(({ entries }) => ({\n      entries: [\n        ...entries,\n        {\n          id,\n          ...audioFile\n        }\n      ]\n    }));\n  };\n\n  previewEntry(entry: AudioEntry): void {\n    this.previewAudio.src = URL.createObjectURL(new Blob([entry.data]));\n    this.previewAudio.loop = true;\n    this.previewAudio.play();\n  }\n\n  stopPreview = () => {\n    this.previewAudio.pause();\n    URL.revokeObjectURL(this.previewAudio.src);\n  };\n\n  dismiss = () => {\n    this.setState({ selectedEntry: null });\n    this.props.onDismiss();\n    this.stopPreview();\n  };\n\n  selectEntry(audioEntry: AudioEntry): void {\n    if (this.props.onSelect) {\n      this.props.onSelect(audioEntry);\n    } else {\n      this.setState({ selectedEntry: audioEntry });\n    }\n  }\n\n  unselectEntry = () => {\n    this.setState({ selectedEntry: null });\n    this.stopPreview();\n  };\n\n  deleteAudio = ({ id }: AudioEntry) => {\n    this.props.audioLibrary.delete(id);\n    this.setState(({ entries }) => ({\n      entries: entries.filter(e => e.id !== id),\n      selectedEntry: null\n    }));\n  };\n\n  exportAudio = ({ name, type, data }: AudioEntry) => {\n    saveAs(new Blob([data], { type }), name);\n  };\n\n  async updateEntries(): Promise<void> {\n    const entries: AudioEntry[] = [];\n    for await (const [id, audioFile] of this.props.audioLibrary.entries()) {\n      entries.push({ ...audioFile, id });\n    }\n    this.setState({\n      entries: entries.sort((a, b) => a.id - b.id)\n    });\n  }\n\n  async componentDidMount(): Promise<void> {\n    await this.updateEntries();\n  }\n\n  async componentDidUpdate(prevProps: Props): Promise<void> {\n    if (prevProps.audioLibrary !== this.props.audioLibrary) {\n      // The project and therefore the audio library to be rendered has changed\n      await this.updateEntries();\n    }\n  }\n\n  componentWillUnmount(): void {\n    this.previewAudio.pause();\n    URL.revokeObjectURL(this.previewAudio.src);\n  }\n\n  render(): React.ReactNode {\n    const { entries, selectedEntry } = this.state;\n\n    if (selectedEntry) {\n      return (\n        <AudioFileModal\n          audioEntry={selectedEntry}\n          onDelete={this.deleteAudio}\n          onExport={this.exportAudio}\n          onCancel={this.unselectEntry}\n          onDismiss={this.dismiss}\n        />\n      );\n    }\n\n    return (\n      <Modal\n        title={this.props.onSelect ? \"Select Audio\" : \"Audio Library\"}\n        onDismiss={this.dismiss}\n      >\n        <AudioList>\n          {entries.length > 0 &&\n            entries.map(e => (\n              <AudioItem\n                key={e.id}\n                title={e.name}\n                onClick={() => this.selectEntry(e)}\n                onMouseEnter={() => this.previewEntry(e)}\n                onMouseLeave={this.stopPreview}\n              >\n                {e.name} <br />\n                {e.type} <br />\n                {Math.ceil(e.data.byteLength / 1024)} KiB\n              </AudioItem>\n            ))}\n        </AudioList>\n        {!entries.length && <div>You haven't added any audio files yet</div>}\n        <ActionGroup>\n          <Action onClick={this.openAudioFileDialog}>Add audio file</Action>\n          <Action onClick={this.dismiss}>Cancel</Action>\n        </ActionGroup>\n      </Modal>\n    );\n  }\n}\n","/**\n * @author Niklas Korz\n */\nimport React from \"react\";\nimport styled, { css } from \"styled-components\";\nimport AudioImplementation from \"../audio/AudioImplementation\";\n\nconst Container = styled.div`\n  flex: 0 0 auto;\n  background: hsl(210, 29%, 15%);\n  color: #fff;\n  font-size: 0.9em;\n  padding: 0 10px;\n  user-select: none;\n\n  :focus {\n    outline: none;\n  }\n`;\n\ninterface MenubarItemProps {\n  isActive?: boolean;\n  alignRight?: boolean;\n}\n\nconst MenubarItem = styled.div<MenubarItemProps>`\n  position: relative;\n  display: inline-block;\n  padding: 10px 15px;\n  cursor: pointer;\n\n  :hover {\n    background: hsl(210, 25%, 20%);\n  }\n\n  ${props =>\n    props.isActive &&\n    css`\n      background: hsl(210, 25%, 20%);\n    `}\n\n  ${props =>\n    props.alignRight &&\n    css`\n      float: right;\n    `}\n`;\n\nconst MenubarItemLabel = styled.label`\n  cursor: pointer;\n`;\n\nconst Menu = styled.div`\n  z-index: 1;\n  position: absolute;\n  left: 0;\n  top: 100%;\n  background: hsl(210, 25%, 20%);\n  padding: 5px 0;\n  min-width: 200px;\n  font-size: 0.95em;\n  box-shadow: 5px 5px 8px rgba(0, 0, 0, 0.5);\n\n  border-bottom-left-radius: 3px;\n  border-bottom-right-radius: 3px;\n\n  cursor: default;\n`;\n\nconst MenuItem = styled.div`\n  white-space: nowrap;\n  padding: 8px 20px;\n  margin: 2px 0;\n  cursor: pointer;\n\n  :hover {\n    background: hsl(210, 29%, 15%);\n  }\n`;\n\nconst MenuDivider = styled.div`\n  height: 0;\n  margin: 5px;\n  border-bottom: 1px solid hsl(210, 15%, 35%);\n`;\n\ninterface Props {\n  audioImplementation: AudioImplementation;\n\n  onNewProject(): void;\n  onLoadProject(): void;\n  onSaveProject(): void;\n  onImportProject(): void;\n  onExportProject(): void;\n  onShowSettings(): void;\n\n  onAddObject(): void;\n  onDeleteObject(): void;\n  onAddSpawn(): void;\n  onDeleteSpawn(): void;\n  onAddRoom(): void;\n  onDeleteRoom(): void;\n\n  onShowAudioLibrary(): void;\n  onShowProjectManager(): void;\n\n  onAudioChange(audioImplementation: AudioImplementation): void;\n  onRunProject(): void;\n}\n\nenum MenuType {\n  FileMenu,\n  EditMenu,\n  AudioMenu,\n  ViewMenu,\n  HelpMenu\n}\n\ninterface State {\n  activeMenu: MenuType | null;\n}\n\nexport default class MenuBar extends React.Component<Props, State> {\n  state: State = {\n    activeMenu: null\n  };\n\n  toggleMenu(menuType: MenuType): void {\n    this.setState(state => ({\n      activeMenu: state.activeMenu === menuType ? null : menuType\n    }));\n  }\n\n  closeMenu(): void {\n    this.setState({ activeMenu: null });\n  }\n\n  render(): React.ReactNode {\n    const { audioImplementation, onAudioChange } = this.props;\n    const { activeMenu } = this.state;\n\n    return (\n      <Container tabIndex={-1} onBlur={() => this.closeMenu()}>\n        <MenubarItem\n          isActive={activeMenu === MenuType.FileMenu}\n          onClick={() => this.toggleMenu(MenuType.FileMenu)}\n        >\n          <MenubarItemLabel>File</MenubarItemLabel>\n          <Menu hidden={activeMenu !== MenuType.FileMenu}>\n            <MenuItem onClick={this.props.onNewProject}>New project</MenuItem>\n            <MenuDivider />\n            <MenuItem onClick={this.props.onLoadProject}>Load project</MenuItem>\n            <MenuItem onClick={this.props.onImportProject}>\n              Import project\n            </MenuItem>\n            <MenuDivider />\n            <MenuItem onClick={this.props.onSaveProject}>Save project</MenuItem>\n            <MenuItem onClick={this.props.onExportProject}>\n              Export project\n            </MenuItem>\n            <MenuDivider />\n            <MenuItem onClick={this.props.onShowSettings}>Settings</MenuItem>\n          </Menu>\n        </MenubarItem>\n        <MenubarItem\n          isActive={activeMenu === MenuType.EditMenu}\n          onClick={() => this.toggleMenu(MenuType.EditMenu)}\n        >\n          <MenubarItemLabel>Edit</MenubarItemLabel>\n          <Menu hidden={activeMenu !== MenuType.EditMenu}>\n            <MenuItem onClick={this.props.onAddObject}>Add object</MenuItem>\n            <MenuItem onClick={this.props.onDeleteObject}>\n              Delete object\n            </MenuItem>\n            <MenuDivider />\n            <MenuItem onClick={this.props.onAddSpawn}>Add spawn</MenuItem>\n            <MenuItem onClick={this.props.onDeleteSpawn}>Delete spawn</MenuItem>\n            <MenuDivider />\n            <MenuItem onClick={this.props.onAddRoom}>Add room</MenuItem>\n            <MenuItem onClick={this.props.onDeleteRoom}>Delete room</MenuItem>\n          </Menu>\n        </MenubarItem>\n        <MenubarItem\n          isActive={activeMenu === MenuType.ViewMenu}\n          onClick={() => this.toggleMenu(MenuType.ViewMenu)}\n        >\n          <MenubarItemLabel>View</MenubarItemLabel>\n          <Menu hidden={activeMenu !== MenuType.ViewMenu}>\n            <MenuItem onClick={this.props.onShowAudioLibrary}>\n              Audio Library\n            </MenuItem>\n            <MenuItem onClick={this.props.onShowProjectManager}>\n              Project Manager\n            </MenuItem>\n          </Menu>\n        </MenubarItem>\n        <MenubarItem\n          isActive={activeMenu === MenuType.HelpMenu}\n          onClick={() => this.toggleMenu(MenuType.HelpMenu)}\n        >\n          <MenubarItemLabel>Help</MenubarItemLabel>\n          <Menu hidden={activeMenu !== MenuType.HelpMenu}>\n            <MenuItem\n              onClick={() =>\n                window.open(\n                  \"https://github.com/niklaskorz/audio3d/wiki/Code-Blocks\",\n                  \"_blank\"\n                )\n              }\n            >\n              How to use Code Blocks\n            </MenuItem>\n            <MenuDivider />\n            <MenuItem\n              onClick={() =>\n                window.open(\n                  \"https://github.com/niklaskorz/audio3d/issues\",\n                  \"_blank\"\n                )\n              }\n            >\n              Issues\n            </MenuItem>\n            <MenuItem\n              onClick={() =>\n                window.open(\"https://github.com/niklaskorz/audio3d\", \"_blank\")\n              }\n            >\n              Source Code\n            </MenuItem>\n            <MenuDivider />\n            <MenuItem\n              onClick={() =>\n                window.open(\n                  \"https://github.com/niklaskorz/audio3d/blob/master/README.md\",\n                  \"_blank\"\n                )\n              }\n            >\n              About\n            </MenuItem>\n          </Menu>\n        </MenubarItem>\n        <MenubarItem alignRight onClick={this.props.onRunProject}>\n          <MenubarItemLabel>Run</MenubarItemLabel>\n        </MenubarItem>\n        <MenubarItem\n          alignRight\n          isActive={activeMenu === MenuType.AudioMenu}\n          onClick={() => this.toggleMenu(MenuType.AudioMenu)}\n        >\n          <MenubarItemLabel>Audio: {audioImplementation}</MenubarItemLabel>\n          <Menu hidden={activeMenu !== MenuType.AudioMenu}>\n            <MenuItem\n              onClick={() => onAudioChange(AudioImplementation.WebAudio)}\n            >\n              {AudioImplementation.WebAudio}\n            </MenuItem>\n            <MenuItem\n              onClick={() => onAudioChange(AudioImplementation.Binaural)}\n            >\n              {AudioImplementation.Binaural}\n            </MenuItem>\n\n            <MenuItem\n              onClick={() => onAudioChange(AudioImplementation.ResonanceAudio)}\n            >\n              {AudioImplementation.ResonanceAudio}\n            </MenuItem>\n          </Menu>\n        </MenubarItem>\n      </Container>\n    );\n  }\n}\n","/**\n * @author Niklas Korz\n */\n\nexport const selectOnFocus = (e: React.FocusEvent<HTMLInputElement>): void => {\n  e.currentTarget.select();\n};\n","/**\n * @author Niklas Korz\n */\nimport styled, { css } from \"styled-components\";\n\nexport const Container = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  background: #000;\n  display: flex;\n  flex-direction: column;\n`;\n\nexport const InnerContainer = styled.div`\n  flex: 1;\n  overflow: hidden;\n  display: flex;\n  flex-direction: row;\n`;\n\nexport const FocusedLabel = styled.div`\n  display: none;\n  position: absolute;\n  top: 20px;\n  right: 20px;\n  padding: 10px 15px;\n  border-radius: 3px;\n  background: hsl(210, 25%, 20%);\n  border: 1px solid hsl(210, 15%, 40%);\n  opacity: 0.8;\n  color: #fff;\n  pointer-events: none;\n`;\n\nexport const Main = styled.main`\n  position: relative;\n  flex: 1;\n  height: 100%;\n\n  :focus-within > ${FocusedLabel} {\n    display: block;\n  }\n`;\n\nexport const Sidebar = styled.aside`\n  font-size: 0.9em;\n  flex: 0 0 300px;\n  height: 100%;\n  background: hsl(210, 29%, 29%);\n  color: #fff;\n  padding: 0 15px;\n  padding-top: 1.4em;\n  overflow-x: hidden;\n  overflow-y: auto;\n`;\n\nexport const Group = styled.div`\n  margin: 0;\n  margin-bottom: 1.4em;\n\n  & > & {\n    margin-top: 1.4em;\n    font-size: 0.9em;\n  }\n`;\n\nexport const BoldLabel = styled.label`\n  font-weight: bold;\n`;\n\nexport const Hint = styled.p`\n  font-size: 0.9em;\n  color: hsl(210, 20%, 90%);\n`;\n\nexport const Input = styled.input`\n  display: block;\n  background: hsl(210, 29%, 24%);\n  border-radius: 0.2em;\n  border: 0.15em solid hsl(210, 29%, 24%);\n  color: #fff;\n  width: 100%;\n  padding: 0.7em 0.85em;\n  margin: 0.35em 0;\n\n  :not([type=\"range\"]) {\n    appearance: none;\n  }\n\n  transition: 0.2s ease border-color;\n  :focus {\n    outline: none;\n    border-color: #3498db;\n  }\n`;\n\nexport const Select = styled(Input.withComponent(\"select\"))`\n  cursor: pointer;\n`;\n\nexport const CustomInput = styled(Input.withComponent(\"div\"))`\n  cursor: pointer;\n`;\n\nexport const CodeEditor = styled(Input.withComponent(\"textarea\"))`\n  min-height: 200px;\n  font-family: \"Fira Code Retina\", \"Fira Code\", Consolas, Menlo, Monaco,\n    monospace;\n  white-space: pre;\n  line-height: 1.5;\n\n  /* Disable user resizing of width */\n  min-width: 100%;\n  max-width: 100%;\n`;\n\nexport const InputGroup = styled.div`\n  display: flex;\n  flex-direction: row;\n\n  > ${Input} {\n    flex: 1;\n    width: auto;\n    min-width: 0;\n\n    margin-right: 5px;\n\n    :last-child {\n      margin-right: 0;\n    }\n  }\n`;\n\nexport const RoomList = styled.ol`\n  list-style: none;\n  padding: 5px;\n  margin: 5px 0;\n  border-radius: 3px;\n  background: hsl(210, 29%, 24%);\n`;\n\ninterface RoomListItemProps {\n  active?: boolean;\n}\n\nexport const RoomListItem = styled.li<RoomListItemProps>`\n  cursor: pointer;\n  padding: 7px 10px;\n  border-radius: 2px;\n  ${props =>\n    props.active &&\n    css`\n      background: hsl(210, 29%, 20%);\n      border-left: 2px solid #3498db;\n    `};\n`;\n","/**\n * @author Niklas Korz\n */\nimport {\n  BoxGeometry,\n  DoubleSide,\n  Mesh,\n  MeshBasicMaterial,\n  Object3D,\n  Plane,\n  PlaneGeometry,\n  Raycaster,\n  Scene,\n  SphereGeometry,\n  Vector3\n} from \"three\";\nimport Project from \"../project/Project\";\n\n// The control mode is used to determine which planes and axes to enable.\n// While a game object may be moved and scaled arbitrarily, a spawn marker\n// shouldn't be scaleable and only be moveable on the X- and Y-axis.\nexport enum ControlMode {\n  Normal,\n  RestrictedXZ\n}\n\n// The object drag direction is required for calculating the plane to ray cast\n// against later on. Also, of course, to determine whether the object should be\n// moved on one or two axes.\nenum ObjectDragDirection {\n  AxisX,\n  AxisY,\n  AxisZ,\n  PlaneYZ,\n  PlaneXZ,\n  PlaneXY\n}\n\n// Inspired by https://github.com/mrdoob/three.js/blob/dev/examples/js/controls/TransformControls.js\n// As in the example, we are using ray casting for calculating the movements of planes and axes.\n// Everything else in this implementation has resulted either from trial and error or by\n// consulting the Three.js documentation.\n// The controls are grouped as a scene instead of a group object to allow drawing\n// them separately, on top of the main scene, to avoid any controls to be obscured\n// by objects that would theoretically appear in front of them based on their Z coordinate.\n// Furthermore, the scene's position is set to the active mesh's when one is\n// selected. This way, coordinates in the controls scene are always relative to the\n// active mesh.\n// Theoretically, it could also be added as a child node to the active mesh,\n// but this would result in the rotation being copied as well, which is not desirable\n// in this case.\n// Beware though that intersection points are always given in absolute world coordinates.\nexport default class VisualControls extends Scene {\n  project: Project;\n\n  objectDragDirection: ObjectDragDirection | null = null;\n  isScaling: boolean = false;\n  // The drag offset is used to determine the distance of the point where the\n  // user started dragging and the center of the object.\n  // This way, the cursor will always have the same relative position to the\n  // object while dragging.\n  dragOffset = new Vector3();\n  lastPoint = new Vector3();\n\n  // In contrast to the Three.js example, we will be using a real plane instead of a\n  // mesh that only represents an area on a plane.\n  // As a consequence, the ray generated by the ray caster will be used directly\n  // for calculating the intersection.\n  plane = new Plane();\n\n  // The visual controls\n  axisX: Mesh;\n  axisY: Mesh;\n  axisZ: Mesh;\n  scaleX: Mesh;\n  scaleY: Mesh;\n  scaleZ: Mesh;\n  planeYZ: Mesh;\n  planeXZ: Mesh;\n  planeXY: Mesh;\n\n  constructor(project: Project) {\n    super();\n\n    this.project = project;\n\n    // Setup visual controls for transformation\n\n    const materialConfig = {\n      transparent: true,\n      opacity: 0.75,\n      side: DoubleSide // Needed to make the planes viewable from both sides\n    };\n\n    // The X, Y and Z axes, represented as cuboids\n\n    const axisGeometry = new BoxGeometry(0.05, 0.05, 0.5);\n\n    this.axisX = new Mesh(\n      axisGeometry,\n      new MeshBasicMaterial({\n        ...materialConfig,\n        color: 0xff0000\n      })\n    );\n    this.axisX.position.set(0.275, 0.0, 0.0);\n    this.axisX.rotation.y = Math.PI / 2;\n    this.axisX.userData.direction = ObjectDragDirection.AxisX;\n\n    this.axisY = new Mesh(\n      axisGeometry,\n      new MeshBasicMaterial({\n        ...materialConfig,\n        color: 0x00ff00\n      })\n    );\n    this.axisY.position.set(0.0, 0.275, 0.0);\n    this.axisY.rotation.x = Math.PI / 2;\n    this.axisY.userData.direction = ObjectDragDirection.AxisY;\n\n    this.axisZ = new Mesh(\n      axisGeometry,\n      new MeshBasicMaterial({\n        ...materialConfig,\n        color: 0x0000ff\n      })\n    );\n    this.axisZ.position.set(0.0, 0.0, 0.275);\n    this.axisZ.userData.direction = ObjectDragDirection.AxisZ;\n\n    this.add(this.axisX);\n    this.add(this.axisY);\n    this.add(this.axisZ);\n\n    // Scaling controls per axis, represented as spheres\n\n    const scaleGeometry = new SphereGeometry(0.05, 16, 16);\n\n    this.scaleX = new Mesh(\n      scaleGeometry,\n      new MeshBasicMaterial({ ...materialConfig, color: 0xff0000 })\n    );\n    this.scaleX.position.set(0.65, 0, 0);\n    this.scaleX.userData.direction = ObjectDragDirection.AxisX;\n    this.scaleX.userData.isScale = true;\n\n    this.scaleY = new Mesh(\n      scaleGeometry,\n      new MeshBasicMaterial({ ...materialConfig, color: 0x00ff00 })\n    );\n    this.scaleY.position.set(0, 0.65, 0);\n    this.scaleY.userData.direction = ObjectDragDirection.AxisY;\n    this.scaleY.userData.isScale = true;\n\n    this.scaleZ = new Mesh(\n      scaleGeometry,\n      new MeshBasicMaterial({ ...materialConfig, color: 0x0000ff })\n    );\n    this.scaleZ.position.set(0, 0, 0.65);\n    this.scaleZ.userData.direction = ObjectDragDirection.AxisZ;\n    this.scaleZ.userData.isScale = true;\n\n    this.add(this.scaleX);\n    this.add(this.scaleY);\n    this.add(this.scaleZ);\n\n    // The YZ, XZ, XY planes, represented as areas on each plane.\n    // Declaration is ordered by the normal of the plane, i.e.\n    // the axis that will not be moved by it.\n\n    const planeGeometry = new PlaneGeometry(0.25, 0.25);\n\n    this.planeYZ = new Mesh(\n      planeGeometry,\n      new MeshBasicMaterial({ ...materialConfig, color: 0x00ffff })\n    );\n    this.planeYZ.position.set(0.0, 0.25, 0.25);\n    this.planeYZ.rotation.y = Math.PI / 2;\n    this.planeYZ.userData.direction = ObjectDragDirection.PlaneYZ;\n\n    this.planeXZ = new Mesh(\n      planeGeometry,\n      new MeshBasicMaterial({ ...materialConfig, color: 0xff00ff })\n    );\n    this.planeXZ.position.set(0.25, 0.0, 0.25);\n    this.planeXZ.rotation.x = Math.PI / 2;\n    this.planeXZ.userData.direction = ObjectDragDirection.PlaneXZ;\n\n    this.planeXY = new Mesh(\n      planeGeometry,\n      new MeshBasicMaterial({ ...materialConfig, color: 0xffff00 })\n    );\n    this.planeXY.position.set(0.25, 0.25, 0.0);\n    this.planeXY.userData.direction = ObjectDragDirection.PlaneXY;\n\n    this.add(this.planeYZ);\n    this.add(this.planeXZ);\n    this.add(this.planeXY);\n  }\n\n  setMode(controlMode: ControlMode): void {\n    if (controlMode === ControlMode.RestrictedXZ) {\n      this.axisY.visible = false;\n      this.planeXY.visible = false;\n      this.planeYZ.visible = false;\n      this.scaleX.visible = false;\n      this.scaleY.visible = false;\n      this.scaleZ.visible = false;\n    } else {\n      this.axisY.visible = true;\n      this.planeXY.visible = true;\n      this.planeYZ.visible = true;\n      this.scaleX.visible = true;\n      this.scaleY.visible = true;\n      this.scaleZ.visible = true;\n    }\n  }\n\n  getControlFromRaycaster(raycaster: Raycaster): Object3D | null {\n    const target = this.project.activeObject || this.project.activeSpawn;\n    if (!target) {\n      return null;\n    }\n\n    this.position.copy(target.position);\n\n    const intersections = raycaster.intersectObjects(this.children);\n    for (const intersection of intersections) {\n      const o = intersection.object;\n      if (o.userData.hasOwnProperty(\"direction\")) {\n        // Save the drag offset by subtracting the absolute position of the cursor\n        // (absolute meaning world coordinates) from the object's absolute position.\n        this.dragOffset.copy(intersection.point).sub(target.position);\n        this.lastPoint.copy(intersection.point);\n        return o;\n      }\n    }\n    return null;\n  }\n\n  // As we don't have access to the camera here and to avoid creating the ray caster\n  // twice, we just pass it from the initial mouse click handler and use it here.\n  // The original mouse event and screen coordinates are not required for the functionality\n  // of the controls, so they will not be taken as parameters here.\n  onClick(raycaster: Raycaster): boolean {\n    const o = this.getControlFromRaycaster(raycaster);\n    if (o && o.userData.hasOwnProperty(\"direction\")) {\n      this.objectDragDirection = o.userData.direction;\n      this.isScaling = !!o.userData.isScale;\n      this.onMove(raycaster);\n      return true;\n    }\n    return false;\n  }\n\n  // Initially, I used a Vector3(dx, dy, 0) here and applied the world rotation\n  // that can be calculated by the camera with camera.getWorldQuaternion(),\n  // followed by zeroing out the directions that should not be changed based on\n  // the plane or axis selected by the user.\n  // This resulted in a \"weird\" feeling though, as the zeroed axis gets completely lost,\n  // therefore making one of the two remaining axis movements feel slower than the other\n  // even if both are dragged equally on the screen.\n  //\n  // Similar to the Three.js transform controls example, this now uses a ray\n  // casted from the camera origin onto a plane that represents the axes to move\n  // on and sets the position of the object to the intersection point.\n  onMove({ ray }: Raycaster): void {\n    const target = this.project.activeObject || this.project.activeSpawn;\n    if (this.objectDragDirection === null || !target) {\n      return;\n    }\n\n    const c = target.position;\n    const p = this.plane;\n    let altPlane: Plane | null = null;\n\n    // Update the normal and constant (^= position) of the plane\n    // The second parameter of the Plane constructor is called the \"constant\" and\n    // is used for defining the plane in Hessian normal form. It defines\n    // the negative distance from the origin to the plane.\n    switch (this.objectDragDirection) {\n      case ObjectDragDirection.AxisX:\n        p.set(new Vector3(0, 1, 0), -c.y);\n        altPlane = new Plane(new Vector3(0, 0, 1), -c.z);\n        break;\n      case ObjectDragDirection.AxisY:\n        p.set(new Vector3(1, 0, 0), -c.x);\n        altPlane = new Plane(new Vector3(0, 0, 1), -c.z);\n        break;\n      case ObjectDragDirection.AxisZ:\n        p.set(new Vector3(1, 0, 0), -c.x);\n        altPlane = new Plane(new Vector3(0, 1, 0), -c.y);\n        break;\n      case ObjectDragDirection.PlaneXY:\n        p.set(new Vector3(0, 0, 1), -c.z);\n        break;\n      case ObjectDragDirection.PlaneYZ:\n        p.set(new Vector3(1, 0, 0), -c.x);\n        break;\n      case ObjectDragDirection.PlaneXZ:\n        p.set(new Vector3(0, 1, 0), -c.y);\n        break;\n    }\n\n    // If there is an alternative plane (i.e., for axes),\n    // check which one is farther away from the ray's origin.\n    // This is needed to prevent issues when the camera comes too close to the\n    // plane.\n    if (\n      altPlane &&\n      Math.abs(altPlane.distanceToPoint(ray.origin)) >\n        Math.abs(p.distanceToPoint(ray.origin))\n    ) {\n      p.copy(altPlane);\n    }\n\n    const point = ray.intersectPlane(p, new Vector3());\n    if (!point) {\n      // No intersection\n      return;\n    }\n\n    if (this.isScaling) {\n      // For scaling, we are using the relative movement instead of the position\n      // as no movement at all should leave the scale as is.\n      // I.e., we are adding the distance to the previously recorded intersection point\n      // to the object's scale.\n      switch (this.objectDragDirection) {\n        case ObjectDragDirection.AxisX:\n          target.scale.x = Math.min(\n            Math.max(target.scale.x + (point.x - this.lastPoint.x), 0.1),\n            10\n          );\n          break;\n        case ObjectDragDirection.AxisY:\n          target.scale.y = Math.min(\n            Math.max(target.scale.y + (point.y - this.lastPoint.y), 0.1),\n            10\n          );\n          break;\n        case ObjectDragDirection.AxisZ:\n          target.scale.z = Math.min(\n            Math.max(target.scale.z + (point.z - this.lastPoint.z), 0.1),\n            10\n          );\n          break;\n      }\n\n      this.project.events.onScale(target.scale);\n    } else {\n      point.sub(this.dragOffset);\n\n      // If we are operating on an axis instead of a plane, ensure only the relevant\n      // coordinate is changed.\n      switch (this.objectDragDirection) {\n        case ObjectDragDirection.AxisX:\n          target.position.x = point.x;\n          break;\n        case ObjectDragDirection.AxisY:\n          target.position.y = point.y;\n          break;\n        case ObjectDragDirection.AxisZ:\n          target.position.z = point.z;\n          break;\n        default:\n          // The selected direction is a plane, so we can just copy the\n          // intersection point.\n          target.position.copy(point);\n      }\n\n      this.project.events.onTranslate(target.position);\n    }\n\n    this.lastPoint.copy(point);\n  }\n}\n","/**\n * @author Niklas Korz\n */\nimport React from \"react\";\nimport { degToRad, radToDeg, roundToPrecision } from \"../utils/math\";\nimport { InteractionType, TeleportTarget } from \"../project/GameObject\";\nimport Room from \"../project/Room\";\nimport { selectOnFocus } from \"../utils/react\";\nimport {\n  Group,\n  Input,\n  InputGroup,\n  CustomInput,\n  Select,\n  CodeEditor,\n  Hint\n} from \"./styled\";\nimport { EditorObject } from \"./types\";\n\ninterface Props {\n  object: EditorObject;\n  rooms: Room[];\n  onUpdateVolume(volume: number): void;\n  onUpdateName(name: string): void;\n  onUpdatePosition(x: number, y: number, z: number): void;\n  onUpdateRotation(x: number, y: number, z: number): void;\n  onUpdateScale(x: number, y: number, z: number): void;\n  onUpdateInteractionType(interactionType: InteractionType): void;\n  onUpdateCodeBlockSource(source: string): void;\n  onUpdateTeleportTarget(teleportTarget: TeleportTarget): void;\n  onShowAudioSelection(): void;\n  onShowInteractionAudioSelection(): void;\n}\n\ninterface State {\n  codeError?: string;\n  volume: number;\n}\n\n// UI component for editing properties specific to objects inside a room\nexport default class ObjectEditor extends React.Component<Props, State> {\n  codeCheckTimeout: number | null = null;\n  state: State = {\n    volume: 1\n  };\n\n  checkCode = () => {\n    const { codeBlockSource } = this.props.object;\n    if (codeBlockSource == null) {\n      return;\n    }\n\n    try {\n      // Try to parse the code block source\n      new Function(\"playerState\", \"roomState\", codeBlockSource);\n      this.setState({ codeError: undefined });\n    } catch (ex) {\n      this.setState({ codeError: ex.toString() });\n    }\n  };\n\n  updateCodeBlockSource: React.ChangeEventHandler<HTMLTextAreaElement> = e => {\n    this.props.onUpdateCodeBlockSource(e.currentTarget.value);\n    if (this.codeCheckTimeout != null) {\n      window.clearTimeout(this.codeCheckTimeout);\n    }\n    this.codeCheckTimeout = window.setTimeout(this.checkCode, 2000);\n  };\n\n  updateTeleportTargetRoomId: React.ChangeEventHandler<\n    HTMLSelectElement\n  > = e => {\n    const roomId = e.currentTarget.value;\n    this.props.onUpdateTeleportTarget({ roomId, spawnId: \"\" });\n  };\n\n  updateTeleportTargetSpawnId: React.ChangeEventHandler<\n    HTMLSelectElement\n  > = e => {\n    const { object: o, onUpdateTeleportTarget } = this.props;\n    if (o.teleportTarget) {\n      const spawnId = e.currentTarget.value;\n      onUpdateTeleportTarget({ ...o.teleportTarget, spawnId });\n    }\n  };\n\n  componentDidMount(): void {\n    this.checkCode();\n  }\n\n  componentWillUnmount(): void {\n    if (this.codeCheckTimeout != null) {\n      window.clearTimeout(this.codeCheckTimeout);\n      this.codeCheckTimeout = null;\n    }\n  }\n\n  render(): React.ReactNode {\n    const {\n      object: o,\n      rooms,\n      onUpdateName,\n      onUpdatePosition,\n      onUpdateRotation,\n      onUpdateVolume,\n      onUpdateScale,\n      onUpdateInteractionType,\n      onShowAudioSelection,\n      onShowInteractionAudioSelection\n    } = this.props;\n    const { codeError } = this.state;\n    const teleportTargetRoom =\n      o.teleportTarget && rooms.find(r => r.uuid === o.teleportTarget!.roomId);\n\n    return (\n      <div>\n        <Group>\n          <label>Object ID</label>\n          <Input type=\"text\" readOnly value={o.uuid} onFocus={selectOnFocus} />\n        </Group>\n        <Group>\n          <label>Name</label>\n          <Input\n            type=\"text\"\n            placeholder=\"New object\"\n            value={o.name}\n            onChange={e => onUpdateName(e.currentTarget.value)}\n          />\n        </Group>\n        <Group>\n          <label>Position (x, y, z)</label>\n          <InputGroup>\n            <Input\n              type=\"number\"\n              step={0.01}\n              value={o.position.x.toFixed(2)}\n              onChange={e =>\n                onUpdatePosition(\n                  roundToPrecision(e.currentTarget.valueAsNumber, 0.01),\n                  o.position.y,\n                  o.position.z\n                )\n              }\n            />\n            <Input\n              type=\"number\"\n              step={0.01}\n              value={o.position.y.toFixed(2)}\n              onChange={e =>\n                onUpdatePosition(\n                  o.position.x,\n                  roundToPrecision(e.currentTarget.valueAsNumber, 0.01),\n                  o.position.z\n                )\n              }\n            />\n            <Input\n              type=\"number\"\n              step={0.01}\n              value={o.position.z.toFixed(2)}\n              onChange={e =>\n                onUpdatePosition(\n                  o.position.x,\n                  o.position.y,\n                  roundToPrecision(e.currentTarget.valueAsNumber, 0.01)\n                )\n              }\n            />\n          </InputGroup>\n        </Group>\n        <Group>\n          <label>Euler-Rotation in Degrees (x, y, z)</label>\n          <InputGroup>\n            <Input\n              type=\"number\"\n              step={1}\n              value={radToDeg(o.rotation.x).toFixed(0)}\n              onChange={e =>\n                onUpdateRotation(\n                  degToRad(e.currentTarget.valueAsNumber % 360),\n                  o.rotation.y,\n                  o.rotation.z\n                )\n              }\n            />\n            <Input\n              type=\"number\"\n              step={1}\n              value={radToDeg(o.rotation.y).toFixed(0)}\n              onChange={e =>\n                onUpdateRotation(\n                  o.rotation.x,\n                  degToRad(e.currentTarget.valueAsNumber % 360),\n                  o.rotation.z\n                )\n              }\n            />\n            <Input\n              type=\"number\"\n              step={1}\n              value={radToDeg(o.rotation.z).toFixed(0)}\n              onChange={e =>\n                onUpdateRotation(\n                  o.rotation.x,\n                  o.rotation.y,\n                  degToRad(e.currentTarget.valueAsNumber % 360)\n                )\n              }\n            />\n          </InputGroup>\n        </Group>\n        <Group>\n          <label>Size (width, height, depth)</label>\n          <InputGroup>\n            <Input\n              type=\"number\"\n              step={0.1}\n              min={0.1}\n              max={10}\n              value={o.scale.x.toFixed(1)}\n              onChange={e =>\n                onUpdateScale(\n                  e.currentTarget.valueAsNumber,\n                  o.scale.y,\n                  o.scale.z\n                )\n              }\n            />\n            <Input\n              type=\"number\"\n              step={0.1}\n              min={0.1}\n              max={10}\n              value={o.scale.y.toFixed(1)}\n              onChange={e =>\n                onUpdateScale(\n                  o.scale.x,\n                  e.currentTarget.valueAsNumber,\n                  o.scale.z\n                )\n              }\n            />\n            <Input\n              type=\"number\"\n              step={0.1}\n              min={0.1}\n              max={10}\n              value={o.scale.z.toFixed(1)}\n              onChange={e =>\n                onUpdateScale(\n                  o.scale.x,\n                  o.scale.y,\n                  e.currentTarget.valueAsNumber\n                )\n              }\n            />\n          </InputGroup>\n        </Group>\n        <Group>\n          <label>Audio</label>\n          <CustomInput onClick={onShowAudioSelection}>\n            {o.audio\n              ? `${o.audio.name} (${Math.ceil(\n                  o.audio.data.byteLength / 1024\n                )} KiB)`\n              : \"No audio selected\"}\n          </CustomInput>\n          {o.audio != null && (\n            <>\n              <Group>\n                <label>Loop Pause (seconds)</label>\n                <Input type=\"number\" min=\"0\" max=\"60\" step=\"1\" />\n              </Group>\n              <Group>\n                <label>Volume (0% to 200%)</label>\n                <Input\n                  type=\"range\"\n                  min=\"0\"\n                  max=\"2\"\n                  step=\"0.05\"\n                  value={o.volume}\n                  onChange={e => onUpdateVolume(e.currentTarget.valueAsNumber)}\n                />\n              </Group>\n            </>\n          )}\n        </Group>\n        <Group>\n          <label>Interaction</label>\n          <Select\n            value={o.interactionType}\n            onChange={e =>\n              onUpdateInteractionType(e.currentTarget.value as InteractionType)\n            }\n          >\n            {Object.values(InteractionType).map(t => (\n              <option key={t}>{t}</option>\n            ))}\n          </Select>\n          {o.interactionType === InteractionType.CodeBlock && (\n            <>\n              <CodeEditor\n                placeholder=\"// JavaScript\"\n                value={o.codeBlockSource}\n                onChange={this.updateCodeBlockSource}\n              />\n              <Hint>{codeError || \"No syntax errors detected\"}</Hint>\n            </>\n          )}\n          {o.interactionType === InteractionType.Teleport && o.teleportTarget && (\n            <Group>\n              <label>Teleport Target</label>\n              <Select\n                value={o.teleportTarget.roomId}\n                onChange={this.updateTeleportTargetRoomId}\n              >\n                {rooms.map(r => (\n                  <option key={r.uuid} value={r.uuid}>\n                    {r.name || \"Anonymous Room\"}\n                  </option>\n                ))}\n              </Select>\n              {teleportTargetRoom && (\n                <Select\n                  value={o.teleportTarget.spawnId}\n                  onChange={this.updateTeleportTargetSpawnId}\n                >\n                  {teleportTargetRoom.spawns.map(s => (\n                    <option key={s.uuid} value={s.uuid}>\n                      {s.name || \"New spawn\"}\n                    </option>\n                  ))}\n                </Select>\n              )}\n            </Group>\n          )}\n          {o.interactionType !== InteractionType.None &&\n            o.interactionType !== InteractionType.CodeBlock && (\n              <Group>\n                <label>Interaction Sound</label>\n                <CustomInput onClick={onShowInteractionAudioSelection}>\n                  {o.interactionAudio\n                    ? `${o.interactionAudio.name} (${Math.ceil(\n                        o.interactionAudio.data.byteLength / 1024\n                      )} KiB)`\n                    : \"No audio selected\"}\n                </CustomInput>\n              </Group>\n            )}\n        </Group>\n      </div>\n    );\n  }\n}\n","/**\n * @author Niklas Korz\n */\nimport { Color, Mesh, Raycaster, Vector2, Vector3, WebGLRenderer } from \"three\";\nimport GamepadListener from \"../input/GamepadListener\";\nimport KeyboardListener from \"../input/KeyboardListener\";\nimport GameObject from \"../project/GameObject\";\nimport Project from \"../project/Project\";\nimport SpawnMarker from \"../project/SpawnMarker\";\nimport VisualControls, { ControlMode } from \"./VisualControls\";\n\nenum MouseButton {\n  Primary = 0,\n  Middle = 1,\n  Secondary = 2\n}\n\nconst axes = {\n  x: new Vector3(1, 0, 0),\n  y: new Vector3(0, 1, 0),\n  z: new Vector3(0, 0, 1)\n};\n\nexport default class EditorCanvas {\n  target!: HTMLElement;\n  project: Project;\n\n  rafHandle = 0;\n  previousTimestamp = 0;\n\n  controls: VisualControls;\n\n  renderer = new WebGLRenderer();\n  canvas: HTMLCanvasElement;\n  outlineMesh = new Mesh();\n\n  raycaster = new Raycaster();\n\n  keys = new KeyboardListener(this.renderer.domElement);\n  gamepads = new GamepadListener();\n  isDraggingCamera = false;\n\n  constructor(project: Project) {\n    this.project = project;\n\n    this.renderer.autoClear = false;\n    this.renderer.setClearColor(new Color(0x192a56));\n    this.canvas = this.renderer.domElement;\n    this.canvas.tabIndex = -1; // Make element focusable\n    this.canvas.addEventListener(\"mousedown\", this.onMouseDown);\n    this.canvas.addEventListener(\"mouseup\", this.onMouseUp);\n    this.canvas.addEventListener(\"mousemove\", this.onMouseMove);\n    this.canvas.addEventListener(\"wheel\", this.onWheel);\n    this.canvas.addEventListener(\n      \"contextmenu\",\n      e => {\n        e.preventDefault();\n        e.stopPropagation();\n        return false;\n      },\n      true\n    );\n\n    // Setup scene\n\n    this.controls = new VisualControls(project);\n\n    // const ph = new PlaneHelper(this.controls.plane, 10, 0x999999);\n    // this.scene.add(ph);\n  }\n\n  attach(target: HTMLElement): void {\n    this.keys.listen();\n    this.gamepads.listen();\n\n    this.target = target;\n    target.appendChild(this.canvas);\n\n    this.resize();\n    window.requestAnimationFrame(this.animate);\n    window.addEventListener(\"resize\", this.resize);\n  }\n\n  detach(): void {\n    window.cancelAnimationFrame(this.rafHandle);\n    window.removeEventListener(\"resize\", this.resize);\n\n    if (this.target) {\n      this.target.removeChild(this.canvas);\n      delete this.target;\n    }\n\n    this.keys.stop();\n    this.gamepads.stop();\n  }\n\n  focus(): void {\n    this.canvas.focus();\n  }\n\n  changeProject(project: Project): void {\n    this.project = project;\n    this.controls.project = project;\n    // Ensure the selected project's camera has the correct aspect ratio\n    this.resize();\n  }\n\n  resize = (): void => {\n    if (!this.target) {\n      return;\n    }\n\n    const { offsetWidth, offsetHeight } = this.target;\n\n    this.project.camera.aspect = offsetWidth / offsetHeight;\n    this.project.camera.updateProjectionMatrix();\n\n    this.renderer.setPixelRatio(window.devicePixelRatio);\n    this.renderer.setSize(offsetWidth, offsetHeight);\n  };\n\n  animate: FrameRequestCallback = t => {\n    this.rafHandle = window.requestAnimationFrame(this.animate);\n\n    const dt = (t - this.previousTimestamp) / 1000;\n    this.previousTimestamp = t;\n    this.update(dt);\n\n    this.renderer.clear();\n    this.renderer.render(this.project.activeRoom, this.project.camera);\n\n    if (this.project.activeObject || this.project.activeSpawn) {\n      if (this.project.activeObject) {\n        this.controls.setMode(ControlMode.Normal);\n        this.controls.position.copy(this.project.activeObject.position);\n      } else if (this.project.activeSpawn) {\n        this.controls.setMode(ControlMode.RestrictedXZ);\n        this.controls.position.copy(this.project.activeSpawn.position);\n      }\n\n      // Draw controls in front of all other objects\n      // https://stackoverflow.com/questions/12666570/how-to-change-the-zorder-of-object-with-threejs/12666937#12666937\n      this.renderer.clearDepth();\n      this.renderer.render(this.controls, this.project.camera);\n    }\n  };\n\n  update(dt: number): void {\n    const { camera } = this.project;\n\n    if (this.keys.isPressed(\"w\")) {\n      camera.translateOnAxis(axes.z, -2 * dt);\n    }\n    if (this.keys.isPressed(\"s\")) {\n      camera.translateOnAxis(axes.z, 2 * dt);\n    }\n    if (this.keys.isPressed(\"a\")) {\n      camera.translateOnAxis(axes.x, -2 * dt);\n    }\n    if (this.keys.isPressed(\"d\")) {\n      camera.translateOnAxis(axes.x, 2 * dt);\n    }\n    if (this.keys.isPressed(\" \")) {\n      camera.position.y += 2 * dt;\n    }\n    if (this.keys.isPressed(\"Shift\")) {\n      camera.position.y -= 2 * dt;\n    }\n\n    if (this.keys.isPressed(\"ArrowLeft\")) {\n      camera.rotateOnWorldAxis(axes.y, dt);\n    }\n    if (this.keys.isPressed(\"ArrowRight\")) {\n      camera.rotateOnWorldAxis(axes.y, -dt);\n    }\n    if (this.keys.isPressed(\"ArrowUp\")) {\n      camera.rotateOnAxis(axes.x, dt);\n    }\n    if (this.keys.isPressed(\"ArrowDown\")) {\n      camera.rotateOnAxis(axes.x, -dt);\n    }\n\n    const gamepadAxes = {\n      x: this.gamepads.getAxis(0),\n      y: this.gamepads.getAxis(1),\n      rX: this.gamepads.getAxis(2),\n      rY: this.gamepads.getAxis(3),\n      b: this.gamepads.getAxis(4)\n    };\n    // console.log(axes);\n    if (gamepadAxes.x) {\n      camera.translateOnAxis(axes.x, 2 * dt * gamepadAxes.x);\n    }\n    if (gamepadAxes.y) {\n      camera.translateOnAxis(axes.z, 2 * dt * gamepadAxes.y);\n    }\n    if (gamepadAxes.b) {\n      camera.translateOnAxis(axes.y, 2 * dt * gamepadAxes.b);\n    }\n    if (gamepadAxes.rX) {\n      camera.rotateOnWorldAxis(axes.y, -dt * gamepadAxes.rX);\n    }\n    if (gamepadAxes.rY) {\n      camera.rotateOnAxis(axes.x, -dt * gamepadAxes.rY);\n    }\n  }\n\n  checkSceneClick(raycaster: Raycaster): boolean {\n    const intersections = raycaster.intersectObjects(\n      this.project.activeRoom.children\n    );\n    for (const intersection of intersections) {\n      const o = intersection.object;\n      if (o instanceof SpawnMarker) {\n        this.project.selectSpawn(o);\n        return true;\n      }\n      if (o instanceof GameObject) {\n        this.project.selectObject(o);\n        return true;\n      }\n    }\n\n    this.project.unselect();\n    return false;\n  }\n\n  updateRaycaster(e: MouseEvent): void {\n    const size = this.renderer.getSize(new Vector2());\n    // Normalize screen coordinates\n    const x = ((e.pageX - this.target.offsetLeft) / size.x) * 2 - 1;\n    const y = -((e.pageY - this.target.offsetTop) / size.y) * 2 + 1;\n    // Update raycaster\n    this.raycaster.setFromCamera({ x, y }, this.project.camera);\n  }\n\n  onMouseDown = (e: MouseEvent): void => {\n    if (e.button === MouseButton.Secondary) {\n      this.isDraggingCamera = true;\n      this.canvas.requestPointerLock();\n    }\n\n    if (e.button !== MouseButton.Primary) {\n      return;\n    }\n\n    this.updateRaycaster(e);\n    if (this.controls.onClick(this.raycaster)) {\n      this.canvas.style.cursor = \"grabbing\";\n    } else {\n      this.checkSceneClick(this.raycaster);\n    }\n  };\n\n  onMouseUp = (e: MouseEvent): void => {\n    if (e.button === MouseButton.Secondary && this.isDraggingCamera) {\n      this.isDraggingCamera = false;\n      document.exitPointerLock();\n    }\n    if (\n      e.button === MouseButton.Primary &&\n      this.controls.objectDragDirection !== null\n    ) {\n      this.controls.objectDragDirection = null;\n      if (this.controls.getControlFromRaycaster(this.raycaster)) {\n        this.canvas.style.cursor = \"grab\";\n      } else {\n        this.canvas.style.cursor = null;\n      }\n    }\n  };\n\n  onMouseMove = (e: MouseEvent): void => {\n    if (this.isDraggingCamera) {\n      if (e.movementX) {\n        this.project.camera.rotateOnWorldAxis(axes.y, -e.movementX / 100);\n      }\n      if (e.movementY) {\n        this.project.camera.rotateOnAxis(axes.x, -e.movementY / 100);\n      }\n    } else {\n      this.updateRaycaster(e);\n      if (this.controls.objectDragDirection !== null) {\n        this.controls.onMove(this.raycaster);\n      } else if (this.controls.getControlFromRaycaster(this.raycaster)) {\n        this.canvas.style.cursor = \"grab\";\n      } else {\n        this.canvas.style.cursor = null;\n      }\n    }\n  };\n\n  onWheel = (e: WheelEvent): void => {\n    e.preventDefault();\n    // console.log('onWheel', e.deltaX, e.deltaY, e.deltaZ, e.deltaMode);\n    let delta = e.deltaY;\n    if (e.deltaMode === 0) {\n      // More granular zoom for pixel mode\n      delta /= 15;\n    }\n    this.project.camera.translateZ(delta / 10);\n  };\n}\n","/**\n * @author Niklas Korz\n */\nimport React from \"react\";\nimport { RoomDimensions, ResonanceAudio, RoomMaterials } from \"resonance-audio\";\nimport { selectOnFocus } from \"../utils/react\";\nimport { Group, Input, InputGroup, Select, Hint } from \"./styled\";\nimport { EditorRoom } from \"./types\";\n\nconst materials = Object.keys(ResonanceAudio.Utils.ROOM_MATERIAL_COEFFICIENTS);\n\ninterface Props {\n  room: EditorRoom;\n  onUpdateName(name: string): void;\n  onUpdateDimensions(dimensions: RoomDimensions): void;\n  onUpdateMaterials(materials: RoomMaterials): void;\n}\n\n// UI component for editing properties specific to a room itself\nexport default class RoomEditor extends React.Component<Props> {\n  selectMaterialHandler(\n    propertyName: keyof RoomMaterials\n  ): React.ChangeEventHandler<HTMLSelectElement> {\n    return e => {\n      const { room, onUpdateMaterials } = this.props;\n      onUpdateMaterials({\n        ...room.materials,\n        [propertyName]: e.currentTarget.value\n      });\n    };\n  }\n\n  render(): React.ReactNode {\n    const { room: r, onUpdateName, onUpdateDimensions } = this.props;\n\n    const materialOptions = materials.map(ce => <option key={ce}>{ce}</option>);\n\n    return (\n      <div>\n        <Group>\n          <label>Room ID</label>\n          <Input type=\"text\" readOnly value={r.uuid} onFocus={selectOnFocus} />\n        </Group>\n        <Group>\n          <label>Name</label>\n          <Input\n            type=\"text\"\n            placeholder=\"Anonymous Room\"\n            value={r.name}\n            onChange={e => onUpdateName(e.currentTarget.value)}\n          />\n        </Group>\n        <Group>\n          <label>Dimensions (width, depth, height)</label>\n          <InputGroup>\n            <Input\n              type=\"number\"\n              step={1}\n              min={5}\n              max={50}\n              value={r.dimensions.width}\n              onChange={e =>\n                onUpdateDimensions({\n                  ...r.dimensions,\n                  width: Math.round(e.currentTarget.valueAsNumber)\n                })\n              }\n            />\n            <Input\n              type=\"number\"\n              step={1}\n              min={5}\n              max={50}\n              value={r.dimensions.depth}\n              onChange={e =>\n                onUpdateDimensions({\n                  ...r.dimensions,\n                  depth: Math.round(e.currentTarget.valueAsNumber)\n                })\n              }\n            />\n            <Input\n              type=\"number\"\n              step={1}\n              min={2}\n              max={10}\n              value={r.dimensions.height}\n              onChange={e =>\n                onUpdateDimensions({\n                  ...r.dimensions,\n                  height: Math.round(e.currentTarget.valueAsNumber)\n                })\n              }\n            />\n          </InputGroup>\n        </Group>\n        <Group>\n          <label>Room Materials</label>\n          <Hint>\n            These materials are used for calculating resonance (reverb) in the\n            room. Only supported when using Resonance Audio.\n          </Hint>\n          <Group>\n            <label>Left wall</label>\n            <Select\n              value={r.materials.left}\n              onChange={this.selectMaterialHandler(\"left\")}\n            >\n              {materialOptions}\n            </Select>\n          </Group>\n          <Group>\n            <label>Right wall</label>\n            <Select\n              value={r.materials.right}\n              onChange={this.selectMaterialHandler(\"right\")}\n            >\n              {materialOptions}\n            </Select>\n          </Group>\n          <Group>\n            <label>Front wall</label>\n            <Select\n              value={r.materials.front}\n              onChange={this.selectMaterialHandler(\"front\")}\n            >\n              {materialOptions}\n            </Select>\n          </Group>\n          <Group>\n            <label>Back wall</label>\n            <Select\n              value={r.materials.back}\n              onChange={this.selectMaterialHandler(\"back\")}\n            >\n              {materialOptions}\n            </Select>\n          </Group>\n          <Group>\n            <label>Floor</label>\n            <Select\n              value={r.materials.down}\n              onChange={this.selectMaterialHandler(\"down\")}\n            >\n              {materialOptions}\n            </Select>\n          </Group>\n          <Group>\n            <label>Ceiling</label>\n            <Select\n              value={r.materials.up}\n              onChange={this.selectMaterialHandler(\"up\")}\n            >\n              {materialOptions}\n            </Select>\n          </Group>\n        </Group>\n      </div>\n    );\n  }\n}\n","/**\n * @author Niklas Korz\n */\nimport React from \"react\";\nimport { ProjectData } from \"../data/schema\";\nimport Modal, { ActionGroup, Action } from \"./Modal\";\n\ninterface Props {\n  project: ProjectData;\n  onDelete(project: ProjectData): void;\n  onExport(project: ProjectData): void;\n  onDismiss(): void;\n  onCancel(): void;\n}\n\nexport default class ProjectInfoModal extends React.Component<Props> {\n  render(): React.ReactNode {\n    const { project } = this.props;\n    return (\n      <Modal title=\"Project Info\" onDismiss={this.props.onDismiss}>\n        <p>\n          <b>Name:</b> {project.name}\n        </p>\n        <p>\n          <b>Last update:</b> {project.savedAt.toLocaleString()}\n        </p>\n        <p>\n          <b>Rooms:</b> {project.rooms.length}\n        </p>\n        <ActionGroup>\n          <Action onClick={() => this.props.onDelete(project)}>Delete</Action>\n          <Action onClick={() => this.props.onExport(project)}>Export</Action>\n          <Action onClick={this.props.onCancel}>Back</Action>\n        </ActionGroup>\n      </Modal>\n    );\n  }\n}\n","/**\n * @author Niklas Korz\n */\nimport React from \"react\";\nimport styled from \"styled-components\";\nimport { ProjectData } from \"../data/schema\";\nimport { getAllProjects, deleteProject } from \"../data/db\";\nimport Project from \"../project/Project\";\nimport { saveAsZip } from \"../data/export\";\nimport Modal, { ActionGroup, Action } from \"./Modal\";\nimport ProjectInfoModal from \"./ProjectInfoModal\";\n\nconst TableContainer = styled.div`\n  border: 2px solid hsl(210, 29%, 20%);\n  border-radius: 3px;\n  max-height: 400px;\n  min-width: 500px;\n  overflow-y: auto;\n  padding-bottom: 5px;\n`;\n\nconst Table = styled.table`\n  width: 100%;\n`;\n\nconst TableHead = styled.thead`\n  text-align: left;\n`;\n\nconst TableRow = styled.tr`\n  cursor: pointer;\n\n  :hover {\n    background: hsl(210, 29%, 40%);\n  }\n`;\n\nconst ColumnHead = styled.th`\n  padding: 5px 10px;\n`;\n\nconst ColumnData = styled.td`\n  padding: 5px 10px;\n`;\n\ninterface Props {\n  onNewProject(): void;\n  onDismiss(): void;\n  onSelectProject?(data: ProjectData): void;\n}\n\ninterface State {\n  projects: ProjectData[];\n  selectedProject: ProjectData | null;\n}\n\nexport default class ProjectManagerModal extends React.Component<Props, State> {\n  state: State = { projects: [], selectedProject: null };\n\n  dismiss = () => {\n    this.setState({ selectedProject: null });\n    this.props.onDismiss();\n  };\n\n  selectProject(data: ProjectData): void {\n    if (this.props.onSelectProject) {\n      this.props.onSelectProject(data);\n    } else {\n      this.setState({ selectedProject: data });\n    }\n  }\n\n  unselectProject = () => {\n    this.setState({ selectedProject: null });\n  };\n\n  deleteProject = ({ id }: ProjectData) => {\n    if (!id) {\n      return;\n    }\n    deleteProject(id);\n    this.setState(({ projects }) => ({\n      projects: projects.filter(p => p.id !== id),\n      selectedProject: null\n    }));\n  };\n\n  exportProject = (data: ProjectData) => {\n    const project = new Project().fromData(data, data.id);\n    saveAsZip(project);\n  };\n\n  async componentDidMount(): Promise<void> {\n    const projects = await getAllProjects();\n    this.setState({ projects: projects.reverse() });\n  }\n\n  render(): React.ReactNode {\n    const { projects, selectedProject } = this.state;\n\n    if (selectedProject) {\n      return (\n        <ProjectInfoModal\n          project={selectedProject}\n          onDelete={this.deleteProject}\n          onExport={this.exportProject}\n          onCancel={this.unselectProject}\n          onDismiss={this.dismiss}\n        />\n      );\n    }\n\n    return (\n      <Modal\n        title={this.props.onSelectProject ? \"Load Project\" : \"Project Manager\"}\n        onDismiss={this.dismiss}\n      >\n        {projects.length > 0 && (\n          <TableContainer>\n            <Table>\n              <TableHead>\n                <tr>\n                  <ColumnHead>ID</ColumnHead>\n                  <ColumnHead>Name</ColumnHead>\n                  <ColumnHead>Rooms</ColumnHead>\n                  <ColumnHead>Last update</ColumnHead>\n                </tr>\n              </TableHead>\n              <tbody>\n                {projects.map(p => (\n                  <TableRow key={p.id} onClick={() => this.selectProject(p)}>\n                    <ColumnData>{p.id}</ColumnData>\n                    <ColumnData>{p.name}</ColumnData>\n                    <ColumnData>{p.rooms.length}</ColumnData>\n                    <ColumnData>{p.savedAt.toLocaleString()}</ColumnData>\n                  </TableRow>\n                ))}\n              </tbody>\n            </Table>\n          </TableContainer>\n        )}\n        {!projects.length && <p>You don't have any saved projects yet</p>}\n        <ActionGroup>\n          <Action onClick={this.props.onNewProject}>New project</Action>\n          <Action onClick={this.dismiss}>Cancel</Action>\n        </ActionGroup>\n      </Modal>\n    );\n  }\n}\n","/**\n * @author Leon Erath\n * @author Daniel Salomon\n * @author Niklas Korz\n */\nimport React from \"react\";\nimport styled from \"styled-components\";\nimport Project from \"../project/Project\";\nimport { Group, Select, CustomInput, BoldLabel, Input } from \"./styled\";\nimport Modal, { Action, ActionGroup } from \"./Modal\";\nimport AudioLibraryModal from \"./AudioLibraryModal\";\nimport { AudioEntry } from \"./types\";\n\nconst InnerContainer = styled.div`\n  overflow: auto;\n  max-height: 400px;\n  min-width: 500px;\n  /* Add some space between content and scrollbar */\n  padding: 0 10px;\n  margin: 0 -10px;\n`;\n\nenum AudioSelectionTarget {\n  Footstep,\n  Collision,\n  InteractAvail\n}\n\ninterface Props {\n  project: Project;\n  onDismiss(): void;\n}\n\ninterface State {\n  panningModel: PanningModelType;\n  distanceModel: DistanceModelType;\n  ambisonicOrder: number;\n  rollofModel: string;\n  projectName?: string;\n  footstepAudio?: AudioEntry;\n  collisionAudio?: AudioEntry;\n  interactAvailAudio?: AudioEntry;\n  audioSelectionTarget?: AudioSelectionTarget;\n}\n\nexport default class SettingsModal extends React.Component<Props, State> {\n  state: State = {\n    panningModel: \"equalpower\",\n    distanceModel: \"inverse\",\n    ambisonicOrder: 1,\n    rollofModel: \"logarithmic\"\n  };\n\n  componentDidMount(): void {\n    this.onProjectChanged();\n  }\n\n  componentDidUpdate(prevProps: Props): void {\n    if (prevProps.project !== this.props.project) {\n      this.onProjectChanged();\n    }\n  }\n\n  onProjectChanged(): void {\n    const { project } = this.props;\n    this.setState({\n      panningModel: project.panningModel,\n      rollofModel: project.rollofModel,\n      distanceModel: project.distanceModel,\n      ambisonicOrder: project.ambisonicOrder,\n      projectName: project.id != null ? project.name : undefined, // Only show the name field if the project has been saved before\n      footstepAudio:\n        project.footstepAudioId != null && project.footstepAudioFile\n          ? {\n              ...project.footstepAudioFile,\n              id: project.footstepAudioId\n            }\n          : undefined,\n      collisionAudio:\n        project.collisionAudioId != null && project.collisionAudioFile\n          ? {\n              ...project.collisionAudioFile,\n              id: project.collisionAudioId\n            }\n          : undefined,\n      interactAvailAudio:\n        project.interactAvailAudioId != null && project.interactAvailAudioFile\n          ? {\n              ...project.interactAvailAudioFile,\n              id: project.interactAvailAudioId\n            }\n          : undefined\n    });\n  }\n\n  onProjectNameChanged: React.ChangeEventHandler<HTMLInputElement> = e => {\n    const name = e.currentTarget.value;\n    if (name) {\n      // Ensure that the project's name is not set to an empty string\n      this.props.project.name = name;\n    }\n    this.setState({ projectName: name });\n  };\n\n  hideAudioSelection = () => {\n    this.setState({ audioSelectionTarget: undefined });\n  };\n\n  selectAudio = (entry: AudioEntry) => {\n    const { project } = this.props;\n\n    switch (this.state.audioSelectionTarget) {\n      case AudioSelectionTarget.Footstep:\n        project.setFootstepAudio(entry.id);\n        this.setState({ footstepAudio: entry });\n        break;\n      case AudioSelectionTarget.Collision:\n        project.setCollisionAudio(entry.id);\n        this.setState({ collisionAudio: entry });\n        break;\n      case AudioSelectionTarget.InteractAvail:\n        project.setInteractAvailAudio(entry.id);\n        this.setState({ interactAvailAudio: entry });\n        break;\n    }\n\n    this.hideAudioSelection();\n  };\n\n  selectPanningModel = (e: React.ChangeEvent<HTMLSelectElement>) => {\n    const { project } = this.props;\n    const panningModel = e.currentTarget.value as PanningModelType;\n    project.selectPanningModel(panningModel);\n    this.setState({ panningModel: panningModel });\n  };\n\n  selectDistanceModel = (e: React.ChangeEvent<HTMLSelectElement>) => {\n    const { project } = this.props;\n    const distanceModel = e.currentTarget.value as DistanceModelType;\n    project.selectDistanceModel(distanceModel);\n    this.setState({ distanceModel });\n  };\n\n  selectAmbisonicOrder = (e: React.ChangeEvent<HTMLSelectElement>) => {\n    const { project } = this.props;\n    const selectedOrder = parseInt(e.currentTarget.value) as number;\n    project.selectAmbisonicOrder(selectedOrder);\n    this.setState({ ambisonicOrder: selectedOrder });\n  };\n\n  selectRollofModel = (e: React.ChangeEvent<HTMLSelectElement>) => {\n    const { project } = this.props;\n    const rollofModel = e.currentTarget.value;\n    project.selectRollofModel(rollofModel);\n    this.setState({ rollofModel: rollofModel });\n  };\n\n  render(): React.ReactNode {\n    const { project, onDismiss } = this.props;\n    const {\n      projectName,\n      footstepAudio,\n      collisionAudio,\n      interactAvailAudio,\n      audioSelectionTarget\n    } = this.state;\n\n    if (audioSelectionTarget != null) {\n      return (\n        <AudioLibraryModal\n          audioLibrary={project.audioLibrary}\n          onDismiss={this.hideAudioSelection}\n          onSelect={this.selectAudio}\n        />\n      );\n    }\n\n    return (\n      <Modal onDismiss={onDismiss} title=\"Settings\">\n        <InnerContainer>\n          <Group>\n            <BoldLabel>General</BoldLabel>\n            {projectName != null && (\n              <Group>\n                <label>Project Name</label>\n                <Input\n                  type=\"text\"\n                  value={projectName}\n                  onChange={this.onProjectNameChanged}\n                />\n              </Group>\n            )}\n            <Group>\n              <label>Footstep Sound</label>\n              <CustomInput\n                onClick={() =>\n                  this.setState({\n                    audioSelectionTarget: AudioSelectionTarget.Footstep\n                  })\n                }\n              >\n                {footstepAudio\n                  ? `${footstepAudio.name} (${Math.ceil(\n                      footstepAudio.data.byteLength / 1024\n                    )} KiB)`\n                  : \"No audio selected\"}\n              </CustomInput>\n            </Group>\n            <Group>\n              <label>Collision Sound</label>\n              <CustomInput\n                onClick={() =>\n                  this.setState({\n                    audioSelectionTarget: AudioSelectionTarget.Collision\n                  })\n                }\n              >\n                {collisionAudio\n                  ? `${collisionAudio.name} (${Math.ceil(\n                      collisionAudio.data.byteLength / 1024\n                    )} KiB)`\n                  : \"No audio selected\"}\n              </CustomInput>\n            </Group>\n            <Group>\n              <label>Interaction Available Sound</label>\n              <CustomInput\n                onClick={() =>\n                  this.setState({\n                    audioSelectionTarget: AudioSelectionTarget.InteractAvail\n                  })\n                }\n              >\n                {interactAvailAudio\n                  ? `${interactAvailAudio.name} (${Math.ceil(\n                      interactAvailAudio.data.byteLength / 1024\n                    )} KiB)`\n                  : \"No audio selected\"}\n              </CustomInput>\n            </Group>\n          </Group>\n          <Group>\n            <BoldLabel>Web Audio API</BoldLabel>\n            <Group>\n              <label>Panning Model</label>\n              <Select\n                value={this.state.panningModel}\n                onChange={this.selectPanningModel}\n              >\n                <option value=\"equalpower\">Equalpower</option>\n                <option value=\"HRTF\">HRTF</option>\n              </Select>\n            </Group>\n            <Group>\n              <label>Distance Model</label>\n              <Select\n                value={this.state.distanceModel}\n                onChange={this.selectDistanceModel}\n              >\n                <option value=\"inverse\">Inverse</option>\n                <option value=\"linear\">Linear</option>\n                <option value=\"exponential\">Exponential</option>\n              </Select>\n            </Group>\n          </Group>\n          <Group>\n            <BoldLabel>Resonance Audio</BoldLabel>\n            <Group>\n              <label>Ambisonic Order</label>\n              <Select\n                value={this.state.ambisonicOrder}\n                onChange={this.selectAmbisonicOrder}\n              >\n                <option value={1}>First-Order Ambisonics</option>\n                <option value={2}>Second-Order Ambisonics</option>\n                <option value={3}>Third-Order Ambisonics</option>\n              </Select>\n            </Group>\n            <Group>\n              <label>Rollof Model</label>\n              <Select\n                value={this.state.rollofModel}\n                onChange={this.selectRollofModel}\n              >\n                <option value=\"logarithmic\">Logarithmic</option>\n                <option value=\"linear\">Linear</option>\n                <option value=\"none\">None</option>\n              </Select>\n            </Group>\n          </Group>\n        </InnerContainer>\n        <ActionGroup>\n          <Action onClick={onDismiss}>Done</Action>\n        </ActionGroup>\n      </Modal>\n    );\n  }\n}\n","/**\n * @author Niklas Korz\n */\nimport React from \"react\";\nimport { RoomDimensions, RoomMaterials } from \"resonance-audio\";\nimport { Euler, Vector3 } from \"three\";\nimport { saveAsZip } from \"../data/export\";\nimport { openZip } from \"../data/import\";\nimport GameObject, {\n  InteractionType,\n  TeleportTarget\n} from \"../project/GameObject\";\nimport Project from \"../project/Project\";\nimport { ProjectData } from \"../data/schema\";\nimport AudioImplementation from \"../audio/AudioImplementation\";\nimport RuntimeContainer from \"../runtime/RuntimeContainer\";\nimport CodeBlock from \"../project/CodeBlock\";\nimport SpawnMarker from \"../project/SpawnMarker\";\nimport AudioLibraryModal from \"./AudioLibraryModal\";\nimport MenuBar from \"./MenuBar\";\nimport ObjectEditor from \"./ObjectEditor\";\nimport EditorCanvas from \"./EditorCanvas\";\nimport RoomEditor from \"./RoomEditor\";\nimport {\n  Container,\n  FocusedLabel,\n  Group,\n  InnerContainer,\n  Main,\n  RoomList,\n  RoomListItem,\n  Sidebar\n} from \"./styled\";\nimport { EditorObject, EditorRoom, AudioEntry, EditorSpawn } from \"./types\";\nimport ProjectManagerModal from \"./ProjectManagerModal\";\nimport SettingsModal from \"./SettingsModal\";\nimport SpawnEditor from \"./SpawnEditor\";\nimport ProjectSaveModal from \"./ProjectSaveModal\";\nimport ProjectLoadedModal from \"./ProjectLoadedModal\";\n\nenum ModalType {\n  AudioLibrary,\n  AudioSelection,\n  ProjectManager,\n  ProjectSelection,\n  ProjectSaver,\n  ProjectLoaded,\n  Settings\n}\n\nenum AudioSelectionTarget {\n  ObjectAudio,\n  InteractionAudio\n}\n\ninterface State {\n  audioImplementation: AudioImplementation;\n  rooms: EditorRoom[];\n  selectedRoomId: number;\n  selectedSpawn: EditorSpawn | null;\n  selectedObject: EditorObject | null;\n  modal: ModalType | null;\n  project: Project;\n  runningProject: Project | null;\n}\n\nexport default class Editor extends React.Component<{}, State> {\n  project: Project = new Project();\n  projectCanvas = new EditorCanvas(this.project);\n\n  state: State = {\n    audioImplementation: this.project.activeAudioImplementation,\n    rooms: this.project.rooms.map(r => ({\n      id: r.id,\n      uuid: r.uuid,\n      name: r.name,\n      dimensions: r.dimensions,\n      materials: r.materials\n    })),\n    selectedRoomId: 0,\n    selectedSpawn: null,\n    selectedObject: null,\n    modal: null,\n    project: this.project, // Keep a reference to the project in the UI state as well to react to a project change\n    runningProject: null\n  };\n  audioSelectionTarget = AudioSelectionTarget.ObjectAudio;\n  mainRef = React.createRef<HTMLElement>();\n\n  constructor(props: {}) {\n    super(props);\n\n    this.project.events = {\n      onSelectSpawn: this.onSelectSpawn,\n      onSelectObject: this.onSelectObject,\n      onTranslate: this.onTranslateObject,\n      onScale: this.onScaleObject\n    };\n  }\n\n  // Menubar functionality\n\n  newProject = () => {\n    this.project.close();\n    this.project = new Project({\n      onSelectSpawn: this.onSelectSpawn,\n      onSelectObject: this.onSelectObject,\n      onTranslate: this.onTranslateObject,\n      onScale: this.onScaleObject\n    });\n    this.projectCanvas.changeProject(this.project);\n    this.setState({\n      audioImplementation: this.project.activeAudioImplementation,\n      rooms: this.project.rooms.map(r => ({\n        id: r.id,\n        uuid: r.uuid,\n        name: r.name,\n        dimensions: r.dimensions,\n        materials: r.materials\n      })),\n      selectedRoomId: 0,\n      selectedSpawn: null,\n      selectedObject: null,\n      project: this.project,\n      modal: null\n    });\n  };\n\n  showProjectSelection = async () => {\n    this.setState({\n      modal: ModalType.ProjectSelection\n    });\n  };\n\n  saveProject = async () => {\n    if (this.project.id == null) {\n      // The project hasn't been saved before\n      this.setState({ modal: ModalType.ProjectSaver });\n    } else {\n      await this.project.save();\n    }\n  };\n\n  importProject = async () => {\n    try {\n      const project = await openZip();\n      this.project.close();\n      this.project = project;\n    } catch (ex) {\n      console.log(\"Opening project zip failed:\", ex);\n      alert(\n        \"The selected project could not be imported, please select a valid project archive.\"\n      );\n      return;\n    }\n\n    this.project.events = {\n      onSelectSpawn: this.onSelectSpawn,\n      onSelectObject: this.onSelectObject,\n      onTranslate: this.onTranslateObject,\n      onScale: this.onScaleObject\n    };\n    this.projectCanvas.changeProject(this.project);\n    this.setState({\n      audioImplementation: this.project.activeAudioImplementation,\n      rooms: this.project.rooms.map(r => ({\n        id: r.id,\n        uuid: r.uuid,\n        name: r.name,\n        dimensions: r.dimensions,\n        materials: r.materials\n      })),\n      selectedRoomId: 0,\n      selectedSpawn: null,\n      selectedObject: null,\n      project: this.project,\n      modal: ModalType.ProjectLoaded\n    });\n  };\n\n  exportProject = () => {\n    saveAsZip(this.project);\n  };\n\n  addObject = () => {\n    const object = this.project.activeRoom.addObject();\n    this.project.selectObject(object);\n  };\n\n  deleteObject = () => {\n    if (this.project.activeObject) {\n      this.project.activeRoom.remove(this.project.activeObject);\n      this.project.activeObject.audio.stop();\n      this.project.unselect();\n    }\n  };\n\n  addSpawn = () => {\n    const spawn = this.project.activeRoom.addSpawn();\n    this.project.selectSpawn(spawn);\n  };\n\n  deleteSpawn = () => {\n    const { spawns } = this.project.activeRoom;\n    // Ensure that at least one spawn per room exists, as it is used\n    // as a fallback when a requested spawn does not exist.\n    if (this.project.activeSpawn && spawns.length > 1) {\n      spawns.splice(spawns.indexOf(this.project.activeSpawn));\n      this.project.activeRoom.remove(this.project.activeSpawn);\n      this.project.activeSpawn = null;\n      this.project.unselect();\n    }\n  };\n\n  addRoom = () => {\n    const room = this.project.addRoom();\n    this.setState(s => ({\n      rooms: [\n        ...s.rooms,\n        {\n          id: room.id,\n          uuid: room.uuid,\n          name: room.name,\n          dimensions: room.dimensions,\n          materials: room.materials\n        }\n      ],\n      selectedRoomId: s.rooms.length\n    }));\n  };\n\n  deleteRoom = () => {\n    // Ensure the first room cannot be deleted\n    if (this.state.selectedRoomId > 0) {\n      this.project.rooms.splice(this.state.selectedRoomId, 1);\n      this.setState(s => ({\n        rooms: [\n          ...s.rooms.slice(0, s.selectedRoomId),\n          ...s.rooms.slice(s.selectedRoomId + 1)\n        ],\n        selectedRoomId: 0\n      }));\n    }\n  };\n\n  showAudioLibrary = () => {\n    this.setState({ modal: ModalType.AudioLibrary });\n  };\n\n  showProjectManager = () => {\n    this.setState({ modal: ModalType.ProjectManager });\n  };\n\n  selectAudioImplementation = (audioImplementation: AudioImplementation) => {\n    this.project.selectAudioImplementation(audioImplementation);\n    this.setState({ audioImplementation });\n  };\n\n  runProject = () => {\n    // Detach the project canvas to avoid listening to any new gamepad input.\n    this.projectCanvas.detach();\n    // Create a \"new\" project so any changes made during runtime are not persisted and\n    // copy the project data to it. We also pass along the audio library so it\n    // is shared between the editor project and the runtime. This is necessary so\n    // the runtime can access the audio of unsaved projects.\n    const runningProject = new Project().fromData(\n      this.project.toData(),\n      this.project.id,\n      this.project.audioLibrary\n    );\n    // Only suspend the editor project instead of closing it.\n    // This way, we can safely return from the runtime to the editor and resume the\n    // editor project.\n    this.project.suspend();\n    // Finally, update the UI state so React attaches the runtime container component\n    // instead of the editor's components to the DOM.\n    this.setState({ runningProject });\n  };\n\n  showSettings = () => {\n    this.setState({ modal: ModalType.Settings });\n  };\n\n  // Room specific editor functionality\n\n  selectRoom(id: number): void {\n    this.project.selectRoom(this.project.rooms[id]);\n    this.setState({ selectedRoomId: id });\n  }\n\n  updateRoomName = (name: string) => {\n    this.project.activeRoom.name = name;\n    this.setState(({ rooms, selectedRoomId }) => ({\n      rooms: [\n        ...rooms.slice(0, selectedRoomId),\n        {\n          ...rooms[selectedRoomId],\n          name\n        },\n        ...rooms.slice(selectedRoomId + 1)\n      ]\n    }));\n  };\n\n  updateRoomDimensions = (dimensions: RoomDimensions) => {\n    this.project.activeRoom.dimensions = dimensions;\n    this.setState(({ rooms, selectedRoomId }) => ({\n      rooms: [\n        ...rooms.slice(0, selectedRoomId),\n        {\n          ...rooms[selectedRoomId],\n          dimensions\n        },\n        ...rooms.slice(selectedRoomId + 1)\n      ]\n    }));\n  };\n\n  updateRoomMaterials = (materials: RoomMaterials) => {\n    this.project.activeRoom.materials = materials;\n    this.setState(({ rooms, selectedRoomId }) => ({\n      rooms: [\n        ...rooms.slice(0, selectedRoomId),\n        {\n          ...rooms[selectedRoomId],\n          materials\n        },\n        ...rooms.slice(selectedRoomId + 1)\n      ]\n    }));\n  };\n\n  // Spawn editor functionality\n\n  updateSpawnName = (name: string) => {\n    if (this.project.activeSpawn) {\n      this.project.activeSpawn.name = name;\n    }\n    this.setState(({ selectedSpawn }) => ({\n      selectedSpawn: selectedSpawn && {\n        ...selectedSpawn,\n        name\n      }\n    }));\n  };\n\n  updateSpawnPosition = (x: number, z: number) => {\n    if (this.project.activeSpawn) {\n      this.project.activeSpawn.position.x = x;\n      this.project.activeSpawn.position.z = z;\n    }\n    this.setState(({ selectedSpawn }) => ({\n      selectedSpawn: selectedSpawn && {\n        ...selectedSpawn,\n        position: new Vector3(x, 0, z)\n      }\n    }));\n  };\n\n  updateSpawnRotation = (y: number) => {\n    if (this.project.activeSpawn) {\n      this.project.activeSpawn.rotation.y = y;\n    }\n    this.setState(({ selectedSpawn }) => ({\n      selectedSpawn: selectedSpawn && {\n        ...selectedSpawn,\n        rotation: y\n      }\n    }));\n  };\n\n  // Object editor functionality\n\n  updateObjectName = (name: string) => {\n    if (this.project.activeObject) {\n      this.project.activeObject.name = name;\n    }\n    this.setState(({ selectedObject }) => ({\n      selectedObject: selectedObject && {\n        ...selectedObject,\n        name\n      }\n    }));\n  };\n\n  updateObjectVolume = (volume: number) => {\n    if (this.project.activeObject) {\n      this.project.activeObject.volume = volume;\n    }\n    this.setState(({ selectedObject }) => {\n      return {\n        selectedObject: selectedObject && {\n          ...selectedObject,\n          volume\n        }\n      };\n    });\n  };\n\n  updateObjectScale = (x: number, y: number, z: number) => {\n    if (this.project.activeObject) {\n      this.project.activeObject.scale.set(x, y, z);\n    }\n    this.setState(({ selectedObject }) => ({\n      selectedObject: selectedObject && {\n        ...selectedObject,\n        scale: new Vector3(x, y, z)\n      }\n    }));\n  };\n\n  updateObjectPosition = (x: number, y: number, z: number) => {\n    if (this.project.activeObject) {\n      this.project.activeObject.position.set(x, y, z);\n    }\n    this.setState(({ selectedObject }) => ({\n      selectedObject: selectedObject && {\n        ...selectedObject,\n        position: new Vector3(x, y, z)\n      }\n    }));\n  };\n\n  updateObjectRotation = (x: number, y: number, z: number) => {\n    if (this.project.activeObject) {\n      this.project.activeObject.rotation.set(x, y, z);\n    }\n    this.setState(({ selectedObject }) => ({\n      selectedObject: selectedObject && {\n        ...selectedObject,\n        rotation: new Euler(x, y, z)\n      }\n    }));\n  };\n\n  updateObjectInteractionType = (interactionType: InteractionType) => {\n    const defaultTarget: TeleportTarget = {\n      roomId: this.project.rooms[0].uuid,\n      spawnId: \"\"\n    };\n    if (this.project.activeObject) {\n      this.project.activeObject.interactionType = interactionType;\n      this.project.activeObject.teleportTarget =\n        this.project.activeObject.teleportTarget || defaultTarget;\n    }\n    this.setState(({ selectedObject }) => ({\n      selectedObject: selectedObject && {\n        ...selectedObject,\n        interactionType,\n        teleportTarget: selectedObject.teleportTarget || defaultTarget\n      }\n    }));\n  };\n\n  updateObjectCodeBlockSource = (codeBlockSource: string) => {\n    if (this.project.activeObject) {\n      if (this.project.activeObject.codeBlock) {\n        this.project.activeObject.codeBlock.update(codeBlockSource);\n      } else {\n        this.project.activeObject.codeBlock = new CodeBlock(codeBlockSource);\n      }\n    }\n    this.setState(({ selectedObject }) => ({\n      selectedObject: selectedObject && {\n        ...selectedObject,\n        codeBlockSource\n      }\n    }));\n  };\n\n  updateObjectTeleportTarget = (teleportTarget: TeleportTarget) => {\n    if (this.project.activeObject) {\n      this.project.activeObject.teleportTarget = teleportTarget;\n    }\n    this.setState(({ selectedObject }) => ({\n      selectedObject: selectedObject && {\n        ...selectedObject,\n        teleportTarget\n      }\n    }));\n  };\n\n  showAudioSelection = () => {\n    this.audioSelectionTarget = AudioSelectionTarget.ObjectAudio;\n    this.setState({\n      modal: ModalType.AudioSelection\n    });\n  };\n\n  showInteractionAudioSelection = () => {\n    this.audioSelectionTarget = AudioSelectionTarget.InteractionAudio;\n    this.setState({\n      modal: ModalType.AudioSelection\n    });\n  };\n\n  // Modal events\n\n  dismissModal = () => {\n    this.setState({ modal: null });\n  };\n\n  selectAudio = (audio: AudioEntry) => {\n    if (this.project.activeObject) {\n      if (this.audioSelectionTarget === AudioSelectionTarget.InteractionAudio) {\n        this.project.activeObject.interactionAudioId = audio.id;\n        this.setState(({ selectedObject }) => ({\n          selectedObject: selectedObject && {\n            ...selectedObject,\n            interactionAudio: audio\n          },\n          modal: null\n        }));\n      } else {\n        this.project.activeRoom.audioScene.resume();\n        this.project.activeObject.playAudio(audio.id, true);\n        this.setState(({ selectedObject }) => ({\n          selectedObject: selectedObject && {\n            ...selectedObject,\n            audio\n          },\n          modal: null\n        }));\n      }\n    }\n  };\n\n  loadProject = (data: ProjectData) => {\n    try {\n      const project = new Project().fromData(data, data.id);\n      this.project.close();\n      this.project = project;\n    } catch (ex) {\n      console.log(\"Loading project failed:\", ex);\n      alert(\"The selected project could not be loaded\");\n    }\n    this.project.events = {\n      onSelectSpawn: this.onSelectSpawn,\n      onSelectObject: this.onSelectObject,\n      onTranslate: this.onTranslateObject,\n      onScale: this.onScaleObject\n    };\n    this.projectCanvas.changeProject(this.project);\n    this.setState({\n      audioImplementation: this.project.activeAudioImplementation,\n      rooms: this.project.rooms.map(r => ({\n        id: r.id,\n        uuid: r.uuid,\n        name: r.name,\n        dimensions: r.dimensions,\n        materials: r.materials\n      })),\n      selectedRoomId: 0,\n      selectedSpawn: null,\n      selectedObject: null,\n      project: this.project,\n      modal: ModalType.ProjectLoaded\n    });\n  };\n\n  saveNewProject = async (name: string) => {\n    this.project.name = name;\n    await this.project.save();\n    this.dismissModal();\n  };\n\n  resumeProject = () => {\n    this.project.resume();\n    this.dismissModal();\n  };\n\n  // Project canvas events\n\n  onSelectSpawn = (s: SpawnMarker | null) => {\n    this.setState({\n      selectedSpawn: s && {\n        id: s.id,\n        uuid: s.uuid,\n        name: s.name,\n        position: s.position,\n        rotation: s.rotation.y\n      },\n      selectedObject: null\n    });\n  };\n\n  onSelectObject = async (o: GameObject | null) => {\n    const interactionAudio =\n      o && o.interactionAudioId != null\n        ? await this.project.audioLibrary.get(o.interactionAudioId)\n        : undefined;\n    this.setState({\n      selectedSpawn: null,\n      selectedObject: o && {\n        id: o.id,\n        uuid: o.uuid,\n        name: o.name,\n        volume: o.volume,\n        position: o.position,\n        scale: o.scale,\n        rotation: o.rotation,\n        audio:\n          o.audioFile && o.audioId != null\n            ? {\n                ...o.audioFile,\n                id: o.audioId\n              }\n            : undefined,\n        interactionType: o.interactionType,\n        codeBlockSource: o.codeBlock && o.codeBlock.source,\n        teleportTarget: o.teleportTarget,\n        interactionAudio:\n          interactionAudio && o.interactionAudioId != null\n            ? {\n                ...interactionAudio,\n                id: o.interactionAudioId\n              }\n            : undefined\n      }\n    });\n  };\n\n  onTranslateObject = (p: Vector3) => {\n    this.setState(({ selectedObject }) => ({\n      selectedObject: selectedObject && {\n        ...selectedObject,\n        position: p\n      }\n    }));\n  };\n\n  onScaleObject = (s: Vector3) => {\n    this.setState(({ selectedObject }) => ({\n      selectedObject: selectedObject && {\n        ...selectedObject,\n        size: {\n          width: s.x,\n          height: s.y,\n          depth: s.z\n        }\n      }\n    }));\n  };\n\n  // Runtime events\n\n  exitRuntime = () => {\n    if (!this.state.runningProject) {\n      return;\n    }\n    const { activeAudioImplementation } = this.state.runningProject;\n    // Close the running project. As we are not going to reuse it, there's no sense\n    // in keeping the memory allocated to its audio contexts around.\n    this.state.runningProject.close();\n    // Ensure the audio implementation in the editor matches the one selected in the runtime\n    this.project.selectAudioImplementation(activeAudioImplementation);\n    // Finally, update the UI state so React unmounts the runtime container and attaches\n    // the editor's components again.\n    this.setState({\n      runningProject: null,\n      audioImplementation: activeAudioImplementation\n    });\n  };\n\n  // React component lifecycle methods\n\n  attachCanvas = (target: HTMLElement | null) => {\n    if (target != null) {\n      this.projectCanvas.attach(target);\n      this.projectCanvas.focus();\n    } else {\n      this.projectCanvas.detach();\n    }\n  };\n\n  componentWillUnmount(): void {\n    this.projectCanvas.detach();\n  }\n\n  render(): React.ReactNode {\n    const { modal, runningProject, audioImplementation } = this.state;\n    const { selectedSpawn: s, selectedObject: o } = this.state;\n\n    if (runningProject) {\n      return (\n        <RuntimeContainer project={runningProject} onExit={this.exitRuntime} />\n      );\n    }\n\n    return (\n      <Container>\n        {(modal === ModalType.AudioLibrary ||\n          modal === ModalType.AudioSelection) && (\n          <AudioLibraryModal\n            audioLibrary={this.project.audioLibrary}\n            onDismiss={this.dismissModal}\n            onSelect={\n              modal === ModalType.AudioSelection ? this.selectAudio : undefined\n            }\n          />\n        )}\n        {(modal === ModalType.ProjectManager ||\n          modal === ModalType.ProjectSelection) && (\n          <ProjectManagerModal\n            onNewProject={this.newProject}\n            onDismiss={this.dismissModal}\n            onSelectProject={\n              modal === ModalType.ProjectSelection\n                ? this.loadProject\n                : undefined\n            }\n          />\n        )}\n        {modal === ModalType.ProjectSaver && (\n          <ProjectSaveModal\n            onSave={this.saveNewProject}\n            onDismiss={this.dismissModal}\n          />\n        )}\n        {modal === ModalType.ProjectLoaded && (\n          <ProjectLoadedModal onConfirm={this.resumeProject} />\n        )}\n        {modal === ModalType.Settings && (\n          <SettingsModal project={this.project} onDismiss={this.dismissModal} />\n        )}\n        <MenuBar\n          audioImplementation={audioImplementation}\n          onAudioChange={this.selectAudioImplementation}\n          onNewProject={this.newProject}\n          onLoadProject={this.showProjectSelection}\n          onSaveProject={this.saveProject}\n          onImportProject={this.importProject}\n          onExportProject={this.exportProject}\n          onShowSettings={this.showSettings}\n          onAddObject={this.addObject}\n          onDeleteObject={this.deleteObject}\n          onAddSpawn={this.addSpawn}\n          onDeleteSpawn={this.deleteSpawn}\n          onAddRoom={this.addRoom}\n          onDeleteRoom={this.deleteRoom}\n          onShowAudioLibrary={this.showAudioLibrary}\n          onShowProjectManager={this.showProjectManager}\n          onRunProject={this.runProject}\n        />\n        <InnerContainer>\n          <Sidebar>\n            <Group>\n              <label>Rooms</label>\n              <RoomList>\n                {this.state.rooms.map((r, i) => (\n                  <RoomListItem\n                    key={r.id}\n                    onClick={() => this.selectRoom(i)}\n                    active={i === this.state.selectedRoomId}\n                  >\n                    {r.name || \"Anonymous Room\"}\n                  </RoomListItem>\n                ))}\n              </RoomList>\n            </Group>\n            {!(s || o) && (\n              <RoomEditor\n                room={this.state.rooms[this.state.selectedRoomId]}\n                onUpdateName={this.updateRoomName}\n                onUpdateDimensions={this.updateRoomDimensions}\n                onUpdateMaterials={this.updateRoomMaterials}\n              />\n            )}\n            {s && (\n              <SpawnEditor\n                spawn={s}\n                onUpdateName={this.updateSpawnName}\n                onUpdatePosition={this.updateSpawnPosition}\n                onUpdateRotation={this.updateSpawnRotation}\n              />\n            )}\n            {o && (\n              <ObjectEditor\n                object={o}\n                rooms={this.project.rooms}\n                onUpdateName={this.updateObjectName}\n                onUpdateVolume={this.updateObjectVolume}\n                onUpdatePosition={this.updateObjectPosition}\n                onUpdateRotation={this.updateObjectRotation}\n                onUpdateScale={this.updateObjectScale}\n                onUpdateInteractionType={this.updateObjectInteractionType}\n                onUpdateCodeBlockSource={this.updateObjectCodeBlockSource}\n                onUpdateTeleportTarget={this.updateObjectTeleportTarget}\n                onShowAudioSelection={this.showAudioSelection}\n                onShowInteractionAudioSelection={\n                  this.showInteractionAudioSelection\n                }\n              />\n            )}\n          </Sidebar>\n          <Main ref={this.attachCanvas}>\n            <FocusedLabel>Focused</FocusedLabel>\n          </Main>\n        </InnerContainer>\n      </Container>\n    );\n  }\n}\n","/**\n * @author Niklas Korz\n */\nimport React from \"react\";\nimport { degToRad, radToDeg, roundToPrecision } from \"../utils/math\";\nimport { selectOnFocus } from \"../utils/react\";\nimport { Group, Input, InputGroup } from \"./styled\";\nimport { EditorSpawn } from \"./types\";\n\ninterface Props {\n  spawn: EditorSpawn;\n  onUpdateName(name: string): void;\n  onUpdatePosition(x: number, z: number): void;\n  onUpdateRotation(y: number): void;\n}\n\n// UI component for editing properties specific to spawns inside a room\nexport default class SpawnEditor extends React.Component<Props> {\n  render(): React.ReactNode {\n    const {\n      spawn: s,\n      onUpdateName,\n      onUpdatePosition,\n      onUpdateRotation\n    } = this.props;\n\n    return (\n      <div>\n        <Group>\n          <label>Spawn ID</label>\n          <Input type=\"text\" readOnly value={s.uuid} onFocus={selectOnFocus} />\n        </Group>\n        <Group>\n          <label>Name</label>\n          <Input\n            type=\"text\"\n            placeholder=\"New spawn\"\n            value={s.name}\n            onChange={e => onUpdateName(e.currentTarget.value)}\n          />\n        </Group>\n        <Group>\n          <label>Position (x, z)</label>\n          <InputGroup>\n            <Input\n              type=\"number\"\n              step={0.01}\n              value={s.position.x.toFixed(2)}\n              onChange={e =>\n                onUpdatePosition(\n                  roundToPrecision(e.currentTarget.valueAsNumber, 0.01),\n                  s.position.z\n                )\n              }\n            />\n            <Input\n              type=\"number\"\n              step={0.01}\n              value={s.position.z.toFixed(2)}\n              onChange={e =>\n                onUpdatePosition(\n                  s.position.x,\n                  roundToPrecision(e.currentTarget.valueAsNumber, 0.01)\n                )\n              }\n            />\n          </InputGroup>\n        </Group>\n        <Group>\n          <label>Euler-Rotation in Degrees (y)</label>\n          <InputGroup>\n            <Input\n              type=\"number\"\n              step={1}\n              value={radToDeg(s.rotation).toFixed(0)}\n              onChange={e =>\n                onUpdateRotation(degToRad(e.currentTarget.valueAsNumber % 360))\n              }\n            />\n          </InputGroup>\n        </Group>\n      </div>\n    );\n  }\n}\n","/**\n * @author Niklas Korz\n */\nimport React from \"react\";\nimport Modal, { ActionGroup, Action } from \"./Modal\";\nimport { Input, Group } from \"./styled\";\n\ninterface Props {\n  onSave(name: string): void;\n  onDismiss(): void;\n}\n\ninterface State {\n  name: string;\n}\n\nexport default class ProjectSaveModal extends React.Component<Props, State> {\n  state: State = { name: \"\" };\n\n  onNameChange: React.ChangeEventHandler<HTMLInputElement> = e => {\n    this.setState({ name: e.currentTarget.value });\n  };\n\n  submit: React.FormEventHandler<HTMLFormElement> = e => {\n    e.preventDefault();\n\n    const { name } = this.state;\n    if (name) {\n      this.props.onSave(name);\n    }\n  };\n\n  render(): React.ReactNode {\n    const { onDismiss } = this.props;\n    const { name } = this.state;\n\n    return (\n      <Modal title=\"Save Project\" onDismiss={onDismiss}>\n        <form onSubmit={this.submit}>\n          <Group>\n            <Input\n              autoFocus\n              required\n              type=\"text\"\n              placeholder=\"Project Name\"\n              value={name}\n              onChange={this.onNameChange}\n            />\n          </Group>\n          <ActionGroup>\n            <Action type=\"submit\" disabled={!name}>\n              Save\n            </Action>\n            <Action type=\"button\" onClick={onDismiss}>\n              Cancel\n            </Action>\n          </ActionGroup>\n        </form>\n      </Modal>\n    );\n  }\n}\n","/**\n * @author Niklas Korz\n */\nimport React from \"react\";\nimport Modal, { ActionGroup, Action } from \"./Modal\";\n\ninterface Props {\n  onConfirm(): void;\n}\n\n// Many browsers block automatic playback of audio nowadays.\n// In particular, this means that any audio playback that is started\n// outside of an user interaction event handler will be stopped.\n// As the functions for loading or importing projects are asynchronous,\n// they are considered to be running outside of the user interaction event handler.\n// Therefore, we have to display this dialog after a project has been loaded and\n// resume the loaded project's audio when the user clicks on the \"OK\" buttion in this\n// dialog.\nexport default class ProjectLoadedModal extends React.Component<Props> {\n  render(): React.ReactNode {\n    return (\n      <Modal title=\"Project Loaded\">\n        <p>The project has been loaded successfully.</p>\n        <ActionGroup>\n          <Action onClick={this.props.onConfirm}>OK</Action>\n        </ActionGroup>\n      </Modal>\n    );\n  }\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ninterface Config {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n}\n\nfunction registerValidSW(swUrl: string, config?: Config): void {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                \"New content is available and will be used when all \" +\n                  \"tabs for this page are closed. See http://bit.ly/CRA-PWA.\"\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log(\"Content is cached for offline use.\");\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error(\"Error during service worker registration:\", error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config): void {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        \"No internet connection found. App is running in offline mode.\"\n      );\n    });\n}\n\nexport function register(config?: Config): void {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit http://bit.ly/CRA-PWA\"\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nexport function unregister(): void {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import \"normalize.css\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport Editor from \"./editor/Editor\";\nimport \"./index.css\";\nimport * as serviceWorker from \"./serviceWorker\";\n\n// Safari does not yet support the Web Audio API without a prefix\nif (!window.AudioContext && window.webkitAudioContext) {\n  window.AudioContext = window.webkitAudioContext;\n}\n\n// Check if we're running as a desktop app through NW.js\nif (window.nw) {\n  const nw = window.nw;\n  const w = nw.Window.get();\n  // Maximize the window on start\n  w.maximize();\n  w.focus();\n  // Ensure external links open in the OS' browser instead of a\n  // new window in the app.\n  w.on(\"new-win-policy\", (frame, url, policy) => {\n    if (policy && url) {\n      policy.ignore();\n      nw.Shell.openExternal(url);\n    }\n  });\n  // Ask the user for confirmation when closing the window,\n  // to ensure there are no unsaved changes.\n  w.on(\"close\", () => {\n    if (\n      confirm(\"Do you really want to quit? There might be unsaved changes.\")\n    ) {\n      // Finally, force close to avoid this event being triggered again\n      w.close(true);\n    }\n  });\n}\n\nif (process.env.NODE_ENV === \"production\") {\n  // If we are running in the production environment, make sure the user\n  // does not close the editor unintentionally.\n  window.addEventListener(\"beforeunload\", e => e.preventDefault());\n}\n\nReactDOM.render(<Editor />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}